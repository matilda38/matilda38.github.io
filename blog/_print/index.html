<!doctype html>
<html lang="ko" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.75.1" /><link rel="canonical" type="text/html" href="/blog/">
<META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>Docsy Blog | 한국어 버전 타이틀</title><meta property="og:title" content="Docsy Blog" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="/blog/" />
<meta property="og:site_name" content="한국어 버전 타이틀" />
<meta itemprop="name" content="Docsy Blog">
<meta itemprop="description" content="">
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Docsy Blog"/>
<meta name="twitter:description" content=""/>





<link rel="preload" href="/scss/main.min.4aec00cbc82dae02258a2ba135990358146339f666dc47346f0f1e49d7a6fa42.css" as="style">
<link href="/scss/main.min.4aec00cbc82dae02258a2ba135990358146339f666dc47346f0f1e49d7a6fa42.css" rel="stylesheet" integrity="">


<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>




  </head>
  <body class="td-section td-blog">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
        <a class="navbar-brand" href="/">
		<span class="navbar-logo"><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 500 500" style="enable-background:new 0 0 500 500"><g><path style="fill:#fff" d="M116.8525 421.9722c-5.7041.0-10.3442-4.3127-10.3442-9.6129V88.183c0-5.3002 4.6401-9.6117 10.3442-9.6117H320.858c3.0347.0 9.3959.5498 11.7506 2.6302l.3545.3442 58.905 63.2912c2.3101 2.491 2.9202 8.4928 2.9202 11.3184v256.2039c0 5.3002-4.6407 9.6129-10.3436 9.6129H116.8525z"/><g><g><g><path style="fill:#767676" d="M384.4445 423.2066H116.852c-6.3839.0-11.5786-4.8658-11.5786-10.8474V88.1831c0-5.9804 5.1947-10.8461 11.5786-10.8461h204.0062c.377.0 9.2786.0329 12.568 2.9389l.3947.3833 58.9508 63.337c3.2135 3.4652 3.2514 11.7924 3.2514 12.1593v256.2036C396.0231 418.3408 390.8284 423.2066 384.4445 423.2066zM116.5079 411.9189c.0848.0278.1999.0531.3441.0531h267.5925c.1442.0.2581-.0253.3441-.0531V156.1556c-.0076-.9033-.3593-3.7347-.7034-5.0037l-57.6527-61.9416c-1.4651-.3176-4.4533-.6389-5.5742-.6389H116.852c-.143.0-.2594.024-.3441.0531V411.9189zm267.4533-261.149zM327.0321 89.371v.0013V89.371z"/></g></g></g><g><g><path style="fill:#5b7fc0" d="M189.0874 210.1754l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4473C177.5953 212.627 183.0601 210.1742 189.0874 210.1754zM197.0804 232.033c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 234.1722 197.0804 232.033z"/><path style="opacity:.3;fill:#fff" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zM197.0839 232.0372c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/><g><defs><path id="SVGID_1_" d="M194.7376 237.6875c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 234.2399 196.1861 236.239 194.7376 237.6875z"/></defs><clipPath id="SVGID_2_"><use xlink:href="#SVGID_1_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_2_);fill:#fff" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/><path style="opacity:.13;clip-path:url(#SVGID_2_);fill:#020202" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/></g><g><defs><path id="SVGID_3_" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zM197.0839 232.0372c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/></defs><clipPath id="SVGID_4_"><use xlink:href="#SVGID_3_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_4_);fill:#5b7fc0" d="M172.6595 215.6045c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8475-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 209.1953 176.6171 211.647 172.6595 215.6045z"/></g></g><rect x="198.8952" y="225.1043" style="fill:#5b7fc0" width="122.6266" height="13.8671"/></g><g><path style="fill:#d95140" d="M189.0874 155.7611l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.0249 2.454-11.4897 6.4116-15.4473C177.5953 158.2128 183.0601 155.7599 189.0874 155.7611zM197.0804 177.6188c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.2508 181.7667 197.0816 179.758 197.0804 177.6188z"/><path style="opacity:.3;fill:#fff" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zM197.0839 177.623c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/><g><defs><path id="SVGID_5_" d="M194.7376 183.2733c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 179.8256 196.1861 181.8248 194.7376 183.2733z"/></defs><clipPath id="SVGID_6_"><use xlink:href="#SVGID_5_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_6_);fill:#fff" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/><path style="opacity:.13;clip-path:url(#SVGID_6_);fill:#020202" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/></g><g><defs><path id="SVGID_7_" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zM197.0839 177.623c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/></defs><clipPath id="SVGID_8_"><use xlink:href="#SVGID_7_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_8_);fill:#d95140" d="M172.6595 161.1903c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 154.7811 176.6171 157.2327 172.6595 161.1903z"/></g><rect x="198.8952" y="170.69" style="fill:#d95140" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#56a55c" d="M189.5379 264.6147l.0012-.0012c7.7751.0012 15.0294 4.1862 18.932 10.9235 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032-5.8394.0-11.3281-2.2733-15.458-6.4032-4.13-4.13-6.4032-9.6186-6.4056-15.4628.0012-6.0249 2.454-11.4897 6.4116-15.4472C178.0458 267.0663 183.5105 264.6135 189.5379 264.6147zM197.5309 286.4723c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6538 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.7013 290.6202 197.5321 288.6115 197.5309 286.4723z"/><path style="opacity:.3;fill:#fff" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zM197.5344 286.4765c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/><g><defs><path id="SVGID_9_" d="M195.1881 292.1268c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9941 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.5344 288.6792 196.6366 290.6783 195.1881 292.1268z"/></defs><clipPath id="SVGID_10_"><use xlink:href="#SVGID_9_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_10_);fill:#fff" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/><path style="opacity:.13;clip-path:url(#SVGID_10_);fill:#020202" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/></g><g><defs><path id="SVGID_11_" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zM197.5344 286.4765c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/></defs><clipPath id="SVGID_12_"><use xlink:href="#SVGID_11_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_12_);fill:#56a55c" d="M173.11 270.0439c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7325-11.1497-10.9151-18.926-10.9151C182.5311 263.6346 177.0676 266.0863 173.11 270.0439z"/></g></g><rect x="199.3456" y="279.5436" style="fill:#56a55c" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#f1bc42" d="M189.0874 318.7208l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3305-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4472C177.5953 321.1724 183.0601 318.7196 189.0874 318.7208zM197.0804 340.5784c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 342.7176 197.0804 340.5784z"/><path style="opacity:.3;fill:#fff" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zM197.0839 340.5826c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/><g><defs><path id="SVGID_13_" d="M194.7376 346.2329c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 342.7853 196.1861 344.7844 194.7376 346.2329z"/></defs><clipPath id="SVGID_14_"><use xlink:href="#SVGID_13_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_14_);fill:#fff" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/><path style="opacity:.13;clip-path:url(#SVGID_14_);fill:#020202" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/></g><g><defs><path id="SVGID_15_" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zM197.0839 340.5826c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/></defs><clipPath id="SVGID_16_"><use xlink:href="#SVGID_15_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_16_);fill:#f1bc42" d="M172.6595 324.15c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8474-1.0151-7.6327-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 317.7407 176.6171 320.1924 172.6595 324.15z"/></g></g><rect x="198.8952" y="333.6497" style="fill:#f1bc42" width="122.6266" height="13.8671"/></g></g></svg></span><span class="text-uppercase font-weight-bold">한국어 버전 타이틀</span>
	</a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a  class="nav-link active" href="/blog/" ><span class="active">Blog</span></a>
			</li>
			
			
			
			<li class="nav-item dropdown d-none d-lg-block">
				

<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
	Korean
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
	
	<a class="dropdown-item" href="/en/blog/">English</a>
	
</div>
			</li>
			
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block">
<input type="search" class="form-control td-search-input" placeholder="&#xf002 사이트에서 검색…" aria-label="사이트에서 검색…" autocomplete="off">

</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
          </div>
          <div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
          </div>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5 pr-md-4" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This the multi-page printable view of this section.
<a href="#" onclick="print();return false;">Click here to print</a>.
</p><p>
<a href="/blog/">Return to the regular view of this page</a>.
</p>
</div>



<h1 class="title">Docsy Blog</h1>





    <ul>
    
  
  
  
  

  
    
    
	

    <li><a href="#pg-d152e960eefb7b459e706355f1fda630">2018 이전 글</a></li>



    
    <ul>
        
  
  
  
  

  
    
    
	

    <li><a href="#pg-2b0c131e07c296172fa04d43fb7bd1e3">!!</a></li>



    
  
    
    
	

    <li><a href="#pg-7ba656bcd500b2282964075565b365d1">wine</a></li>



    
  
    
    
	

    <li><a href="#pg-94e6694563c56e840ffd4b13822f6980">캐나다를 다녀왔다</a></li>



    
  
    
    
	

    <li><a href="#pg-a1313c864628eba100a333c27a471f66">샌프란시스코</a></li>



    
  
    
    
	

    <li><a href="#pg-452e6de8b6b60fd4026c9fa2ab4a89c3">토요일</a></li>



    
  
    
    
	

    <li><a href="#pg-dfe5fa5cddb7757f55f513fa6780d115"></a></li>



    
  
    
    
	

    <li><a href="#pg-54e085815fb1e90bf7b18ff736f475eb">Docker로 서버 배포 도전</a></li>



    
  
    
    
	

    <li><a href="#pg-4c4d3bd55bd18b3ca88fc7a983ae00db">Blog에 검색기능추가하기</a></li>



    
  
    
    
	

    <li><a href="#pg-3059255ded6f6c484c91122ad98d6ab2">ruby setting 정리하기</a></li>



    
  
    
    
	

    <li><a href="#pg-372e6c6e4023966db8fd7c45f5b70b27">GO data type</a></li>



    
  
    
    
	

    <li><a href="#pg-ba0eb4d1cf3790efa0e6401360ba865a">GO interface와 JSON</a></li>



    
  
    
    
	

    <li><a href="#pg-d55d4816074aba738c86229027a6f8b7">docker 이미지로 centos pull</a></li>



    
  
    
    
	

    <li><a href="#pg-dc9f3b49aeecbdfd1f7e8912b65be7c5">git rebase</a></li>



    
  
    
    
	

    <li><a href="#pg-6e72bba52b1d459134d136eff7741175">studying IOT</a></li>



    
  
    
    
	

    <li><a href="#pg-d7bf54a8c223467cb7158fe8459620a9">MYSQL</a></li>



    
  
    
    
	

    <li><a href="#pg-8082d529709b459f9b4164d5be63fbde">퇴사.</a></li>



    
  
    
    
	

    <li><a href="#pg-d48a1525918ac36ff3175242a6ae0cc2">아이디어들.</a></li>



    
  
    
    
	

    <li><a href="#pg-ca0f8b2e976da4240b59500ac05bd5ff">디버깅 ㅠㅠ</a></li>



    
  
    
    
	

    <li><a href="#pg-58c8bbf2e8cd69081b7d1e461f3d76fe">Class c#</a></li>



    
  
    
    
	

    <li><a href="#pg-cb39469ee72b87cc3bf3a91251ee382f">Datagrip으로 원격 Azure sql server와 연결하기</a></li>



    
  
    
    
	

    <li><a href="#pg-e148dc34f6034a3bca9307c3f23b8395">identity 모듈을 aspnetcore에 적용하기.!</a></li>



    
  
    
    
	

    <li><a href="#pg-8f2d6350a3a9ad665596ba1e46d2581d">항상 까먹는 linux 초기설정.</a></li>



    
  
    
    
	

    <li><a href="#pg-76898074417e7a904c334c366beee62f">iamport!</a></li>



    
  
    
    
	

    <li><a href="#pg-315c554954e88166af9fae635ac90028">getch, getchar, getche c 언어 입력에 대해서.</a></li>



    
  
    
    
	

    <li><a href="#pg-ad85f4390e131966941b5b394d0d93fb">DB 검색 문제</a></li>



    
  
    
    
	

    <li><a href="#pg-585cd2ad340c4abf05a63e140a420aa5">efcore로 관계형 데이터베이스 설계하기</a></li>



    
  
    
    
	

    <li><a href="#pg-cf0942dff51f909398bc2c2b6d91a1a2">c&#43;&#43;로 피보나치 짜기</a></li>



    
  
    
    
	

    <li><a href="#pg-7bcfd1703c9ea31a0fefc867540c9906">c# getter setter 속성</a></li>



    
  
    
    
	

    <li><a href="#pg-80409f15ca7604af5ef0fbeb1fdca16f">vscode update 문제. coreCLR</a></li>



    
  
    
    
	

    <li><a href="#pg-8d98d9ddbfdb0ffeb0cd82598f4a8532">python 가상환경에서 사용해보기.</a></li>



    
  
    
    
	

    <li><a href="#pg-98e78a7c5acfbe4afb56454502efbdf2">c&#43;&#43;</a></li>



    
  
    
    
	

    <li><a href="#pg-3450e818b3d4ed092d01031d4e3d2f48">Asp.net Core에서 로그인 기능 구현하기</a></li>



    
  
    
    
	

    <li><a href="#pg-81a3a13a371e06839510ff4ed6f5b76c">Asp.net repository pattern</a></li>



    
  
    
    
	

    <li><a href="#pg-07f953adf20c6e53b2467f41303c3479">operating system 요약</a></li>



    
  
    
    
	

    <li><a href="#pg-936db5b3897490074fcab775a1ac5851">논문 아이디어</a></li>



    
  
    
    
	

    <li><a href="#pg-f26e0cd84c6f0d539e85d0d4fc2fa34a">Asp.net study</a></li>



    
  
    
    
	

    <li><a href="#pg-3a74d2ed84a139a2f89740930cbacc77">가상화 기술</a></li>



    
  
    
    
	

    <li><a href="#pg-b0cd3556ecf93236878c12d758b2b517">랍스타 맛있다</a></li>



    
  
    
    
	

    <li><a href="#pg-4a2543332b7a28b2460f3553c052cd86">asp.net study</a></li>



    
  
    
    
	

    <li><a href="#pg-876d4196780603040ae9e884b3e281ff">가상화</a></li>



    
  
    
    
	

    <li><a href="#pg-c6301d9eec3d790c31fe69b331b2cd82">공부중</a></li>



    
  
    
    
	

    <li><a href="#pg-ce2bd3b2901fcf0db7d4c036db9ca2f8">실리콘 밸리</a></li>



    
  
    
    
	

    <li><a href="#pg-7bb00fe411e20c269d043577447cec85">JAVA</a></li>



    
  
    
    
	

    <li><a href="#pg-65fbf792fc10a6ee62353c1c52faa01b">Scheduling 의 관점에서 본 Thread</a></li>



    
  
    
    
	

    <li><a href="#pg-f2506e6ae7c9a69d2d9a0b09f623b324">네트워크 기말정리</a></li>



    
  
    
    
	

    <li><a href="#pg-69c109fecc4c3e3872f0b650bd3132a0">여행 어플리케이션</a></li>



    
  
    
    
	

    <li><a href="#pg-5890b2a2072b331bf21167ce499ff64c">operating system 요약</a></li>



    
  
    
    
	

    <li><a href="#pg-640c73fbb61f54301574f65a3fedf835">Bot framework seminar 준비</a></li>



    
  
    
    
	

    <li><a href="#pg-ebaf3a080d7f4cc05da6b2d18f86beda">Cryptography 중간고사</a></li>



    
  
    
    
	

    <li><a href="#pg-40cb554d6b3357edb4108d23d7e0fe08">배열 기초.</a></li>



    
  
    
    
	

    <li><a href="#pg-a88507ef951a0d6a883594407fd054cf">Malloc, pointer.</a></li>



    
  
    
    
	

    <li><a href="#pg-e57b257f7c45bd00a07bdb80deb758ff">network.</a></li>



    
  
    
    
	

    <li><a href="#pg-e3b676f3fd164fd797f4199237fd6a5e">데이터 마이닝.</a></li>



    
  
    
    
	

    <li><a href="#pg-d4e8f360d6380d22478fbd57b158efc9">2016-2</a></li>



    
  
    
    
	

    <li><a href="#pg-08341d4a57e8bf9935f8b9fcf718a5f6">ABOUT DOCKER</a></li>



    
  
    
    
	

    <li><a href="#pg-1c3a2ec27dc7485b69471ae91c627dcb">ABOUT WEB SERVER</a></li>



    
  
    
    
	

    <li><a href="#pg-4cab6181dc995c1a5f984e9d326c5868">azure deploy!(Nginx&#43;Passenger)</a></li>



    
  
    
    
	

    <li><a href="#pg-8e0bce59bc1f951cdbf2e01efabdfa03">PYTHON</a></li>



    
  
    
    
	

    <li><a href="#pg-fea55a51b4b901341edd293ead23d4da">커리어?..커리어!</a></li>



    
  
    
    
	

    <li><a href="#pg-211264775bbcd104c1752d594e48ae5c">Git!</a></li>



    
  
    
    
	

    <li><a href="#pg-b30faf004c8afffa6d5fe9bc032ffe04">mentoring 자료!</a></li>



    
  
    
    
	

    <li><a href="#pg-58d2796147445545b42f879cb588b4d6">드디어 3일간의 개고생이 끝났다.</a></li>



    
  
    
    
	

    <li><a href="#pg-8999ddb29437782cf315b76d5d5a00ab">ihanxing application 구현</a></li>



    
  
    
    
	

    <li><a href="#pg-cbe3298bd4273627ce522120428bedf2">rails 5 업데이트!</a></li>



    
  
    
    
	

    <li><a href="#pg-0f1702d99fad7a7b711511ba50bfa864">밤샘 코딩! 드디어 완성.(0802 수정)</a></li>



    
  
    
    
	

    <li><a href="#pg-6ab789de5358a44d422e80b06e7e96a5">jekyll blog를 처음 시작하며</a></li>



    
  
    
    
	

    <li><a href="#pg-643b127f60871dc652e6c8b53da03e3b">scaffold로 Rails application 누워서 만들기</a></li>



    
  

    </ul>
    
  
    
    
	

    <li><a href="#pg-936196286d8b2c724f189212da4526b8">2019</a></li>



    
    <ul>
        
  
  
  
  

  
    
    
	

    <li><a href="#pg-488f0ebb0a422b1ed493c128b199c91b">Wine list for beginners</a></li>



    
  
    
    
	

    <li><a href="#pg-55a315b9f51fcea8969bee7d245547e1">Passing Slice to a function</a></li>



    
  
    
    
	

    <li><a href="#pg-ab9a7f95cb158b008022bd723c3ae945">gorm-postgresql 사용 주의</a></li>



    
  
    
    
	

    <li><a href="#pg-d91144f1aecf6aa2e42f313a5c43cf5a">string split</a></li>



    
  
    
    
	

    <li><a href="#pg-ac3992195bdfe2da845c2fc8c030e646">goland tips</a></li>



    
  
    
    
	

    <li><a href="#pg-6b0851710c0f814de79273292d4588ce">DDA 스터디</a></li>



    
  
    
    
	

    <li><a href="#pg-b79aff5e78952dc2748e8e69b6628636">클로저를 고루틴으로 실행할때 주의할점.</a></li>



    
  
    
    
	

    <li><a href="#pg-106c32897074f874669df46ca3978460">concurrency is not parallelism</a></li>



    
  
    
    
	

    <li><a href="#pg-2e3cdd17f1d9860366f68fd26bb2ec6f">aws-lambda-in-go</a></li>



    
  
    
    
	

    <li><a href="#pg-27df5ade3010b14a6dd5ca2b3146b1f8">scripting in github action</a></li>



    
  
    
    
	

    <li><a href="#pg-5b9d5d2318c342f6b5f9c03d26400563">ssh tunneling</a></li>



    
  
    
    
	

    <li><a href="#pg-1b756cfc3b08669fde63190db6b73a87">aws-lambda</a></li>



    
  
    
    
	

    <li><a href="#pg-db4a5139db28ab728d63e5fb8dec0209">docker-compose up</a></li>



    
  
    
    
	

    <li><a href="#pg-854ed346fc46732b8d436bcd5617026d">rune ?</a></li>



    
  
    
    
	

    <li><a href="#pg-67575c6ae03ca092937fd8f8f3c18a49">Django tutorial</a></li>



    
  
    
    
	

    <li><a href="#pg-4cb1018c33a47db3bc3d07ddce484bf4">언니가 사준 맥 립스틱 색깔</a></li>



    
  
    
    
	

    <li><a href="#pg-2ba4924ed323a7f7575d27a5347cb5ff">How to study GOlang</a></li>



    
  
    
    
	

    <li><a href="#pg-e0452db584ade6c5afb908229e686e8b">리뷰해보고 싶은 Gin Boilerplate</a></li>



    
  
    
    
	

    <li><a href="#pg-f378d86b2613e0fa3334030ba313b7fb">Dataproc</a></li>



    
  
    
    
	

    <li><a href="#pg-433f8ffea0d4a2ddbdbae09c58e69202">Dataproc</a></li>



    
  
    
    
	

    <li><a href="#pg-5b7cccb8a01fb35797a2e436cba41ed8">VPC and NAT</a></li>



    
  
    
    
	

    <li><a href="#pg-cc8e3e9b4e558982e4f8ac1a2a319e49">golang slice</a></li>



    
  
    
    
	

    <li><a href="#pg-4224d92d0c2e1fd7e73c91c70622233f">VPC and NAT</a></li>



    
  
    
    
	

    <li><a href="#pg-85cddadd9e786089f6ba2938846297ab">Http connection reusing in Go</a></li>



    
  
    
    
	

    <li><a href="#pg-016edfdb0f84384ff5a6c8b520372ac4">VPC and NAT</a></li>



    
  
    
    
	

    <li><a href="#pg-01b5fccd3bc6dcf7ca4588c125302d5c">Data consistency</a></li>



    
  
    
    
	

    <li><a href="#pg-f5e9ba60b472dded5592163b23bd313d">AWS Sessions</a></li>



    
  
    
    
	

    <li><a href="#pg-da90d78651569b6db86744d37c606564">Web Developer 101</a></li>



    
  
    
    
	

    <li><a href="#pg-7e135a0c12503feae8c395be8d8bba88">Go JSON</a></li>



    
  
    
    
	

    <li><a href="#pg-2a4201f5d0697dc78990ecced3be44b5">Panic Recover</a></li>



    
  
    
    
	

    <li><a href="#pg-b788bed69318261c2d9c7ad15e0672f1">mac local kubernetes setup</a></li>



    
  
    
    
	

    <li><a href="#pg-62c439d6d48797554a516e2000d975e3">golang nil check</a></li>



    
  
    
    
	

    <li><a href="#pg-d79c3fedd310c9fb9b42d7c0da7c295e">Kubernetes Deployment(삽질)</a></li>



    
  
    
    
	

    <li><a href="#pg-d53c72cb81c4e15423fcac286eacb365">reflect 어떻게 쓰지 - 1</a></li>



    
  
    
    
	

    <li><a href="#pg-8bdfe4098c42101747264a2bec233bd7">reflect 어떻게 쓰지 - 2</a></li>



    
  

    </ul>
    
  

    </ul>


<div class="content">
      <p>블로그</p>

</div>
</div>


  
  
  
  

  
  

  
    
    
	
    


  

<div class="td-content" style="">
    <h1 id="pg-d152e960eefb7b459e706355f1fda630">2018 이전 글</h1>
	
	<div class="td-byline mb-4">
		
        
	</div>
	
</div>





    
      
  
  
  
  

  
  

  
    
    
	
    


  

<div class="td-content" style="">
    <h1 id="pg-2b0c131e07c296172fa04d43fb7bd1e3">!!</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2018-02-02" class="text-muted">2018.02.02</time>
        
	</div>
	<p>시간 꽤 안간다 싶었는데, 눈 떠보니 2월이다. 1월은 꽤 dynamic했다. 2일에 입사해서, 정신없이 일주일을 보내고, 핸드폰 지르고, 카드 만들고, 헤드폰 지르고, 차 지르고, 또 여러가지 지르고, 월급날 기다리고, 하다보니 또 어느새, 정신없이 3주가 지났다. 중간중간 고민을 많이 했던 것같기도하고, 내가 지금 여기서 일하고 있는 게 잘 하고 있는건지 잘 모르겠기도 하고, 했던 것같다. 어쨌든 무사히 한달을 지냈다.</p>
<p>꽤 많은 일이 일어났던 한달이었다.</p>
<p>안에서 가족들과나, 밖에서 회사에서나,</p>
<p>어쨌든, 뭔가 다 잘 풀린것같다. 다행이다. 정말.</p>
<p>이번주부터는 운전연습을 시작했다. 면허딴지 얼마 안되서 그런지 다행히도 감을 금방 찾은 것같다. 물론 위기가 몇번 존재하기는 했다. 박을 뻔한&hellip;ㅎㅎㅎ 그리고 아버지 친구인 <em><strong>아저씨</strong></em> 도 뵜다.</p>
<p>의외로 정말 좋으신 분이었다. 조용조용 말씀해주시면서, 많은 말씀을 해주셨다. 근처 일본식 와규 전문점까지 가서 고기도 사주셨다. 내가 생각한 아저씨~ 스타일이 아니라서 놀랐던 것같다. 인생에서 중요한 것들에 대해서 멀리 볼 수 있기를 바라신 것같다. 실력을 쌓는 것이 일단 신입의 입장에서는 중요하지만, 앞으로 인생을 살면서는, 다른 사람들에게 좋은 인상을 주고 신뢰를 줄 수 있어야 한다는 말, 결국엔 다 사람이라는 말이 많이 와닿았다. 주변 사람들에게 신뢰를 주고, 좋은 인상을 남기고, 많은 좋은 사람들을 만나는 게, 결국 내 자산이 된다는 말이 아직 기억에 남는다. 굳이 다른 회사를 가는 게 아니더라도, 1년마다 이력서를 써보라는 말씀도 좋았다. 내가 1년동안 무슨 일을 했는지, 어느 부분에 어떤 기여를 했는지 나 자신에 대해서 돌아볼 수 있는 기회가 될 거라고 말씀해주셨다. 또한 5년차 정도의 멘토를 구해보라는 말씀도 해주셨다. 내 커리어적인 상황을 속 시원히 털어놓을 수 있을 만한 좋은 분을 구해보라고 조언해주셨다. 정말 맞는 말인 것같고 크게 공감할 수 있었다. 귀한 시간 내서 내게 여러 좋은 말씀을 해주신 아저씨께 참 감사드린다.</p>
<p>더 잘 행동하고, 더 좋은 사람이 되고싶다는 생각이 든다. 나 자체를 바꿀 수는 없겠지만, 나의 character에서 나올 수 있는 가장 좋은 방향으로 나아가고 싶다. 책임감있고, 신뢰를 줄 수 있는 사람이 되고싶다.</p>
<p>노력해야겠다! 더 좋은 사람이 되어가고 있는 나 자신을 보는게 제일 행복한 것같다.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-7ba656bcd500b2282964075565b365d1">wine</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2018-01-30" class="text-muted">2018.01.30</time>
        
	</div>
	<p>프랑스 와인의 주요 산지는 보르도, 부르고뉴, 론 세가지로 나눌 수 있다.
이 중 부르고뉴를 살펴보자.</p>
<p>부르고뉴 지방은 샤블리, 마코네, 코트 샬로네즈, 코트 드본, 코트 드뉘, 보졸레 로 나뉘어 있다. 각 지역의 레드와인과 화이트 와인 생산 비율을 살펴보면, 샤블리는 화이트 100%, 마코네는 레드 15% 화이트 85%, 코트 샬로네즈 레드 65%, 화이트 40%, 코트 드본은 레드 70% 화이트 30%, 코트 드뉘는 레드 95% 화이트 5%, 보졸레는 레드 99% 화이트 1%이다.</p>
<p>부르고뉴의 포도 품종은
RED:
한국인에게 선호도가 높은, 옅은 컬러와 부드러운 탄닌, 좋은 산도를 가진 Pinot Noir와
가볍고 fruity한 Gamay를 재배한다.</p>
<p>White:
제조사와 지역에 따라 다양한 스타일을 가지는 Chardonnay(샤도네이),
강한 신맛과 신선한 향을 가지는 Aligote를 재배한다.</p>
<p>부르고뉴의 와인 aoc 등급을 분류하면,</p>
<ul>
<li>aoc Gran Cru</li>
<li>aoc premier Cru</li>
<li>aoc village</li>
<li>aoc regional</li>
</ul>
<p>4가지로 나뉜다.</p>
<p>부르고뉴 화이트 와인은</p>
<ul>
<li>샤블리(Chablis)</li>
<li>코트 드 본</li>
<li>마코네
등이 유명하고, 위에서 말했다싶이 산지를 의미한다. 그 중 샤블리는 100% 샤르도네(or 샤도네이)로 만들어지며, 지역 특유의 선선한 기후 덕에 가볍고(or 신선하고) 섬세한 타입의 화이트 와인이고 미네랄 풍미가 강하다. 굴 등 해산물과 조합이 좋다. 샤블리 와인은 쁘띠 샤블리 &lt; 샤블리 &lt; 샤블리 premier Cru &lt; 샤블리 Gran Cru 로 등급이 나뉜다.</li>
</ul>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-94e6694563c56e840ffd4b13822f6980">캐나다를 다녀왔다</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-11-08" class="text-muted">2017.11.08</time>
        
	</div>
	<p><img src="https://brightcove04pmdo-a.akamaihd.net/5104226627001/5104226627001_5230047963001_5203640497001-vs.jpg?pubId=5104226627001&amp;videoId=5203640497001" alt="Canada">
구글에 캐나다를 치면 나오는 이미지이다.</p>
<p>나는&hellip;그냥 캐나다가 가고 싶었다.
<em>I wanted for a long time to travel Canada</em></p>
<p>I don&rsquo;t know the exact reason why I wanted it, but maybe I would be attracted by the image of the country flag and the image of Canada itself. Maybe just a kind of admiration. I just thought that Canadian would be cool. There were no specific reason.</p>
<p>내가 왜 원했는지에 대한 정확한 이유는 모른다. 아마, 캐나다 국기나, 캐나다라는 나라가 가지고 있는 그 특유의 이미지에 끌렸던 것같다. 어쩌면 동경..이라고 표현할 수 있겠다. 캐나다 사람들은 그냥 뭔가 멋있을 거라고 생각했다.</p>
<p>So, I decided to go Canada. I&rsquo;ve experience Europe twice. Once with my college friends and once with my mother. Actually I wanted to go Canada alone, because I thought that I have some important things to think about alone. I had a harsh time at summer and I felt that I had a really important decision in my life. I chose the life of developer. Not just developer, not developer of Korean big company, THE DEVELOPER itself. I wanted to think about the past and present of myself. Are you going right? Is it the right way to become happy? Maybe this record can make myself very embarassing, but my final goal is to be happy, so being sure that I&rsquo;m going right was really important.</p>
<p>그래서, 난 캐나다에 가기로 결심했다. 유럽은 두 번 경험해봤고, 한 번은 대학 친구들, 한 번은 엄마랑 다녀왔다. 사실 캐나다는 혼자 가고 싶었다. 혼자 생각할 만한 거리가 많다고 생각했기 때문이었다. 대학생활에서 개발때문에 힘들어하고, 개발자로서의 삶이 내게 맞는 것인지 굉장히 고민하던 3년을 보냈으면서, 편한 길을 포기하고 개발자로서의 삶을 선택했다. 내 선택이 맞는 것인지, 어떻게 나는 그런 선택을 하게 되었는지 나 자신의 과거와 현재를 돌아보고 싶었다. 맞는 길을 가고 있는 건지, 행복해질 수 있겠는지. 나중에 이렇게 일기를 써놓은 걸 보면 이불을 차는 수준을 넘어 이불과 지구밖으로 발사될정도로 민망할 수도있지만, 나는 최종적으로 행복해지는게 인생의 목표인 사람이라, 내가 선택한 이 길이 행복으로 갈 수 있는가가 정말 중요했다.</p>
<p>However, afraid of my mother and myself, I decided to go Canada with 2 friends. I was little bit concerned, because they were not that so close friends with me. They were not special friends, they were just college friends! I know I don&rsquo;t have many special friends. After 20, it was hard to make really close friends and maintain the close relationship with old friends.</p>
<p>하지만, 엄마, 그리고 나 자신에 대한 두려움으로, 두 명의 친구와 캐나다를 가기로 결정했다. 별로 그렇게 친한 친구들이 아니어서, 사실 좀 걱정했다. 혹여나 싸울까,,,,그냥 대학 동기/선배였으니깐, 물론 나는 특별한 친구들이 그렇게 많은 편이 아니다. 20살 이후에는 정말 친한 친구를 만들기 어렵거니와, 기존 친구들과의 관계를 유지하기 어려웠기 때문이었다.</p>
<p>If I would say the result in one sentence, it was a total success.
한 문장으로 결과를 말한다면, 완전 성공이었다.</p>
<p>Still, I truly feel thankful for my friends who traveled with me. I think the wonder I could feel in Canada doubled because of them. There was unexpected &ldquo;chemistry&rdquo;, as the word directly means, with the friends. I slowly and totally felt the original wonder of nature. I was temporarily isolated from the casual life.
여전히, 난 나와 여행한 친구들에게 진정 감사함을 느낀다. Canada에서 느낄 수 있었던 감동은 친구들 덕분에 두배가 되었다. 다른 사람과 함께였다면, 또는 나 혼자였다면, 느낄 수 없었던 것들을 많이 느낄 수 있었다. 정말 문자 그대로 의외의 &ldquo;케미&quot;를 이 친구들과의 캐나다에서 느낄 수 있었다. 자연 자체의 아름다움을 천천히, 또 온전히 느낄 수 있었고, 잠시 일상으로부터 분리되어있었다.</p>
<p>그림에서만 보던, 아니, 그림보다 약 100만배는 더 예쁜, 아름다운, 멋있는, 황홀한 풍경들을 눈에 담을 수 있었고, 귀에 들을 수 있었고, 코에 냄새 맡을 수 있었다. 왜 breath-taking view라는 단어가 존재하는지 알 수 있었고, 왜 자연 앞에 인간은 정말 작은, 티끌만한 존재인지 알 수 있었다.</p>
<p>그냥 너무 예뻤다.
그냥 좋았다.
그냥 가만히 있어도 행복했다.</p>
<p>그리고 우리의 bgm도 얻었다. yuki guramoto - lake louise, 지금도 이 음악을 들으면 호수가 머리 속에서 쫙~</p>
<p>사실 캐나다를 다녀와서, 여행을 다녀왔다고 해서 정답을 얻진못했다.</p>
<p>조금 더, 정답을 계속 생각해보는 걸로. 일단 지금은, 일상으로 돌아왔지만, 나름 행복하다.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-a1313c864628eba100a333c27a471f66">샌프란시스코</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-09-09" class="text-muted">2017.09.09</time>
        
	</div>
	<p>샌프란시스코의 기억을 잊고 싶지 않아 몇가지 사진을 올려본다. 호오,,생각해보면 참 좋았다. 유럽도 너무 좋았지만, 미국도 난 정말 좋았다. 둘 다 또 가고싶다!!
시청 지나서 시내에서 구경중
<img src="https://lh3.googleusercontent.com/a6Ni1gqzCGmOWwnfV7tP8tSriDdAndZLB64LGk0hPJWQJF-5b7GDZ2jrWf5hZgDJGSc9CsNZ=w2688-h1934" alt="언덕 올라가는길"></p>
<p>샌프란시스코 내 유명한 언덕, 이름이 기억 안남, 언덕 위 올라가는 길에 있었던 빅토리아풍 저택
<img src="https://lh5.googleusercontent.com/kbq_sKPDae8_5MUHH7Zw-cGjctNgyfPxBsvKCwVt1kbQJ3VIVOKqR73x8-dqYqk8gIS93PX6S4b0IXc=w3360-h1952-rw" alt="언덕 올라가는 길"></p>
<p>스탠포드 대 내부
<img src="https://lh6.googleusercontent.com/cJujUVJbKocOJl6VC5LG4RzqXheflsKSyj7xglZoEZff8p1UmwodoS5_OOJH_mHBQCsldxFIJkHlq7A=w3360-h1952-rw" alt="스탠포드"></p>
<p>스탠포드 컴퓨터공학과
<img src="https://lh3.googleusercontent.com/8Z18pWodOseguKqwOwXE29mj-bg9MT-BDnHL2EQ2PHUZfimZErB6bSH6GBcRg-_l1-Rn7t9-uFTs-mk=w3360-h1952-rw" alt="스탠포드 컴퓨터공학과"></p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-452e6de8b6b60fd4026c9fa2ab4a89c3">토요일</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-09-09" class="text-muted">2017.09.09</time>
        
	</div>
	<p>일반적인 배열, cpp의 Vector 컨테이너 : 개체들을 연속적인 메모리 공간에 저장, 따라서 position index로 접근이 가능하다(상수 복잡도 가능). 원소들 간 포인터 연산 가능.(포인터 연산 말씀하신게 이거였구나아아!)
만약에 일반적인 linked list로 만들어졌다면, 연속적인 메모리공간에 저장되지않았을 것이므로, 포인터 연산이 불가능하고, position index로 접근할 수 없었을 것이다. 한 원소를 찾을 때도 처음이나 끝부터 선형탐색해야한다. 단, 컨테이너 내 어느 위치에서도, 삽입/삭제가 빠르다.</p>
<p>cpp의 stack과 queue는 각각 deque, list 기반으로 만들어진 컨테이너다.
<a href="https://stackoverflow.com/questions/2247982/c-deque-vs-queue-vs-stack">stackoverflow</a>게시글에서 참조했듯이,</p>
<blockquote>
<p><em>stack은 deque를 underlying 컨테이너로 사용하여 만들고, queue는 list를 underlying 컨테이너로 하여 만든다. 즉, stack은 제한된 deque, queue는 제한된 list로 볼 수있다.</em></p>
</blockquote>
<p>deque은 앞(front)에서도, 뒤(Last)에서도 삽입/삭제가 가능한, 양 끝단(end)이 존재하는 double-ended queue이다. deque은 stack 뿐만 아니라 queue를 구현하는 컨테이너로도 쓰일 수 있다. stack은 FILO으로, stack의 top, 즉, 뒷 부분에서만 삽입/삭제가 가능하고, queue는 앞에서 삭제, 뒤에서 삽입이 가능하므로, restricted deque라고 할 수 있다.</p>
<p>Gradient descent(경사 하강법, Optimizer)을 이용해 Cost function의 value가 최소인값을 찾는다. 미분을 하면 조금 더 쉽겠지만, feature가 여러개일때는 미분이 어렵기 때문에 Gradient descent가 좀 더 적합한 방법이다.</p>
<p><strong>Linear Hypothesis</strong>
H(x1, x2, x3, &hellip;, xn) = w1x1+ w2x2+ &hellip;. + wnxn
H(x)= Wx+b(w: 가중치 &amp; b: bias, 절편)</p>
<p>Binary Classification
<strong>Sigmoid Function</strong>
미분가능하게,</p>
<p><strong>logistic</strong>
minimum값이 여러 개(local minimum, gloal minimum)가 되지 않고 최적값을 찾을 수 있도록.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-dfe5fa5cddb7757f55f513fa6780d115"></h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-08-28" class="text-muted">2017.08.28</time>
        
	</div>
	<p>2달간의 인턴 기간동안 배운 것을 정리해두지 않으면, 정말 큰 손해일 것 같다는 생각이 문득!들어 정리를 결심했다.</p>
<p>&mdash;&mdash;&mdash;2018.1.30
하지만 지금 보니! 난 정리를 안했었군! 이런,,,나레기</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-54e085815fb1e90bf7b18ff736f475eb">Docker로 서버 배포 도전</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-08-28" class="text-muted">2017.08.28</time>
        
	</div>
	<h1 id="azure-deploynginxpassenger">azure deploy!(Nginx+Passenger)</h1>
<p>애저 deploy 게시글을 쓴지 1년이 지나있다. 작년 8월 23일 작성한 게시글이었는데, 1년동안 많이 성장했다는 생각이 들면서도 많이는 나아가지 못한 듯하여 아쉽다. 제대로 이해했다고 생각했는데, 제대로 이해하지 않고 넘어간 부분이 많았고(Nginx가 어떤 역할을 하는 줄은 알고 썼던 거니&hellip;?), 지금 생각해보면 후회되는 시간들이 많았던듯하다. 빨리 가을이 왔으면 좋겠고, 에너지가 생겨서 더 열심히 살 수 있었으면 좋겠다.</p>
<h1 id="docker로-서버-배포하기">docker로 서버 배포하기</h1>
<p>1년 전에 작성한 그 게시글을 docker로 대체해보고자 한다. 가상컴퓨터에 docker를 올려서 db용, web application server 용 두 개의 docker를 올려서 배포를 시도해보려고 한다. 해당 시도를 위해 몇 가지 정말 좋은 튜토리얼을 찾았다.</p>
<p><a href="http://raccoonyy.github.io/docker-for-ghost-blogging/index.html">raccoonyy님의 블로그</a>
<a href="https://subicura.com/2017/01/19/docker-guide-for-beginners-2.html">subicura님의 블로그</a></p>
<p>갓개발자! 님들이 정말 자세한 튜토리얼을 올려주셨다. 대체로 위 튜토리얼을 따라해보는 형태로 진행해보았다.</p>
<p>나의 경우에는 비교적 간단하니
docker-compose 기능을 통해 web server, db server를 docker-compose.yml 파일에 정의하면 될 것으로 예상된다.</p>
<h2 id="vm-접속-docker-설치">vm 접속, docker 설치</h2>
<p>기본 credit으로 vm을 만들었다. 컴퓨터를 바꿔서 그런지, 아니면 1년 전과 달리 애저 포탈이 업그레이드 된 건지, 모든 과정이 훨씬 순조롭게 진행되었다. 그냥 공개 키 넣고 만든 후에 <em>ssh username@public_ip</em> 이렇게 하니깐 바로 접속되서 꽤 놀랐다.</p>
<p>접속한 vm에서</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">curl -s https://get.docker.com/ <span style="color:#000;font-weight:bold">|</span> sudo sh
</code></pre></div><p>docker는 root 권한인 sudo가 필요하기 때문에, 새로운 비밀번호를 설정하기 위해 sudo passwd로 비밀번호를 설정해준 후 root 권한으로 명령어를 수행한다.</p>
<p>설치 완료는</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">docker version
</code></pre></div><p>명령어로 확인 할 수 있고, Client, Server 두 가지 모두 나와야 정상적으로 설치된 것이다. 도커 자체적으로 사용자로부터 커맨드를 받아 Server에 전달하는 Client, 실제 일을 수행하여 결과를 client에게 전달하는 docker Server로 나눠져 있다고 볼 수 있기 때문이다.</p>
<table>
<thead>
<tr>
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>-d</td>
<td>detached mode, 백그라운드 모드</td>
</tr>
<tr>
<td>-p</td>
<td>호스트와 컨테이너의 포트를 연결(포트 포워딩), 9000:9000</td>
</tr>
<tr>
<td>-v</td>
<td>호스트의 볼륨을 컨테이너와 공유하여 사용(마운트)</td>
</tr>
<tr>
<td>-e</td>
<td>컨테이너에서 사용할 환경변수를 설정한다</td>
</tr>
<tr>
<td>-name</td>
<td>컨테이너의 이름을 설정한다</td>
</tr>
<tr>
<td>-rm</td>
<td>프로세스 종료 시에 컨테이너를 자동으로 제거한다</td>
</tr>
<tr>
<td>-it</td>
<td>-i, -t 옵션을 동시에 준것으로 터미널 입력을 위한 옵션</td>
</tr>
<tr>
<td>-link</td>
<td>컨테이너들을 연결한다</td>
</tr>
<tr>
<td>{:.mbtablestyle}</td>
<td></td>
</tr>
</tbody>
</table>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">Docker -link ~ ~ -p 12201:12201/udp -p 5555:5555
//should publish in multiple ports to listen udp/tcp, default tcp -&gt; it is port binding between docker and host

docker create -i -t -v ~/projects:/root/workspace -w /root --name centos7_project -e <span style="color:#000">TZ</span><span style="color:#ce5c00;font-weight:bold">=</span>Asia/Seoul centos

docker start -I centos7_project
</code></pre></div><p>맨 위 명령어는 MongoDb, ElasticSearch, GraylogServer 세개의 컨테이너를 한번에 열었어야 했을 때 사용했던 명령어였다. 두개의 포트를 열고자 했고 하나는 udp, 하나는 tcp로 열고자 했다. 이렇게 /udp를 붙여주지 않으면 기본으로 tcp 포트로 생성된다.</p>
<p>두번째 커맨드는 centos라는 컨테이너를 생성하는 커맨드인데, -it 옵션에, -v 옵션을 통해 host의 projects폴더를 마운트하여 사용하였다. -w는 컨테이너의 작업 디렉토리를 root로 하겠다는 것이고 컨테이너 이름을 centos7_project로 할것이며 centos 이미지 위에 writable container layer을 만들것임을 의미한다. 컨테이너를 만들었으니 아래 커맨드는 만든 컨테이너를 시작하는 커맨드이다.</p>
<h2 id="컨테이너-실행해보기">컨테이너 실행해보기</h2>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">docker run ubuntu:16.04
</code></pre></div><p>run 커맨드를 통해 ubuntu:16.04 이미지가 저장되어 있는지 확인하고, 없다면 Pull을 통해 다운로드 하여 컨테이너를 Create한 후 Start한다. 즉, run 커맨드는 여러 커맨드들이 합쳐져 있는 커맨드라고 할 수 있다.</p>
<p>References)
<a href="https://docs.docker.com/engine/reference/commandline/create/#initialize-volumes">docker 공식 documentaion</a>
<a href="https://stackoverflow.com/questions/28806135/jekyll-kramdown-how-to-display-table-border">jekyll에서 표 그리는 법</a></p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-4c4d3bd55bd18b3ca88fc7a983ae00db">Blog에 검색기능추가하기</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-08-13" class="text-muted">2017.08.13</time>
        
	</div>
	<h1 id="blog에-검색-기능-추가하기">Blog에 검색 기능 추가하기</h1>
<p>전부터 계속 시도했던 건데, 왜 인지 기억은 안나지만, 중간에 포기했었다. Jekyll 테마찾다가 우연히 검색기능을 다룬 블로그글을 보고 뽐뿌받고 어제 몇시간동안 삽질하다가 결국 처리했다. 최종발표 피피티는 도대체 언제만들까 ㅋㅋ..</p>
<p>일단 몇가지 Jekyll 블로그가 어떻게 generate되는 지 이해해야 될 것이 있었는데, 그걸 모르고 계속 삽질 하다보니 오래걸렸었다.
<a href="https://stackoverflow.com/questions/13266369/how-to-change-the-default-order-pages-in-jekyll/16625558">stackoverflow</a>에서 관련내용을 보고 무릎을 탁 치고 한줄 탁 치니까 해결되었다. ㅜㅜ</p>
<p>뭐였나면,,,</p>
<h3 id="heading"></h3>
<p>각 html이나 markdown파일마다 layout을 정의하는게 규칙인데, 일반적인 글을 올릴때는 post로 지정해둔다. layout 폴더로 들어가보면, post, default, page, category_index가 있는데, 이것들이 site.pages, site.posts들을 의미하는 거였다. site는 이 블로그 자체를 의미하고 layout이 page냐 post냐 에 따라 각각 site.pages site.posts들에 저장되고 있었다(Jekyll 엔진 자체적으로 처리). 내가 원했던 건 메뉴에 search를 추가하는 것이었다.</p>
<p>{% highlight ruby%}
assign pages_list = site.pages | sort:&ldquo;url&rdquo;
for node in pages_list
if node.title != null
if node.layout == &ldquo;page&rdquo;
<li class="sb-close { if page.url == node.url }active{ endif }">
<a href="{{ node.url | prepend: site.baseurl }}">{{ node.title }}</a>
</li>
endif
endif
endfor
{% endhighlight%}</p>
<p>메뉴가 있는 includes/sidebar.html에는 이런식으로 코드가 작성되어있었기 때문에, pages_list = site.pages는 layout이 page인 파일들을 의미하는 것이었다. 따라서 page_list에 search를 추가하여 메뉴를 추가해야했다. 이는 search.html에</p>
<h2 id="-highlight-ruby">{% highlight ruby%}</h2>
<h2 id="permalink-search">layout: page
title: Search
permalink: /search/</h2>
<p>{% endhighlight%}</p>
<p>이런식으로 추가해주면 jekyll에 의해 자동으로 search가 page로 인식되고 pages_list에 search도 들어간다.</p>
<p>아무튼 이제 메뉴에 search를 추가했으니, 실제로 검색을 위한 로직이 필요하다. 이는
<a href="https://github.com/christian-fei/Simple-Jekyll-Search">Simple-Jekyll-Search</a>라는 JS 라이브러리를 사용했다. JS 라이브러리이기 때문에 NPM을 사용하여 설치할 수 있는데,</p>
<p><em>npm으로 설치하면 ~.min.js만 설치되서 이것만 로드하면 될 줄 알았더니 안되더라&hellip;.물론 내가 잘 못 설치한 걸수도 있음.</em></p>
<p>결국 레포지토리에서 Simple-Jekyll-Search.js인가 이거 다운받아서 루트 폴더 밑에 dest 폴더 만들고 넣어줬다. search.html에서 그 파일을 로드해줬고. 이외에도 plugin에 루비파일 넣고 몇가지 과정이 자잘자잘하게 해주면 된다. 이 <a href="http://www.halryang.net/simple-jekyll-search/">블로그</a>에서 많이 참조해서 만들어놨다. 아마 Json을 이용해서 검색을 수행하는 듯하다. 매우 쫗은 라이브러리 감사합니당당당~.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-3059255ded6f6c484c91122ad98d6ab2">ruby setting 정리하기</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-08-13" class="text-muted">2017.08.13</time>
        
	</div>
	<h1 id="ruby-환경설정">RUBY 환경설정</h1>
<p>ruby 자체를 Programming에 쓸 일은 별로 없지만, (요즘엔 Rails도 안쓰고 스크립트는 거의 Python으로 처리하므로,) 맥에 ruby를 깔아둬야 할 일은 꽤 자주 발생했다. 일단, Mac에서 많이 쓰는 Package Manager인 Homebrew도 ruby 기반이라 ruby가 설치 되어있어야하고, 지금 이 정적 블로그 엔진도 Jekyll이라는 ruby 기반 엔진이라, ruby가 없으면 로컬에서 돌려볼 수가 없었다. 컴퓨터를 바꾸기도 했었고 초기화로 메모리를 모두 날려먹은 적이 있어 기존에 설치해둔 ruby가 없어 설치하는 김에 이번 기회에 아예 게시글로 정리해두려고 한다.</p>
<p>알다시피 맥에는 기본 Ruby가 깔려있다. 초반에는 이 기본 Ruby로 어찌저찌 해결했는데, Gem을 깔아야되는 상황이 되니 기본 ruby를 건드렸다간 큰일이날 듯했다. 물론 권한도 없었다. 하지만 강제로 권한을 풀었다간 뭔가 큰 일이 날것같은 느낌. 어디인지는 모르겠지만 Mac에서 기본적으로 ruby를 가지고 있는 이유는 어딘가에서 ruby를 시스템용으로 사용하기 때문이다. 결국 이 기본 ruby는 사용하지 않고 막 쓸 별개 ruby를 깔기로 했다. 정확히 기억은 안나지만, python도 비슷한 이슈를 가지고 있어서 virtualenv라는 가상환경을 사용했던듯하다. ruby에도 이런 환경(?) 매니저를 가지고 있다. 프로젝트마다 필요한 루비 버전이 다를 수 있기 때문에 해당 프로젝트에서 사용할 루비를 지정할 수도 있고 시스템 전반에서 주로 사용할 ruby를 지정할 수도 있다.</p>
<p>Environment Manager for Ruby로 RVM과 rbenv 두 개가 있는데, 예전에 Rails를 2015년 하반기 처음 입문했을 때만해도 rvm을 많이 썼었다. 그때는 그냥 rbenv가 이름이 더 이뻐서 그걸 썼는데, 지금 다시 관련내용을 찾아보니, 거의 rbenv로 대세가 넘어왔다. 많은 게시물들이 rbenv를 다루고 있었다.</p>
<p>{% highlight bash%}
brew update
brew install ruby</p>
<pre><code>Homebrew를 이용해서 Ruby를 설치하는것이 훨씬 편하다. 공식 페이지에서도 권장하고 있다. Homebrew가 없다면 밑에 링크에서 다운받도록 한다. Homebrew를 설치하는 데 필요한 루비는 맥 기본 루비이기때문에 루비를 따로 설치하지 않아도 그냥 Homebrew부터 깔면된다. Node, MySql등 여러 툴들을 사용할 때도 굉장히 유용하게 쓸 수 있기 때문에 맥 사용자라면, 깔아두는 것을 추천한다.
[Homebrew 설치하기](https://brew.sh/index_ko.html)

{% highlight bash%}
# If you use bash
echo 'export PATH=/usr/local/Cellar/ruby/2.4.1_1/bin:$PATH' &gt;&gt; ~/.bash_profile
# If you use ZSH:
echo 'export PATH=/usr/local/Cellar/ruby/2.4.1_1/bin:$PATH' &gt;&gt; ~/.zprofile
</code></pre><p>나는 Oh-my-zsh라는 zsh 쉘을 쓰고 있기 때문에 아랫줄을 실행해주었다. 쉘에 PATH를 설정해주는 작업이다. 2.4.1_1 이는 버전명으로 설치한 버전명을 넣도록 한다.</p>
<p>{% highlight bash%}
brew install rbenv ruby-build</p>
<h1 id="zsh">zsh</h1>
<p>echo &lsquo;export PATH=&quot;$HOME/.rbenv/bin:$PATH&quot;&rsquo; &raquo; ~/.zprofile
echo &lsquo;eval &ldquo;$(rbenv init -)&quot;&rsquo; &raquo; ~/.zprofile</p>
<h1 id="list-all-available-versions">list all available versions:</h1>
<p>rbenv install -l</p>
<h1 id="install-a-ruby-version">install a Ruby version:</h1>
<p>rbenv install 2.4.1</p>
<h1 id="set-ruby-version-for-a-specific-dir">set ruby version for a specific dir</h1>
<p>rbenv local 2.4.1</p>
<h1 id="set-ruby-version-globally">set ruby version globally</h1>
<p>rbenv global 2.4.1</p>
<p>rbenv rehash
gem update &ndash;system</p>
<pre><code>ruby를 깔았으니, 버전 관리 툴인 rbenv와 빌드 툴인 ruby-build를 brew를 통해 설치하도록 한다. 아까와 마찬가지로 .rbenv도 쉘 path에 등록해주고 쉘이 시작될때마다, rbenv가 init되도록 해준다.

설치가능한 버전들을 list해보고 원하는 버전을 설치한다. 설치후엔 **source ~./zprofile** 이 명령어를 한번 쳐주는 것도 좋다. 아까 환경변수 설정한것을 반영하도록 하는 명령어인데, 나의 경우엔 설치 후에 **rbenv global 2.4.1** 이 명령어가 먹히지않아서 **ruby -v** 했을 때 계속 옛날 루비 버전만 나왔었다. source 명령어 이후엔 잘 반영되었다. 어쩌면 터미널 껏다 켰음 그냥 됬을 수도 ㅋㅋ

rbenv rehash 이걸로 뭐였더라 무슨 변수 정리해주고, gem update를 해주면 &lt;span style=&quot;color:#003366&quot;&gt;ruby 설정완료.&lt;/span&gt;

이제 2.4.1 버전 루비로 블로그에 Gem도 설치하고 jekyll serve도 해야겠다.

[참고](https://stackoverflow.com/questions/14607193/installing-gem-or-updating-rubygems-fails-with-permissions-error)
*echo $PATH* 로 환경변수를 볼때, 환경변수에 등록된 순서가 *~/.rbenv/shims* 가 ruby보다 늦게 나오면, 에러가 날 수 있다고 한다. 즉, rbenv가 먼저 load되어야한다는 말, 그때는 bash에 *export PATH=$HOME/.rbenv/shims:$PATH* 를 가장 마지막 줄에 넣으면 된다고 한다. 아마도 가장 마지막 줄의 path가 가장 먼저 load되기 때문인듯하다.
</code></pre>
</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-372e6c6e4023966db8fd7c45f5b70b27">GO data type</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-07-22" class="text-muted">2017.07.22</time>
        
	</div>
	<h1 id="go의-데이터-타입">Go의 데이터 타입</h1>
<p>(Java 빨리 배워야되는데 내 udacity ㅠ..)</p>
<p>Data Types
데이터 타입은 변수에 어떤 값이 저장될 수 있는 지 저장하고, 제한한다. 해당 타입에 어떤 종류의 operation이 행해질 수 있는지 rule을 정하기도 한다.</p>
<p>Primitive Data Types
byte, int8, uint8, int16, uint16, float32 등 값(value)를 저장할 때 사용한다. C나 Java에서 short, long등을 사용하는 것과 달리 비트 수를 명확히 지정하므로 난 좀 더 직관적이라고 생각한다. 이 data type들에는 몇가지 규칙이 있는데, 일단 연산에서 서로 data type이 다르면 컴파일 에러가 발생한다. int(num2) 이런식으로 변환해주면 연산시 유용하다. 단, 실수형을 정수형으로 바꾸면 소수점을 버릴 수 있다.</p>
<p>중요한 점은 각 자료형마다 저장 가능한 단위이다.</p>
<p>uint8	부호 없는(unsigned) 8비트, 1바이트 정수	0 ~ 255
uint16	부호 없는 16비트, 2바이트 정수	0 ~ 65535
uint32	부호 없는 32비트, 4바이트 정수	0 ~ 4294967295(대략 10^9 * 4)
uint64	부호 없는 64비트, 8바이트 정수	0 ~ 18446744073709551615
int8	부호 있는(signed) 8비트, 1바이트 정수	-128 ~ 127
int16	부호 있는 16비트, 2바이트 정수	-32768 ~ 32767
int32	부호 있는 32비트, 4바이트 정수	-2147483648 ~ 2147483647
int64	부호 있는 64비트, 8바이트 정수	-9223372036854775808 ~ 9223372036854775807
byte	uint8과 크기가 동일, 바이트 단위로 저장할 때 사용</p>
<p><a href="http://pyrasis.com/book/GoForTheReallyImpatient/Unit08">출처</a></p>
<p>당연히 해당 자료형이 담을 수 있는 것보다 큰 값을 대입하면 안된다. 예를 들어 input값이 10^10정도라고 한다면, uint64/int64는 써줘야 해당 값을 담을 수 있겠지.</p>
<p>var num2 byte = 0x32
byte에는 보통 16진수, 문자 값으로 저장한다. 소켓통신을 통해 바이너리를 주고 받거나, 바이너리 파일에서 읽고 쓸때 자주 사용한다.</p>
<p>HackerRank에서 푼 예제를 첨부한다.
{% highlight go%}
package main</p>
<p>import (
&ldquo;fmt&rdquo;
&ldquo;os&rdquo;
&ldquo;bufio&rdquo;
&ldquo;strconv&rdquo;
)</p>
<p>func main() {
var i uint64 = 4
var d float64 = 4.0
var s string = &ldquo;HackerRank &quot;</p>
<pre><code>scanner := bufio.NewScanner(os.Stdin)
// file등 input byte 를 읽을 때 편리한 Scanner 객체이다
</code></pre>
<p>var sec uint64
var dob float64
var str string
value := make([]string, 3)
var count int = 0</p>
<p>//scanner는 기본적으로 input을 split함으로써 여러개의 token을 만들어낸다. split function은 설정할 수 있다. default는 \n 이다.
//scanner.Scan은 더 읽을 Token이 남았을 때 True를 반환한다. 다 읽으면 False를 반환한다
for scanner.Scan() {
value[count] = scanner.Text()
count++
}</p>
<p>sec, _ = strconv.ParseUint(value[0], 10, 64)
dob, _ = strconv.ParseFloat(value[1], 64)
str = value[2]
// Print the sum of both integer variables on a new line.
fmt.Printf(&quot;%d\n&rdquo;, i+sec)</p>
<p>// Print the sum of the double variables on a new line.
fmt.Printf(&quot;%.1f\n&quot;, d+dob)</p>
<p>// Concatenate and print the String variables on a new line
fmt.Printf(&quot;%v&quot;, s+str)
// The &rsquo;s' variable above should be printed first.
{% endhighlight%}</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-ba0eb4d1cf3790efa0e6401360ba865a">GO interface와 JSON</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-07-22" class="text-muted">2017.07.22</time>
        
	</div>
	<p>Go 함수들에서 interface{}를 parameter로 받는 일은 꽤 흔한 일이다. 가장 대표적인 예가</p>
<blockquote>
<p>func Println(a &hellip;interface{}) (n int, err error)</p>
</blockquote>
<p>이는 interface 여러개를 input으로 받고, 해당 interface의 타입에 맞게 출력을 해준다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#204a87;font-weight:bold">var</span> <span style="color:#000">a</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;hello&#34;</span>
<span style="color:#204a87;font-weight:bold">var</span> <span style="color:#000">c</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">5</span>

<span style="color:#000">fmt</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">a</span><span style="color:#000;font-weight:bold">)</span><span style="color:#8f5902;font-style:italic">//string 타입 a
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">fmt</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">c</span><span style="color:#000;font-weight:bold">)</span><span style="color:#8f5902;font-style:italic">//int 타입인 c
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000;font-weight:bold">{</span><span style="color:#ce5c00;font-weight:bold">%</span> <span style="color:#000">endhighlight</span><span style="color:#ce5c00;font-weight:bold">%</span><span style="color:#000;font-weight:bold">}</span>

<span style="color:#000;font-weight:bold">&gt;</span><span style="color:#a40000">$</span><span style="color:#204a87;font-weight:bold">go</span> <span style="color:#000">run</span> <span style="color:#000">practice</span><span style="color:#000;font-weight:bold">.</span><span style="color:#204a87;font-weight:bold">go</span>
<span style="color:#000">hello</span>
<span style="color:#0000cf;font-weight:bold">5</span>

<span style="color:#000">run</span> <span style="color:#000">하면</span> <span style="color:#000">위와</span> <span style="color:#000">같이</span> <span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">값을</span> <span style="color:#000">Println에</span> <span style="color:#000">넣었을</span> <span style="color:#000">때</span> <span style="color:#000">알아서</span> <span style="color:#000">적합한</span> <span style="color:#000">형태로</span> <span style="color:#000">출력해준다</span><span style="color:#000;font-weight:bold">.</span> <span style="color:#000">함수내에서</span> <span style="color:#204a87;font-weight:bold">interface</span><span style="color:#000;font-weight:bold">{}</span><span style="color:#000">파라미터로</span> <span style="color:#000">들어온</span> <span style="color:#000">값의</span> <span style="color:#000">타입과</span> <span style="color:#000">값을</span> <span style="color:#000">판단하여</span> <span style="color:#000">출력해주기</span> <span style="color:#000">때문</span><span style="color:#000;font-weight:bold">.</span> <span style="color:#000">interface에</span> <span style="color:#000">관한</span> <span style="color:#000">예제를</span> <span style="color:#000">몇</span> <span style="color:#000">개</span> <span style="color:#000">더</span> <span style="color:#000">해보자</span><span style="color:#000;font-weight:bold">.</span>
<span style="color:#4e9a06">``</span><span style="color:#a40000">`</span><span style="color:#204a87;font-weight:bold">go</span>
<span style="color:#204a87;font-weight:bold">package</span> <span style="color:#000">main</span>

<span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000;font-weight:bold">(</span>
	<span style="color:#4e9a06">&#34;fmt&#34;</span>
	<span style="color:#4e9a06">&#34;time&#34;</span>
<span style="color:#000;font-weight:bold">)</span>

<span style="color:#204a87;font-weight:bold">type</span> <span style="color:#000">MyError</span> <span style="color:#204a87;font-weight:bold">struct</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#000">When</span> <span style="color:#000">time</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Time</span>
	<span style="color:#000">What</span> <span style="color:#204a87;font-weight:bold">string</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>func (e *MyError) Error() string {
return fmt.Sprintf(&ldquo;at %v, %s&rdquo;,
e.When, e.What)
}</p>
<pre><code>func run() error {
	return &amp;MyError{
		time.Now(),
		&quot;it didn't work&quot;,
	}
}

func main() {
	if err := run(); err != nil {
		fmt.Println(err)
	}
}
{% endhighlight%}
위 예제는 error에 관한 건데, 일반적으로 go programming에서는 error를 리턴하는 경우가 흔하다.
fmt 패키지가 Println을 통해 err 객체를 출력할때, Error 인터페이스를 구현하고 있는 지 찾는다고 한다.

&gt; type error interface {
    Error() string
}

여기서도 마찬가지로 err 객체가 Error 인터페이스를 구현하고 있는지, Error 메소드를 가지는 지 찾아보면,
</code></pre><p>func (e *MyError) Error() string {}</p>
<pre><code>MyError 구조체는 이 메소드를 가진다.(composition) 따라서, 위 메소드가 호출된다.
```go
package main

import (
	&quot;fmt&quot;
)
type ErrNegativeSqrt float64

func (e ErrNegativeSqrt) Error() string{
	return fmt.Sprintf(&quot;cannot Sqrt negative number : %g&quot;, e)
}

func Sqrt(x float64) (float64, error) {
	if x &lt; 0{
	  return 0, ErrNegativeSqrt(x)
	}
	return 0, nil
}

func main() {
	fmt.Println(Sqrt(2))
	fmt.Println(Sqrt(-2))
}
{% endhighlight%}
Exercise 예제를 하나 더 보면, ErrNegativeSqrt 라는 이름의 타입을 하나 정의한다. 그럼, sqrt(-2)를 호출했을때, if문에 의해 ErrNegativeSqrt 타입의 객체를 반환하게 된다. fmt가 Println을 수행할 때, 위 객체의 Error 인터페이스를 찾고, Error 메소드를 구현하고 있으므로, 해당 메소드를 출력해주면 된다.

## Json Marshall and UnMarshall
참고) [json by example](https://gobyexample.com/json)

인터페이스를 공부하게 된 계기가 되어준게 JSON string으로의 인코딩이었다. Go data structure 타입의 객체를 Json으로 인코딩하여 API Response를 날려줘야하므로, standard library인 encoding/json을 이용해야했다.
json.Marshal(var interface{}) 함수는 interface{}형태의 파라미터를 받아 해당 변수의 type, value값을 판단하여 json 형태로 encode해준다.

json.Unmarshal은 당연히 그 반대과정인 decoding을 수행하는데, 예제에도 나와있듯 decode된 데이터를 담을 dat이라는 변수를 선언해준다. 이 변수는 string key에 interface{} value값을 가지는데, byt로 들어온 json string 값을 decode하여 dat의 자료구조에 적합하게 집어넣어준다. interface{}로 선언한 까닭에 여러가지 값이 value로 들어갈 수 있다.

```go
var dat map[string]interface{}
//Here’s the actual decoding, and a check for associated errors.
//go 에서는 이런식으로 error를 체크해주는것이 좋다.
    if err := json.Unmarshal(byt, &amp;dat); err != nil {
        panic(err)
    }
    fmt.Println(dat)
{% endhighlight%}

참고 예제에 나와있듯, decode된 객체의 값들을 사용하기 위해서 적합한 값으로 cast해줘야한다. (interface{}로 value를 받았으므로)     
```go
num, ok := dat[&quot;num&quot;].(float64)
if ok{
    fmt.Println(num)
}
{% endhighlight%}
nested data 구조에 접근하기 위해서는 연속적인 cast를 필요로 할 수 있다.

```go
  strs := dat[&quot;strs&quot;].([]interface{})
  str1 := strs[0].(string)
  fmt.Println(str1)
{% endhighlight%}
예상되는 타입으로 cast하고 해당값을 자유롭게 go 에서 사용할 수 있다.

참고) go tour
요약) ok 없이 interface의 type assertion을 수행하면, 실제로 변환이 불가능할땐 panic이 발생한다. ok가 있으면 interface가 해당 타입을 가지면, true 아니면 false가 되고 t는 해당 타입 T의 zero value가 되고 panic이 발생하지 않는다.
</code></pre>
</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-d55d4816074aba738c86229027a6f8b7">docker 이미지로 centos pull</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-07-18" class="text-muted">2017.07.18</time>
        
	</div>
	<h2 id="docker-사용하기">docker 사용하기</h2>
<p>도커는 굉장히 편하다. 일단 일반 vm처럼 네트워크설정을 할필요도 없고(host, 즉 그냥 내 컴퓨터의 resource들을 사용하므로) 가벼우므로, 완전한 가상머신을 제공하는 VMWARE나 VirtualBox보다 부담이 적다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">docker pull ubuntu:latest
<span style="color:#ce5c00;font-weight:bold">{</span>% endhighlight%<span style="color:#ce5c00;font-weight:bold">}</span>
docker pull &lt;이미지&gt;:&lt;태그&gt;로 간편하게 이미지를 받을 수 있다. 이를 pull이라고한다. 도커는 docker hub라는, image repository가 있기 때문에 docker hub에서 전세계 다양한 사용자들이 만든 이미지를 다운 받아 사용할 수 있다. centOs, Ubuntu, fedora등 대부분의 linux 운영체제는 공식 이미지를 사용하기 때문에 docker hub를 통하지 않고 위와 같이 다운로드할 수 있다.

터미널에서 *docker search ~* 명령어를 이용하면 이미지를 찾아볼 수도 있다. ex<span style="color:#ce5c00;font-weight:bold">)</span> docker search golang으로 검색하면 go 와 관련된 도커 이미지들이 나오고 star도 나오므로 유명한 이미지가 우선적으로 나온다

<span style="color:#4e9a06">```</span>bash
docker run -i -t <span style="color:#ce5c00;font-weight:bold">[</span>container_name<span style="color:#ce5c00;font-weight:bold">]</span> /bin/bash
//새롭게 컨테이너 만들 때는 아래와 같이 /bin/bash를 실행하도록 지정한다
docker <span style="color:#204a87">exec</span> -i -t <span style="color:#ce5c00;font-weight:bold">[</span>container_name<span style="color:#ce5c00;font-weight:bold">]</span> bash
//컨테이너에 직접접속
<span style="color:#ce5c00;font-weight:bold">{</span>% endhighlight%<span style="color:#ce5c00;font-weight:bold">}</span>

아까 설치한 이미지를 컨테이너로 생성한후, 배시셸을 실행하는 명령어이다.
--name은 해도되고 안해도 되는 option으로 이름을 지정하고 싶다면 해당 옵션을 주면된다. 안주게되면 manual하게 도커가 이름을 준다. <span style="color:#ce5c00;font-weight:bold">(</span>나름 다양하다<span style="color:#ce5c00;font-weight:bold">)</span>
-it 옵션을 통해 bash 셸에 입출력이 가능하게 된다.
<span style="color:#4e9a06">```</span>bash
docker ps
<span style="color:#ce5c00;font-weight:bold">{</span>% endhighlight%<span style="color:#ce5c00;font-weight:bold">}</span>
로 현재 실행되고 있는 컨테이너를 출력할 수 있다. container ID를 얻을수있다. <span style="color:#ce5c00;font-weight:bold">(</span>-a 옵션을 추가하면 실행되고 있지는 않지만 존재하는 container까지 출력할 수 있다<span style="color:#ce5c00;font-weight:bold">)</span> docker stop, restart 등으로 컨테이너를 중지, 재시작 할 수 있다.

중단한 container라고 하더라도, start로 다시 살려서 attach로 다시 접속할 수 있다.

<span style="color:#4e9a06">```</span>bash
docker login
docker commit -m <span style="color:#4e9a06">&#34;added golang&#34;</span> -a <span style="color:#4e9a06">&#34;centos with golang latest&#34;</span> affectionate_hugle nayoonhwang/centos_with_go
docker push nayoonhwang/centos_with_go

//docker hub에 올라가있는 centos_with_go 이미지를 다운받아 사용할 수 있다
docker pull nayoonhwang/centos_with_go
<span style="color:#ce5c00;font-weight:bold">{</span>% endhighlight%<span style="color:#ce5c00;font-weight:bold">}</span>
터미널로 내 docker계정에 로그인하여, 현재 작업하고 있던 컨테이너<span style="color:#ce5c00;font-weight:bold">(</span>affectionate_hugle<span style="color:#ce5c00;font-weight:bold">)</span>를 docker repository로 push할 수 있다. 나의 경우에는 go lang을 설치해놓은 centos를 원격저장소에 올려놓았다.
내가 참조한 링크: <span style="color:#ce5c00;font-weight:bold">[</span>How to create image and push it to docker hub<span style="color:#ce5c00;font-weight:bold">](</span>http://www.techrepublic.com/article/how-to-create-a-docker-image-and-push-it-to-docker-hub/<span style="color:#ce5c00;font-weight:bold">)</span>
</code></pre></div>
</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-dc9f3b49aeecbdfd1f7e8912b65be7c5">git rebase</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-07-18" class="text-muted">2017.07.18</time>
        
	</div>
	<h1 id="git">Git</h1>
<ul>
<li>git rebase -i HEAD~n
ex) git rebase -i HEAD~4
rebase는 이루어진 커밋들에 drop, squash, edit등의 수정작업을 하기 위함이다. 예시로 든 명령은 Head가 가르키고 있는 커밋부터 4개까지 rebase 하겠다는 것인데.</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">  pick 1df44db python dashinsert
  pick 3409e57 <span style="color:#0000cf;font-weight:bold">20170630</span> friking week
  pick 2dcbf08 .gitignore update
  pick 126181c .
  <span style="color:#8f5902;font-style:italic"># Rebase f406725..126181c onto f406725 (4 commands)</span>
  <span style="color:#8f5902;font-style:italic">#</span>
  <span style="color:#8f5902;font-style:italic"># Commands:</span>
  <span style="color:#8f5902;font-style:italic"># p, pick = use commit</span>
  <span style="color:#8f5902;font-style:italic"># r, reword = use commit, but edit the commit message</span>
  <span style="color:#8f5902;font-style:italic"># e, edit = use commit, but stop for amending</span>
  <span style="color:#8f5902;font-style:italic"># s, squash = use commit, but meld into previous commit</span>
  <span style="color:#8f5902;font-style:italic"># f, fixup = like &#34;squash&#34;, but discard this commit&#39;s log message</span>
  <span style="color:#8f5902;font-style:italic"># x, exec = run command (the rest of the line) using shell</span>
  <span style="color:#8f5902;font-style:italic"># d, drop = remove commit</span>
  <span style="color:#8f5902;font-style:italic">#</span>
  <span style="color:#8f5902;font-style:italic"># These lines can be re-ordered; they are executed from top to bottom.</span>
  <span style="color:#8f5902;font-style:italic">#</span>
  <span style="color:#8f5902;font-style:italic"># If you remove a line here THAT COMMIT WILL BE LOST.</span>
  <span style="color:#8f5902;font-style:italic">#</span>
  <span style="color:#8f5902;font-style:italic"># However, if you remove everything, the rebase will be aborted.</span>
  <span style="color:#8f5902;font-style:italic">#</span>
  <span style="color:#8f5902;font-style:italic"># Note that empty commits are commented out</span>
<span style="color:#ce5c00;font-weight:bold">{</span>% endhighlight%<span style="color:#ce5c00;font-weight:bold">}</span>

이런식으로 나타난다. 이때 pick이라고 되어있는 commit에 command를 입력해주면, 즉,

<span style="color:#4e9a06">```</span>bash
pick 3409e57 <span style="color:#0000cf;font-weight:bold">20170630</span> friking week
pick 2dcbf08 .gitignore update
s 126181c .
pick c1c9582 ..
<span style="color:#ce5c00;font-weight:bold">{</span>% endhighlight%<span style="color:#ce5c00;font-weight:bold">}</span>
이렇게 해주면 .이라고 커밋메세지가 써있는 commit은 squash되어 이전의 커밋과 합쳐진다.

<span style="color:#4e9a06">```</span>bash
pick 1df44db python dashinsert
pick 3409e57 <span style="color:#0000cf;font-weight:bold">20170630</span> friking week
pick <span style="color:#0000cf;font-weight:bold">9308320</span> .gitignore update
reword 47fc658 gitrebase experiment
<span style="color:#ce5c00;font-weight:bold">{</span>% endhighlight%<span style="color:#ce5c00;font-weight:bold">}</span>
또는 이렇게 커밋메세지를 변경해줄수도 있다

* git rm --cached .idea/vcs.xml

<span style="color:#4e9a06">```</span>bash
git rm --cached _posts/2017-06-30-friking-week.md
git commit -m <span style="color:#4e9a06">&#34;remove an article&#34;</span>
git push
<span style="color:#ce5c00;font-weight:bold">{</span>% endhighlight%<span style="color:#ce5c00;font-weight:bold">}</span>

git에서 추적<span style="color:#ce5c00;font-weight:bold">(</span>stage<span style="color:#ce5c00;font-weight:bold">)</span>하지 않고, ignore할 수 있는 방법에는 .gitignore에 입력해주는 방법도 있지만, git rm을 이용하는 방법도 있다. 이때 --cached 옵션을 이용하면 실제로 파일을 삭제하지 않고, stage만 피하게 해줄 수 있다. git rm만 해주면 실제로 파일이 삭제되므로 주의해야한다.
예를 들어, 이 블로그에서도 좀 개인적인 부끄러운 일들을 담은 markdown들을 unstage하고 싶을 때 저 방법을 써주면 된다. 이미 remote repo에 올라갔지만 commit 하고 push해주면 변경사항이 remote에도 반영된다.
</code></pre></div>
</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-6e72bba52b1d459134d136eff7741175">studying IOT</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-06-20" class="text-muted">2017.06.20</time>
        
	</div>
	<p>#Internet
<em>internetworking 기술: 여러가지 네트워크를 연결하여 하나의 기준을 둠으로서, 다양한 하드웨어 기술이 결할될 수 있도록 만드는 기술</em></p>
<h2 id="tcpip-네트워크-모델">TCP/IP 네트워크 모델</h2>
<p><strong>특징</strong></p>
<ul>
<li>특정 하드웨어나 운영체제에 독립적인 개방형 프로토콜</li>
<li>물리적 네트웨크에 독립적.</li>
<li>전세계에 유일한 주소체계를 사용한다.</li>
<li>표준화되어있으며 널리 사용된다.
<strong>동작과정</strong></li>
<li>TCP는 사용자의 데이터를 TCP 패킷으로 나눈다.</li>
<li>IP는 TCP 패킷에 목적지 주소에 대한 정보를 추가한다.</li>
<li>TCP는 각각 도착한 IP패킷을 모아 호스트 컴퓨터가 사용할 수 있는 데이터로 변환, 변환시 오류 검출, 오류 발생시 재전송을 요청한다.</li>
</ul>
<p>서비스 제공을 위한 연결
HTTP : 데이터(메세지)
TCP : 세그멘트(TCP헤더 + 데이터)
IP : 패킷(IP헤더 + 세그멘트)
이더넷 : 프레임(패킷 + 이더넷 헤더)
네트워크 인터페이스: 비트스트림</p>
<p><em>하드웨어를 통한 연결</em>
<strong>인터넷은 LAN(Local Area Network)를 기반으로 구성한다.</strong></p>
<ul>
<li>물리계층과 데이터계층이 하드웨어에 따라 다르다.</li>
<li>이더넷 - IEEE802.3</li>
<li>와이파이 - IEEE802.11
<strong>이더넷이나 와이파이로 연결된 기기들은 48비트의 MAC 주소로 구분한다</strong></li>
</ul>
<p><strong>IP 주소</strong>
v4는 32비트에 인데 반해 v6는 128비트이다.
지역별로 할당되어 데이터 전달 경로를 결정하기에 적합하도록 만들어진 소프트웨어적 주소.
ARP 프로토콜을 통해 MAC주소와 IP주소를 매핑한다.</p>
<p>IP: 패킷으로 만들어진 데이터를 목적지까지 전달하는 과정을 담당한다.
TCP: 데이터가 목적지까지 &lsquo;정확하게&rsquo; 전달될 수 있도록 책임진다.</p>
<ul>
<li>두 기기사이의 데이터 흐름을 관리</li>
<li>수신된 데이터에 대해서 acknowledgement를 통해 데이터가 수신되었음을 알려준다.</li>
</ul>
<p><em>UDP vs TCP</em>
UDP는 비연결형, 단순한 전송 프로토콜로서, 신뢰성이 없고 ack가 없는 best-effort 전송 방식이다. 재전송은 수행하지 않고, 데이터 흐름 관리 기능이 없다. 대신 부하가 매우 낮고, 전송 속도가 매우 빠르다. 데이터의 완전성보다 전달 속도가 중요하고, 소량의 데이터를 송신하고, 멀티캐스트/브로드캐스를 사용하는 어플리케이션에 사용된다.데이터의 일부가 손실되는 것이 중요하지 않은 어플리케이션(비디오, 멀티미디어 스트리밍)에 쓰인다.</p>
<p>TCP는 전송 전 연결을 먼저 맺어야 하는 연결형이며, 어플리케이션이 네트워크 계층 문제를 걱정하지 않고 데이터를 안정적으로 송신할 수 있도록 하는 풍부한 기능의 프로토콜이다. 메세지 전송을 신뢰할 수 있고, 모든 데이터에 대한 ack이 존재하여 손실된 데이터는 자동으로 재전송한다. 윈도우 크기를 적절히 조정하며 슬라이딩 윈도우를 이용한 흐름제어를 하고, 혼잡 회피 알고리즘을 사용하여 데이터 흐름 관리를 한다. 부하, 전송속도 모두 우수하지만, udp보다는 낮다. 소형부터 초대형 데이터까지 송신가능하며, 신뢰할 수 있는 방법으로 데이터를 송신해야하는 대부분의 프로토콜과 어플리케이션. 대부분의 파일/메세지 전송 프로토콜을 포함한다. TCP/IP 어플리케이션을 위한 전송 계층 프로토콜. HTTP, FTP, SMTP등에 사용한다.</p>
<blockquote>
<p>TCP는 데이터 전송시 데이터를 세그멘트로 분할하여 <strong>순서대로</strong> 전송한다. 단, ack를 받지 못한 세그멘트에 대해서는 재전송한다. 목적지의 host는 sequence number에 따라 데이터를 재구성한다.</p>
</blockquote>
<p><em>인터넷 연결을 위한 설정</em></p>
<p>고정 ip
유동 ip</p>
<ul>
<li>DHCP(Dynamic Host Configuration Protocol)
사설 ip</li>
<li>공식적으로 IP 주소 사용에 대한 허가를 받지 않고 임의로 사용</li>
<li>192.168.xxx.xxx 가 많이 사용된다.
서브넷 마스크</li>
<li>하나의 ip 네트워크 주소를 다시 여러 ip 서브 네트워크로 분할하는 기능을 수행.
브로드캐스트 주소</li>
<li>ip와 subnetmask를 and 연산하여 얻어진 네트워크 주소에서 subnetmask의 0으로된 비트를 모두 1로 바꾸어주면 구할 수 있다.  -&gt; 네트워크: 165.132.120.0 서브넷: 255.255.252.0 일때 브캐: 165.132.123.255이다.
게이트웨이</li>
<li>인터넷과 직접 연결되어 있는 주소
DNS</li>
<li>호스트 네임을 ip 주소로 변환한다. 윈도우에서 ping, nslookup, tracert를 이용하면 ip 확인이 가능하다.
<em>네트워크를 효율적으로 나누기 위해 서브넷을 이용하는 것이 유용하나, 다수의 ip 주소가 낭비된다 (네트워크 id, 브로드캐스트 주소등)</em></li>
</ul>
<p><strong>이더넷</strong>
이더넷 쉴드</p>
<ul>
<li>근거리 네트워크(Local Area Network, LAN)을 구성하는 방식에 관한 표준</li>
<li>1983년 IEEE 802.3으로 표준화</li>
<li>유선 연결을 통한 네트워크의 90% 이상을 차지</li>
</ul>
<p>이더넷 라이브러리</p>
<ul>
<li>ipaddress 클래스, ethernetclass 클래스, Ethernetclient 클래스, Ethernetserver 클래스 등으로 구성.</li>
<li>ipaddress 클래스 : ip주소를 지정하기 위한 클래스</li>
</ul>
<ul>
<li>ipv4를 지원.</li>
</ul>
<ul>
<li>ethernetclass 클래스 : 아두이노가 이더넷을 통해 데이터를 주고 받을 수 있도록 이더넷 쉴드를 설정하는 역할. 이더넷 라이브러리와 네트워크 설정을 초기화, ip주소를 동적으로 할당받을 수 있도록 dhcp 지원. but, dhcp 사용시, 스케치 크기 증가.</li>
</ul>
<ul>
<li>int begin(u8int_t mac_address)
<em>int maintain()함수는 dhcp를 통해 할당된 ip주소를 갱신할 때 사용한다. 0-4까지 반환값에 따라, renew(동일 dhcp서버에서 ip 갱신) rebind(새로운 dhcp 서버로부터 주소 할당) 성공 여부를 나타낸다.</em></li>
</ul>
<ul>
<li>Ethernetserver 클래스: 다른 컴퓨터나 기기에서 실행 중인 클라이언트의 요청을 받아들이고 클라이언트와의 통신을 관리하기 위한 클래스.</li>
</ul>
<ul>
<li>Ethernetserver(uint16_t port) : 지정한 포트로 들어오는 클라이언트의 요청을 감시하는 서버 객체를 생성.</li>
<li>void begin(void): 서버를 시작하여 서버 생성시에 지정한 포트로 들어오는 클라이언트 요청을 감시한다. 클라이언트의 요청이 들어오면 클라이언트와 통신하기 위한 소켓을 생성하여 클라이언트와 연결. 이더넷은 최대 4개의 소켓을 동시에 사용.</li>
<li>Ethernetclient available(void) : 서버에 접속된 클라이언트 중 서버에서 읽어 들일 수 있는 데이터를 보낸 클라이언트 객체를 반환. 클라이언트의 접속 요청이 있을 때, 클라리언트의 접속을 허용하는 절차를 Ethernet 라이브러리가 자동으로 처리하여 연결이 이루어지면, 서버는 클라이언트 별로 연결을 관리한다.</li>
<li>size_t write(const uint8_t *buf, size_t size) : 서버에 접속된 모든 클라이언트로 데이터 전송, 개별 클라이언트로 전송된 바이트 수를 합한 값이 반환됨.</li>
<li>print : serial 클래스의 print와 동일.</li>
</ul>
<ul>
<li>Ethernetclient 클래스</li>
</ul>
<ul>
<li>Ethernetclient() : 이더넷 클라이언트 객체를 생성하는 생성자로 생성된 클라이언트는 connect 함수를 통한 지정한 ip주소와 포트를 가진 서버로 접속한다.</li>
<li>int connect : 지정된 서버의 주소와 포트를 통해 서버로 접속을 시도한다. 성공시 true 실패시 false를 반환한다. 서버의 주소값은 문자열일 수도 있고 IPAddress객체의 형식일수도 있다.</li>
<li>int read : 수신버퍼의 바이트 데이터를 읽는다</li>
<li>void flush : 서버로부터 전송되어 아직 읽지 않은 데이터를 읽어서 수신버퍼를 비운다.</li>
<li>void stop : 접속 종료</li>
</ul>
<h1 id="iot를-위한-프로토콜">Iot를 위한 프로토콜</h1>
<p><strong>HTTP : Hypertext transfer protocol</strong></p>
<ul>
<li>Request/Response 프로토콜 (client가 서버에 정보 요청. 서버가 응답)</li>
<li>Request : Method, resource, headers, Content</li>
<li>Response : statusCode, Headers, Content</li>
</ul>
<ul>
<li>Method</li>
</ul>
<ul>
<li>Get, Put/Delete, Post등</li>
</ul>
<ul>
<li>HTTP protocol stack</li>
</ul>
<p><em>HTTP/HTTPS(URLs)</em></p>
<p><em>TCP(port# default: 80/443)</em></p>
<p><em>Internet Protocol(IP, ip주소들)</em></p>
<p><em>Local Area Network(LAN, mac 주소들)</em></p>
<p><em>Physical(Cables, Radio, etc)</em></p>
<p><em>SSL/TLS로 암호화하면 https</em></p>
<p><strong>CoAP : Constrained Application Protocol</strong></p>
<ul>
<li>메모리, 에너지, 성능 등에 제약이 있는 M2M 환경을 위한 웹 기반 프로토콜.</li>
<li>UDP 기반의 Request/Response 모델로 동작.</li>
<li>UDP와 CoAP 계층 사이에 DTLS가 사용될 수 있음.</li>
<li>binary header가 더 간결하고, option의 수가 감소, method도 4가지만 존재.</li>
</ul>
<p>HTTP의 tcp 대신 udp(port 5683)이 들어간다는게 차이점.</p>
<p><strong>MQTT : Message Queue Telemetry Transport protocol</strong></p>
<ul>
<li>Publisher, Subscriber, Message broker, Topics</li>
<li>Http와 다르게, TCP 포트가 1883/8883(보안 무/유)으로 지정되어있다.</li>
<li>3 QoS</li>
</ul>
<h1 id="wifi">Wifi</h1>
<p><strong>와이파이는 이더넷과 더불어 인터넷에 물리적으로 연결되기 위 한 방법을 제공</strong></p>
<ul>
<li>실제 데이터 교환과 서비스 제공은 상위 계층에서 이루어짐</li>
<li>물리적인 연결의 차이점을 제외하면 이더넷과 거의 동일한 방법으로 와이파이 사용이 가능</li>
</ul>
<p><strong>CSMA/CA</strong></p>
<p>A가 B로 패킷을 보내고 싶을 때, B에게 먼저 RTS를 보낸다. B가 RTS를 받으면, A에게 CTS를 보냄으로써 응답한다. C가 CTS를 overhear하면, keeps quiet for a while.</p>
<p>A가 B에서 RTS보내면 A주변의 노드들이 NAV(무선통신에서 사용하는 virtual carrier sensing mechanism)를 통해 keep quiet하게 된다. B에서 A로 CTS 보낼 떄 B 주변의 노드들 또한 NAV를 통해 keep quiet하게 된다.</p>
<p><strong>Wifi 라이브러리</strong></p>
<ul>
<li>Wifi, Wificlient, WifiServer 클래스 정의.</li>
<li>이더넷과 차이는 네트워크 연결을 위해 AP와의 연결이 필요(AP의 SSID와 패스워드가 필요할것입니다).</li>
</ul>
<p><em>Wifi 클래스 (전체적인 와이파이 연결시작, 신호세기, 맥주소 할당등 연결을 위해 필요한 설정을 담당한다)</em></p>
<ul>
<li>begin 함수는 연결하고자 하는 와이파이의 ssid, password를 파라미터로 전달합니다. config함수와 달리 dhcp를 통해 유동 ip를 자동으로 할당받는다. config함수는 정적 ip 주소를 사용하기 때문에 파라미터에 IPAddress 객체를 전달해야한다.</li>
</ul>
<p><em>Wifi Server 클래스</em></p>
<ul>
<li>이더넷과 흡사하게 available함수는 서버에 접속된 WifiClient 객체를 반환한다.
<em>Wifi Client 클래스</em></li>
<li>이더넷과 마찬가지로, connect 함수를 사용하여 지정된 ip주소와 포트를 통해 서버에 접속한다.</li>
</ul>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-d7bf54a8c223467cb7158fe8459620a9">MYSQL</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-06-06" class="text-muted">2017.06.06</time>
        
	</div>
	<h2 id="인생이-고난의-연속이듯이-개발도-삽질의-연속인걸까">인생이 고난의 연속이듯이 개발도 삽질의 연속인걸까.</h2>
<h2 id="mysql-설치">mysql 설치</h2>
<h2 id="닥치고-homebrew">닥치고 Homebrew</h2>
<p>삽질의 원인</p>
<blockquote>
<p>sudo lsof -i -n -P | grep TCP</p>
</blockquote>
<blockquote>
<p>mysql -u root -p</p>
</blockquote>
<p>로 my sql 접속을 시도했을때,</p>
<p>자꾸 mysql Authentication 에러가 떴었다.
설치되어있던 <em>/usr/local/var/mysql</em> 의 nayoon.err의 로그를 보니, 자꾸 3306에 이미 mysqld가 돌고 있다는것.</p>
<p>이걸 강제로 죽일라고 pid 알아내기 위해 netstat이란 명령어를 찾았으나, 맥 터미널용은 아닌듯했다.</p>
<p>결국 스택오버플로우에서 <em>lsof</em> 라는 명령어를 찾아서 pid찾아내고 kill했다.</p>
<p><a href="https://stackoverflow.com/questions/4421633/who-is-listening-on-a-given-tcp-port-on-mac-os-x">내 컴퓨터에서 돌고있는 tcp 프로세스 알아내기</a></p>
<p>kill 하고</p>
<blockquote>
<p>mysql.server start</p>
</blockquote>
<p>하니 너무 잘되네?^^ㅠㅠㅠㅠㅠㅠㅠㅠㅠ</p>
<blockquote>
<p>mysql_secure_installation</p>
</blockquote>
<p>명령어로 비밀번호 설정하고 무사히 mysql 설치완료.</p>
<p>마지막으로 유저 권한 설정을 위해,</p>
<p><a href="http://link2me.tistory.com/431">mysql 유저 권한 설정.</a></p>
<p>유저 권한을 설정해야 외부에서도 접속 가능하기 때문. 난 일단 testdb 데이터베이스의 NAYOON 사용자의 localhost와 외부 ip를 허용해놓았다.</p>
<p>오늘도 삽질~ ^ㅇ^ &gt;ㅇ&lt;</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-8082d529709b459f9b4164d5be63fbde">퇴사.</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-06-01" class="text-muted">2017.06.01</time>
        
	</div>
	<p>5.31 최종적으로 바리엘을 퇴사했다. 3, 4, 5월 3개월동안 인턴 생활을 했고, Asp.net core 프레임워크를 다루며 c#으로 서버를 다뤄보는 경험을 할 수 있었다. Http Request Response 경험도 적었던 초짜라 결제모듈 API 사용이나, Facebook Login Api 사용등에서 많은 어려움을 겪었지만, 지금 다 끝내고 보니 정말 귀중하고 소중한 경험이었다고 생각한다.</p>
<h1 id="aspnet-core--azure-로-개발하면-서버-설정이-필요없다">Asp.Net Core + Azure 로 개발하면, 서버 설정이 필요없다.</h1>
<p>asp.net core 의 가장 큰 장점은 이것이라고 생각한다.(물론 c#에 익숙하지 않은 초짜의 입장이다)</p>
<p>서버 설정이 필요없다는 것은 Deploy 시에 클라우드의 가상 머신에 Nginx나 Passenger를 설치하여 배포 환경을 구축하지 않아도 된다는 의미이다. 닷넷 코어의 경우에는 IIS라는 마이크로소프트 자체 서버를 이용하는데, 당연히 Azure 에서는 해당 서버를 미리 다 구축해놓았다(마이크로 소프트 제품이니깐..). 덕분에 자신의 비쥬얼스튜디오 닷컴(나의 경우엔 nayoonhwang.visualstudio.com)에 프로젝트를 업로드 후 Publish만 누르면 된다. 비쥬얼스튜디오에서 작업 했을 시 작업하고 있는 프로젝트를 azure에 publish 하는 기능또한 제공하고 있다. 위와 같이 배포가 굉장히 간편하기 때문에 귀찮고 고된 서버 설정을 거치지 않아도 된다는 큰 장점을 가지고 있다. rails로 작업시에 했던 그 귀찮은 작업들을 안해도 된다니&hellip; 신세계였다.</p>
<h1 id="facebook-api-사용">Facebook API 사용</h1>
<p>기존에 Asp.net Core 하면서, Identity라는 모듈(?)을 사용했었다. Identity의 정의를 일단 찾아보면,</p>
<blockquote>
<p>ASP.NET Core Identity is a membership system which allows you to add login functionality to your application. Users can create an account and login with a user name and password or they can use an external login providers such as Facebook, Google, Microsoft Account, Twitter and more.2
You can configure ASP.NET Core Identity to use a SQL Server database to store user names, passwords, and profile data. Alternatively, you can use your own persistent store to store data in another persistent storage, such as Azure Table Storage.</p>
</blockquote>
<p>라고 되어있다. 간단히 번역해보면, asp.net core identity는 당신의 application에 로그인 기능을 추가할 수 있게 하는 멤버쉽 시스템이다. 유저들은 기존의 로그인 방식으로 회원가입하고 로그인 할 수 도 있고, Facebook, Google, Twitter등 외부 로그인 provider들을 이용하여 로그인할 수도 있다. Identity를 Sql Server DB를 이용해 유저 이름, 비밀번호, 프로필 데이터를 저장하도록 설정할 수 있고, Azure Table Storage와 같은 다른 지속성있는 저장소에 저장할 수도 있다.</p>
<p>이 Identity 시스템을 적용하여 로그인을 구현했었다. Rails에서는 Devise Gem와 같은 역할인듯하다. 참고로 Rails에서 Gem으로 Package를 설치하는 것과 같이 Asp.net Core에서는 Nuget으로 패키지를 설치할 수 있다. Identity 패키지 설치 후 자유롭게 Identity Method들을 사용할 수 있다. 대표적으로 SignInAsync()이런 메소드들을 쓸 수 있다.</p>
<p>이야기가 삼천포로 빠졌지만, 아무튼 이렇게 로그인/회원가입 기능을 구현해놓았는데, 여기다 페이스북 로그인 기능을 넣게 되었다.</p>
<p>페이스북 로그인이라고 하면, 해당 사이트에 회원가입을 하지 않고 Facebook 회원정보만으로 이 사이트를 이용할 수 있는 것이다. 물론, 당연히 페이스북에서 인증 절차를 수행하고, 통과한 유저 정보를 받아온후 우리 Application DB에 해당 회원의 정보를 저장해야한다. 3rd party external login을 처음 이용할 시에는, <strong>기존 유저 회원가입과는 다르게</strong> 유저를 생성하고, 생성한 유저의 ID를 이용하여 유저의 로그인 정보를 AspNetUsersLogin에 테이블에 저장하게 되는데, 이 테이블 같은 경우엔, IdentityDbContext를 사용하면 자동으로 추가되는 테이블 중 하나다. 이 테이블에 Provider 정보, 여기서는 Facebook이므로 Facebook의 정보를 저장하고(이 정보는 Facebook에서 인증 절차가 완료되었을 때 App에 제공하는 id등이 포함되고 이는 providerkey 칼럼에 저장하게 된다) 추후 로그인 시에는 저장된 정보를 참조하여 authenticate 후 signin 처리를 하는 방식이다.</p>
<p>여기서 궁금했던 점은,</p>
<h2 id="logic-적으로써-oauth-20의-동작-방식">Logic 적으로써 OAUTH 2.0의 동작 방식</h2>
<p><em>아래 그림은 몇 없는 한국어 그림</em>
<img src="https://drive.google.com/uc?id=0B01HgT0PZhPsYUFzTHpTX0RvSlk" alt="Oauth2"></p>
<h2 id="3rd-party-로그인-사용시-해당-회원-정보-저장-문제">3rd party 로그인 사용시, 해당 회원 정보 저장 문제.</h2>
<p>였다.</p>
<p>위의 궁금점은 추후 다시 정리하도록 하고,
아래 궁금점같은 경우에는,</p>
<p><strong>일단 우리 어플리케이션의 경우에는 User를 비밀번호(또는 PasswordHash) 없이 생성하고, 생성한 User 정보를 AspNetUsersLogin에 로그인 정보를 저장할 때 활용하는 것으로 처리했다</strong></p>
<p>그런데 다른 어플리케이션들의 경우, 예를 들어 LinkedIn은 Facebook으로 로그인을 수행하더라도 내 페이스북 프로필의 이름과 메일주소가 회원가입 칸에 표시되고 새로 회원가입을 해야되는 형태였다. (도대체 이럴거면 왜 페이스북으로 로그인을 하는거죠?)</p>
<p>하지만 내가 생각한 External 3rd Party Login은 해당 사이트또는 App에 회원가입을 하고 싶지 않고, 기존 3rd Party의 아이디 비밀번호를 통해 로그인할 수 있어야 한다고 생각했다.</p>
<p>이런 방식은 해당 Application에 처음 로그인 하는 사람들을 우리 application에서 처럼 임의로 Create할 건지, <strong>또는 일정 정보를 받은 후 Create</strong>
할 건지에 따라 달라지는 것으로 보인다. LinkedIn에서 한 번 위 방식으로 회원가입을 수행하면, 로그인 시에 계속 페이스북 로그인 기능을 사용할 수 있는 걸로 보아, 해당 방식으로 User를 생성하고 저장 후, UserLogin테이블에 저장하여 로그인을 처리하는 듯하다.</p>
<p><img src="https://nayoonhwang.file.core.windows.net/image/agile.png" alt="agile"></p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-d48a1525918ac36ff3175242a6ae0cc2">아이디어들.</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-05-22" class="text-muted">2017.05.22</time>
        
	</div>
	<h1 id="아이디어-정리">아이디어 정리</h1>
<ol>
<li>
<p>따릉이 내비게이션
따릉이를 타고 갈 수 있는 길을 내비게이션 형태로 제공한다. 물론 경우의 수는 극히 제한적.
내 근처 따릉이 거치대 위치를 알 수 있다.</p>
</li>
<li>
<p>중소 커피샵을 위한 커피 주문 앱.
스타벅스 앱 같은 것들을 중소 커피샵들을 위해 공통적으로 사용할 수 있는 앱. 플랫폼 형태가 될 수 있다. 결제 모듈은 간편결제 API 이용. (NPay, PAYCO)</p>
</li>
<li>
<p>공간대여 어플리케이션
주간/야간 대여. 주간에는 비는 공간. 야간에는 비는 공간
ex) 학원.</p>
</li>
<li>
<p>반려동물(강아지, 고양이) 친구찾기 App, Pet Date</p>
</li>
</ol>
<p>Mentor Review.
&ndash;&gt; 개인적으로 반려동물 시장은 앞으로도 무궁무진하게 성장할 것으로 봅니다. 아이디어 접근이 좋은것 같아요.</p>
<p>첨언을 드리면,
요즘 반려동물 산업에 전문가들이 각광받고 있습니다.
반려견 헤어 디자이너, 교배전문가, 전문훈련소, 유치원, 장묘업체, TV체널 등&hellip;
시장은 16년도에 2조, 2020년에 6조원을 예상한다고 합니다.</p>
<p>이런 프리미엄 서비스와 연계하는것도 고민해보세요. 사람들을 모아 플랫폼을 만들고, 그곳에 커머스를 올려서 돈을 벌어야 하니까요!</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-ca0f8b2e976da4240b59500ac05bd5ff">디버깅 ㅠㅠ</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-05-21" class="text-muted">2017.05.21</time>
        
	</div>
	<h1 id="debugs">Debugs</h1>
<ol>
<li>500 error 해결
서버오류인 500 error, 즉 API 호출은 정상적으로 이루어졌다는 뜻이다.
여러가지로 찾아보다가, 디버깅 결과 어이없게도</li>
</ol>
<p>{% highlight csharp %}
if (payment == null || checkout == null)
{
throw new Exception(&ldquo;Invalid Operation. Null Parameters&rdquo;);
}</p>
<pre><code>
여기서 500 error가 발생하는 것을 깨달았다.(디버깅의 실생활화가 절실합니다.)
그리고 정말 어이없게도 정말 서버단의 문제였다.(api 회사 죄송합니다..)

&gt;*_database.Checkouts.SingleOrDefaultAsync(c =&gt; c.imp_uid == imp_uid)*
요 줄이 문제였는데, 서버단에서 생성한 모델인 checkout에 아임포트 아이디가 있을리가 만무, 따라서 호출 결과 null이 호출되고 위 에러가 발생한 것이다.  
그래서, *_database.Checkouts.SingleOrDefaultAsync(c =&gt; c.merchant_uid == payment.TransactionId)* 위와 같이 고쳐줬다.

2. Parameter가 잘 안들어가는 문제.

js로 location.href를 통해 /checkout/ShowResult/{merchant_uid_value}를 날려주었더니,
디버깅 결과. Controller 상에서 merchant_uid를 받지 못하고 null로 표시되는 것을 확인할 수 있었다.
이를 해결하기 위해 *[Route(&quot;Checkout/ShowResult/{merchant_uid}&quot;)]* 를 추가해주었더니 파라미터로 잘 들어간다.

{% highlight csharp %}
[HttpGet]
[Route(&quot;Checkout/ShowResult/{merchant_uid}&quot;)]
public async Task&lt;IActionResult&gt; ShowResult(string merchant_uid){
    return View(await *_checkoutservice.ShowResultAsync(merchant_uid)*);
}

</code></pre><ol start="3">
<li>highlight 태그가 자꾸 안닫혔다고 하는 지킬 블로그.
<a href="http://blog.slaks.net/2013-08-09/jekyll-tag-was-never-closed/">Tags are not closed</a></li>
</ol>
<p>excerpt_separator 때문이라고 하는데, 이 에러에 대해 잘은 모르겠다. 이게 맞아야 valid한 tag라나 뭐라나, 그래서
config.yml에</p>
<blockquote>
<p>excerpt_separator: &quot;&quot;</p>
</blockquote>
<p>를 추가해주면 해결된다. 이를 추가하면 excerpt_separator가 조기에 종료되어 추가 검사를 하지 않는 효과를 본다고 한다.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-58c8bbf2e8cd69081b7d1e461f3d76fe">Class c#</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-05-18" class="text-muted">2017.05.18</time>
        
	</div>
	<p>씨샵은 복잡한 데이터를 표현하기 위해 클래스(CLASS)를 쓴다. 클래스는 객체(인스턴스)를 생성할 수 있는 템플릿이다.</p>
<p>클래스는 여러 필드를 가질 수 있고 이 필드는 일반 정수형(int, decimal)이나 bool 형등 여러가지 형태를 가질 수 있다.
<a href="http://guslabview.tistory.com/164">C# 객체지향 기초</a></p>
<p><a href="https://www.exceptionnotfound.net/getting-started-with-dependency-injection-in-asp-net-core/">Dependency Injection</a></p>
<p><a href="http://www.egocube.pe.kr/Translation/Content/asp-net-core-mvc-tutorial-1/201607010001">번역</a></p>
<p><a href="http://soyoja.com/413">c#과 c++ 비교</a></p>
<blockquote>
<p>이 글을 읽으며 느꼈던 점은 확실히 c#은 객.체.지.향.언어라는 점에서 공감했다. 포인터 사용이 거의 없고, 일반 클래스 생성도 모두 new 를 이용해서 heap 영역에 저장하는 점.</p>
</blockquote>
<p><a href="http://itguru.tistory.com/135">씹어먹는 c++</a></p>
<p>c++과 c#를 많이 배워보고 싶다.</p>
<p><a href="http://kin.naver.com/qna/detail.nhn?d1id=1&amp;dirId=1040101&amp;docId=68942853">c, c++, c#, visual c++</a></p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-cb39469ee72b87cc3bf3a91251ee382f">Datagrip으로 원격 Azure sql server와 연결하기</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-05-17" class="text-muted">2017.05.17</time>
        
	</div>
	<p>Datagrip은 MSsql server 뿐만 아니라, mysql, sqlite 등 여러 DBMS들과 연결할 수 있는 툴이다.</p>
<p>Jetbrain사에서 개발한 위 툴은, 학생라이센스로 무료로 사용할 수 있다.(유후~)</p>
<p>MsSql을 로컬에 설치할수 없었고(맥 OS이기 때문에), 클라우드로 Azure 에 있는 내 sql server에 접근해서 다루는 툴 같은경우에는 불편한 점이 많았기 때문에, 다른 dbms를 모두 사용할 수 있는 Datagrip을 설치하였다.</p>
<p>Datagrip을 설치 한 후,</p>
<p>new database -&gt; sql server -&gt; microsoft
로 진행하던중</p>
<p>host, database, connectionstring을 제대로 입력했음에도 불구하고, 계속 connect test가 실패하는 문제가 발생했다.
도데체 왜!! 라고 울부 짖던 중
나와 같은 Broken pipe 문제를 겪던 jetbrain 블로그 질문 글</p>
<p><a href="https://youtrack.jetbrains.com/issue/JRE-221">Broken Pipe</a></p>
<p>을 발견했다. 그리고,,,</p>
<blockquote>
</blockquote>
<p>Good news - thanks to the detailed log files created with Vasily Chernov&rsquo;s logging config file, I was able to locate the source of this nagging issue:
If the hostname of the connecting client is not set or ends with .local, the connection will fail
To fix it, follow these steps:
open terminal (/Applications/Utilities/Terminal)
run scutil &ndash;get HostName (case sensitive!)
if hostname is not set or contains .local, run sudo scutil &ndash;set HostName &ldquo;newname&rdquo;
try JDBC Azure SQL Connection again - hostname change is effective immediately
Thanks Denis Fokin &amp; Vasily Chernov for your help, this has been bugging me for quite some time</p>
<p>위와 같은 댓글을 발견하고,</p>
<p><img src="https://nayoonhwang.file.core.windows.net/image/terminal.png" alt="터미널 스크린샷">
그것을 따라 이렇게 해보았다.</p>
<p>그랬더니,,,!</p>
<p>똭!</p>
<p><img src="https://nayoonhwang.file.core.windows.net/image/terminal2.png" alt="성공"></p>
<p>이렇게 잘 되었다..헤헤</p>
<p>이 문제의 원인은!</p>
<blockquote>
</blockquote>
<p>If the hostname of the connecting client is not set or ends with .local, the connection will fail</p>
<p>연결 클라이언트 호스트 이름이 지정되어있지 않거나 ~.local 로 되어있으면 연결이 실패할 것이라고 한다.
그래서 위와 같은 명령어를 입력하여 hostname을 지정해주도록한다.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-e148dc34f6034a3bca9307c3f23b8395">identity 모듈을 aspnetcore에 적용하기.!</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-05-15" class="text-muted">2017.05.15</time>
        
	</div>
	<p>aspnet core application에</p>
<p>회원정보 관리를 모두 담당할 수 있는(=귀찮고 어려운 세션관리등을 모두 담당해줄 수 있는) identity 모듈을 탑재해보자.</p>
<p>일단 공식 다큐멘테이션.
<a href="https://docs.microsoft.com/ko-kr/aspnet/core/migration/identity">identity를 aspnetcore에 적용하는 documentation</a></p>
<p>요약해보자면.</p>
<ol>
<li>
<p>Package Console 에 Microsoft.AspNetCore.Identity.EntityFrameworkCore 패키지를 추가해준다.</p>
</li>
<li>
<p>기존에 회원관리를 위해 만들었던 모델. 나같은 경우엔 Account 였다. Account 에 IdentityUser를 상속해준다.
<em>IdentityUser에서 Id , UserName, Email등 필수 field들이 이미 선언되어있기 때문에 따로 Account에서 선언해줄 필요는 없다.</em></p>
</li>
<li>
<p>startup.cs에 위와 같이 등록해준다.
{% highlight csharp %}
//add identity module
services.AddIdentity&lt;Account, IdentityRole&gt;()
.AddEntityFrameworkStores<DatabaseContext>()
.AddDefaultTokenProviders();</p>
</li>
</ol>
<p>services.Configure<IdentityOptions>(options =&gt;
{
options.Password.RequiredLength = 8;
options.Password.RequireNonAlphanumeric = false;
options.Password.RequireUppercase = false;
var scheme = options.Cookies.ApplicationCookieAuthenticationScheme;
});</p>
<pre><code>물론 아래 configure는 option이기 때문에 원하는 대로 지정할 수 있다. 그리고 Account같은 경우에는 회원관리 모델을 의미하므로 적절히 사용하도록 하자.

마지막으로 configure 함수에
{% highlight csharp %}
app.UseIdentity();
</code></pre><p>를 추가해준다.
4. DatabaseContext도 dbcontext를 상속하는 것이 아닌,</p>
<p>{% highlight csharp %}
public class DatabaseContext : IdentityDbContext<Account></p>
<pre><code>위와 같이 IdentityDbContext&lt;Account&gt;를 상속해주도록 하자.

위와 같이 되면 일단
{% highlight csharp %}
public DbSet&lt;Account&gt; Accounts { get; set; }
</code></pre><p>와 같은 건 필요없다. 해당 IdentityDbContext에서 <em>Users<Account> AspNetUsers 라고 따로 테이블이 형성되기 때문.</em></p>
<p>이제 설정은 끝났고, Identity Module의 기능을 이용하기만 하면 된다.</p>
<p>{% highlight csharp %}
private readonly UserManager<Account> _userManager;</p>
<p>private readonly SignInManager<Account> _signInManager;</p>
<p>public AuthController(UserManager<Account> userManager, SignInManager<Account> signInManager)
{
_userManager = userManager;
_signInManager = signInManager;
}</p>
<p>// GET: /Auth/Register
[HttpGet]
[AllowAnonymous]
public IActionResult Join(string returnUrl = null)
{
ViewData[&ldquo;ReturnUrl&rdquo;] = returnUrl;
return View();
}</p>
<p>[HttpPost]
[AllowAnonymous]
[ValidateAntiForgeryToken]
public async Task<IActionResult> Join(JoinViewModel model){
if (ModelState.IsValid)
{
var user = new Account { UserName = model.Email, Name= &ldquo;연습중&rdquo; , Email = model.Email, Phone= &ldquo;010-010-010&rdquo;};
var result = await _userManager.CreateAsync(user, model.Password);
if (result.Succeeded)
{
await _signInManager.SignInAsync(user, isPersistent: false);
return RedirectToAction(nameof(HomeController.Index), &ldquo;Home&rdquo;);
}
AddErrors(result);
}
// If we got this far, something failed, redisplay form
return View(model);</p>
<p>}</p>
<pre><code>// GET: /Auth/Login
</code></pre>
<p>[HttpGet]
[AllowAnonymous]
public IActionResult Login(string returnUrl = null)
{
ViewData[&ldquo;ReturnUrl&rdquo;] = returnUrl;
return View();
}</p>
<pre><code>[HttpPost]
[AllowAnonymous]
[ValidateAntiForgeryToken]
public async Task&lt;IActionResult&gt; Login(LoginViewModel model, string returnUrl = null){
    ViewData[&quot;ReturnUrl&quot;] = returnUrl;
    if(ModelState.IsValid){
        var result = await _signInManager.PasswordSignInAsync(model.Email, model.Password, true, lockoutOnFailure: false);
        if(result.Succeeded)
        {
            return RedirectToLocal(returnUrl);   
        }
        else
        {
            ModelState.AddModelError(string.Empty, &quot;invalid attempt&quot;);
            return View(model);
        }
    }
    return View(model);
}
</code></pre>
<p>[HttpPost]
[ValidateAntiForgeryToken]
public async Task<IActionResult> LogOut()
{
await _signInManager.SignOutAsync();</p>
<pre><code>return RedirectToAction(nameof(HomeController.Index), &quot;Home&quot;);
</code></pre>
<p>}</p>
<p>#region Helpers</p>
<p>private void AddErrors(IdentityResult result)
{
foreach (var error in result.Errors)
{
ModelState.AddModelError(string.Empty, error.Description);
}
}</p>
<pre><code>private Task&lt;Account&gt; GetCurrentUserAsync()
</code></pre>
<p>{
return _userManager.GetUserAsync(HttpContext.User);
}</p>
<p>private IActionResult RedirectToLocal(string returnUrl)
{
if (Url.IsLocalUrl(returnUrl))
{
return Redirect(returnUrl);
}
else
{
return RedirectToAction(nameof(HomeController.Index), &ldquo;Home&rdquo;);
}
}</p>
<p>#endregion</p>
<p>{% endhighlight%}</p>
<p>예제코드를 참고해본 회원관리 컨트롤러이다.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-8f2d6350a3a9ad665596ba1e46d2581d">항상 까먹는 linux 초기설정.</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-05-15" class="text-muted">2017.05.15</time>
        
	</div>
	<p>이제는 익숙한 ubuntu 깔기.</p>
<p>usb에 ubuntu를 다운받고, Booting Disk로 만든다(흔히 Burn이라고 부른다. 한국말로는 굽는다고 한다)</p>
<blockquote>
<p>Booting Mode</p>
</blockquote>
<ol>
<li>UEFI</li>
<li>LEGACY
몇 가지 자료를 찾아보니. UEFI에 최적화된 디바이스의 경우 UEFI 부팅이 default 값으로 되어있다고 한다. 아까 UEFI 부팅으로는 되고 LEGACY USB Storage 부팅으로는 안되었던 것이 디바이스 + OS 에러인듯하나, 요즘에는 대부분 UEFI 부팅으로 한다고 하니, 참고해야겠다. UEFI가 조금 더 빠른 부팅방식이라고 한다.</li>
</ol>
<p>Ubuntu 14.04 버전 설치 완료 후. root로 로그인을 시도했으나, root 권한은 기존에 설정해둔 것이 없다면 password가 없는 상태이다.
따라서 password 를 설정해주어야 하는데, sudo 명령으로 설정할 수 있다.</p>
<p>'''
sudo passwd root
'''
적절한 password를 설정해주고 로그인 완료~! 알다싶이 passwd (USER)이면 해당 user의 비밀번호를 수정하는 것이다.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-76898074417e7a904c334c366beee62f">iamport!</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-05-14" class="text-muted">2017.05.14</time>
        
	</div>
	<blockquote>
<p>ㅎ.ㅎ 3시간 돌려내^^
'''
안녕하세요, 아임포트 기술지원팀입니다.
주말에 좋지 않은 소식으로 연락드려 죄송합니다.
오늘 아임포트 REST API서버에 문제가 있어 API호출 시 500 오류가 간헐적으로 떨어지는 증상이 있었습니다.
(참고로, 결제 서버 및 관리자 페이지 서버는 문제없습니다)
발생 기간 : 2017-05-13 19:04:00 ~ 2017-05-13 22:18:00 ( 약 3시간 14분 )
로드밸런서에 연결된 여러 대의 API서버 중 1대가 오류를 발생시킴으로 인해, 해당 서버로 upstream연결되는 API요청들에 대해 500오류가 응답된 상황입니다.
'''
ㅠㅠㅠㅠㅠㅠㅠㅠㅠㅠㅠㅠㅠ</p>
</blockquote>
<p>그지 같다!!</p>
<p>그래도 삽질끝에 결제 성공까진 어찌저찌 했으니 위안을 삼아야지&hellip;</p>
<p><a href="https://elanderson.net/2017/04/entity-framework-core-with-sqlite/">saved my life</a>
<a href="https://sqlitestudio.pl/index.rvt">sqlite studio</a></p>
<p>그리고, Cli tool을 visualstudio for Mac에서 사용하기 위해서는 csproj파일에 manual하게 아래 코드를 삽입해주어야한다는 사실을 약 2시간의 삽질 끝에 깨달았다.(github에 나같이 헤메고 있는애에게도 알려주었다 ㅋㅋ).쒯.ㅋ.ㅋ.쒯.ㅋ</p>
<p>'''
<ItemGroup>
<DotNetCliToolReference Include="Microsoft.EntityFrameworkCore.Tools.DotNet" Version="1.0.0" />
</ItemGroup>
'''</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-315c554954e88166af9fae635ac90028">getch, getchar, getche c 언어 입력에 대해서.</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-05-02" class="text-muted">2017.05.02</time>
        
	</div>
	<p>엠티 가는 날. 1학년 학생이 과제때문에 엠티에 못가고 있다하여 c언어 과제를 도와주었다.</p>
<p>우리의 미션은 주사위 게임 만들기. 교수님이 정한 규칙을 준수하는 주사위 게임을 만들어야했다.</p>
<p><a href="http://kcoder.tistory.com/entry/getchar-getch-getche%EC%9D%98-%EC%B0%A8%EC%9D%B4%EC%A0%90-%EC%98%88%EC%A0%9C%EC%86%8C%EC%8A%A4-%EA%B7%B8%EB%A6%BC">getch()를 써야되는 이유</a></p>
<p>getch(), getchar() 이것들 때문에 별짓 다했네</p>
<p>getch()랑 getche()는 버퍼를 사용하지 않기 때문에,</p>
<p>getchar()와 같이 엔터(&quot;\n&quot;)값이 들어올때 까지 기다리지 않는다.</p>
<p>예를 들어 k값을 입력하면 입력하자마자 getch()는 누르자마자 처리한다.</p>
<p>버퍼를 사용하는 경우, 입력을 하면 바로 들어가는 것이 아니라, 입력버퍼라는 곳에 담기게 된다.</p>
<p><a href="http://stackoverflow.com/questions/10720821/im-trying-to-understand-getchar-eof">getchar()를 써야되는 이유</a></p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-ad85f4390e131966941b5b394d0d93fb">DB 검색 문제</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-04-23" class="text-muted">2017.04.23</time>
        
	</div>
	<p>{% highlight c%}
public async Task<Artwork> SearchArtworkToAddArtworkAsync(Exhibition exhibition, SearchArtworkViewModel model)
{
if(database.Artworks.Any(a =&gt; a.Name == model.Artwork))
{
var artwork = await database.Artworks.SingleOrDefaultAsync(a =&gt; a.Name == model.Artwork);
exhibition.Artworks.Add(artwork);
await database.SaveChangesAsync();</p>
<pre><code>        return artwork;
}
else if (database.ArtistProfiles.Any(a =&gt; a.ArtistName == model.Artist))
{
        var artist = await database.ArtistProfiles.SingleOrDefaultAsync(a =&gt; a.ArtistName == model.Artist);
        var artwork = await artistprofileservice.AddArtworkAsync(artist, new AddArtworkViewModel{});
exhibition.Artworks.Add(artwork);
        await database.SaveChangesAsync();

        return artwork;
}
else
{
  //no artist, no artwork
  var artwork = await artistprofileservice.AddArtworkAsync(null, new AddArtworkViewModel {});
  exhibition.Artworks.Add(artwork);
  await database.SaveChangesAsync();

  return artwork;
}
</code></pre>
<p>}</p>
<p>public async Task<Artwork> SearchArtworkToAddArtworkAsync(Gallery gallery, SearchArtworkViewModel model)
{</p>
<pre><code>if (database.Artworks.Any(a =&gt; a.Name == model.Artwork))
{
  var artwork = await database.Artworks.SingleOrDefaultAsync(a =&gt; a.Name == model.Artwork);
          gallery.Artworks.Add(artwork);
  await database.SaveChangesAsync();

  return artwork;
}
else if (database.ArtistProfiles.Any(a =&gt; a.ArtistName == model.Artist))
{
  var artist = await database.ArtistProfiles.SingleOrDefaultAsync(a =&gt; a.ArtistName == model.Artist);
          var artwork = await artistprofileservice.AddArtworkAsync(artist, new AddArtworkViewModel {});
          gallery.Artworks.Add(artwork);
          await database.SaveChangesAsync();

  return artwork;
}
else
{
  //no artist, no artwork
          var artwork = await artistprofileservice.AddArtworkAsync(null, new AddArtworkViewModel {});
  gallery.Artworks.Add(artwork);
  await database.SaveChangesAsync();

  return artwork;
}
</code></pre>
<p>}</p>
<pre><code></code></pre>
</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-585cd2ad340c4abf05a63e140a420aa5">efcore로 관계형 데이터베이스 설계하기</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-04-23" class="text-muted">2017.04.23</time>
        
	</div>
	<h1 id="1-11-관계">1. 1:1 관계</h1>
<p><em>본 게시글은 <a href="https://docs.microsoft.com/en-us/ef/core/modeling/relationships">ef core documentation</a>을 참고하여 만들어졌음을 알려드립니다.</em></p>
<p>1:다 관계에서는 reference navigation을 가지는 개체가 종속(dependent)개체이고, collection으로(ICollection등) 가지고 있는 개체가 주(principal)개체임을 쉽게 알수있지만, 1:1관계의 경우 이를 쉽게 알 수 없기 때문에(두 모델 모두 서로의 id를 가진다.) foreign key를 설정할 때 종속 개체를 명시해주어야한다. 다음 예시를 보자.</p>
<p>{% highlight csharp %}
modelBuilder.Entity<Artwork>()
.HasOne(a=&gt; a.Auction)
.WithOne(b=&gt; b.Artwork)
.HasForeignKey<Auction>(c =&gt; c.ArtworkId)
.OnDelete(DeleteBehavior.Cascade);</p>
<pre><code>Artwork라는 개체를 만들었고 이 개체에 Auction이라는 테이블의 개체를 1:1 Matching시킨다. 이때 ForeignKey는 Auction의 ArtworkId로 한다. 즉 주(Principal)개체가 Artwork이고, 종속 개체가 Auction인 셈!

{% highlight csharp %}
</code></pre><p>{% highlight csharp %}</p>
<pre><code></code></pre>
</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-cf0942dff51f909398bc2c2b6d91a1a2">c&#43;&#43;로 피보나치 짜기</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-04-04" class="text-muted">2017.04.04</time>
        
	</div>
	<p>mission: c++로 피보나치 짜기.</p>
<p>c# 책으로 공부하다가, 피보나치 짜는 문제가 있어서 얼마 전 많이 말아먹은(^^) 현대차 인적성이 떠올랐다. 기본적인 스택/큐/피보나치도 까먹어서 결국 맛있게 말아먹은 시험! 유후!</p>
<p>아무튼, c#은 FiboNacci 클래스를 만들고 정적 변수와 메소드를 만들어서 Program 클래스의 Main 함수에서 부르는 방식으로 처리할 수 있었다. Memo를 위해 Dictionary 자료형을 이용하면 된다.</p>
<p>{% highlight csharp %}
//Rextester.Program.Main is the entry point for your code. Don&rsquo;t change it.
//Compiler version 4.0.30319.17929 for Microsoft (R) .NET Framework 4.5
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text.RegularExpressions;</p>
<p>namespace Rextester
{
public class FiboNacci
{
public static Dictionary&lt;int, long&gt;memo = new Dictionary&lt;int,long&gt;();
public static long fibo(int n){
if(n&lt;0) return 0;
if(n==1) return 1;
if(memo.ContainsKey(n))
return memo[n];
else{
long value = fibo(n-1) + fibo(n-2);
memo[n] = value;
return value;
}
}
}
public class Program
{
public static void Main(string[] args)
{
Console.WriteLine(&ldquo;FiboNacci&rdquo;);
Console.WriteLine(FiboNacci.fibo(120));
}
}
}</p>
<pre><code>
c#의 Dictionary 자료형이 어떤 자료형에 대응되는가 (c++에서) 를 찾아보다 보니 map 자료형을 찾을 수 있었다. 헤더에 추가해주고,
{% highlight cplusplus %}
#include&lt;iostream&gt;
#include&lt;cstdlib&gt;
#include&lt;map&gt;

using namespace std;
class Fibonacci
{
public:
  static map&lt;int, long&gt; fibomemo;
  static long fibo(int n);
};

//정적 멤버(static member) 변수는 클래스 외부에서 정의해주어야한다.
map&lt;int, long&gt; Fibonacci::fibomemo;

long Fibonacci::fibo(int n)
{
  if(n &lt; 0) return 0;
  if(n == 1) return 1;

  if(fibomemo.count(n) &gt; 0)
  {
    return fibomemo[n];
  }
  else
  {
    long value = fibo(n-1)+fibo(n-2);
    Fibonacci::fibomemo[n] = value;
    return value;
  }
}

int main()
{
    int num;
    cin &gt;&gt; num;
    cout &lt;&lt; Fibonacci::fibo(num);

    return 0;
}

</code></pre><p>혹시 차이점이 눈에 확들어오지 않는다면, class 부분이 짧아진걸 일단 볼 수 있다. 기본 로직은 정확히 동일하지만, c++의 경우 클래스에서 정적 멤버(변수/메소드)를 선언해주고, <strong>클래스 외부에서 정적 멤버를 정의해주어야한다.</strong></p>
<p>정적 멤버는 모든 객체가 공유하는 멤버다. 멤버 변수/멤버 함수들은 객체마다 하나씩 존재했었고, 객체는 저마다 자신의 멤버를 사용했다. 즉, 보통의 멤버들은 객체가 생성되면서 같이 생성되기 때문에 따로 정의해줄 필요가 없다. 그러나 정적 멤버 변수는 오직 하나만 생성되기 때문에 별도로 정의해주어야 한다.</p>
<p>하지만 정적 멤버 변수와 함수는 클래스에 오직 <em>하나만</em> 존재하기 때문에 모든 객체들은 하나의 정적멤버를 같이 사용하게 된다. 따라서 클래스 자체에 관련된 정보/전체 객체와 관련된 정보를 보관하고 다루는 데 유용하게 쓸 수 있다.</p>
<p><em>참고: 정적 멤버 함수에서는 클래스의 일반 멤버 변수에 접근 할 수 없다. 어떤 객체의 변수를 의미하는 지 알 수 없기 때문이다.</em></p>
<p>아무튼, 가장 큰 차이점은 클래스 외부에 정적 멤버 변수를 정의해주고 써야한다는 점이다. class 명세에서는 선언만 했지 정의해주진 않았기 때문이다. 즉, c#에서는 클래스에서 선언, 정의까지 해주는 데 반해, c++에서는 외부에서 정의해주어야 한다는 점이라고 할 수 있다.</p>
<p>이걸 몰라서 꽤 고생했다.</p>
<p>또 다른 차이점은, c#에서는 객체를 생성할 때,</p>
<blockquote>
<p>public static Dictionary&lt;int, long&gt;memo = new Dictionary&lt;int,long&gt;();
List<string> stringlist = new List<string>();</p>
</blockquote>
<p>이런식으로 new 키워드를 쓰지만, c++에서는</p>
<blockquote>
<p>map&lt;int, long&gt; Fibonacci::fibomemo;
vector<int> v;</p>
</blockquote>
<p>만으로 객체를 생성가능하다.</p>
<p>이제 학교 가야지.</p>
<p>생각해보니 c++에서의 new 키워드는 new-delete 세트로 동적할당에 사용된다. c언어의 malloc-free 기능이라고 생각하면 된다. (힙 영역 저장)</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-7bcfd1703c9ea31a0fefc867540c9906">c# getter setter 속성</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-04-03" class="text-muted">2017.04.03</time>
        
	</div>
	<dl>
<dt>Property(속성)을 정의 할때 쓰는 개념.</dt>
<dd>겟터 &amp; 셋터</dd>
<dd>Get &amp; Set</dd>
</dl>
<p>public 으로 변수를 선언해버리면 외부에서 마음대로 값을 설정해버릴수있고 잘못된값을 넣을 수 있는 가능성 존재.
&amp;
그렇다고 private으로 선언하면 외부에서 아예 값을 건드릴 수 없다. 값을 안전하게 변경하려면 대체 어떻게 해야 하는 것일까?</p>
<p>= Getter setter
{% highlight csharp %}
private int width;
public int Width
{
get {return width;}
set
{
if(value &gt; 0) {width = value;}
else {Console.WriteLine(&ldquo;너비는 자연수로&rdquo;);}
}
}</p>
<pre><code>
보통 일반적인 프레임워크에서 사용할 때는 이렇게 쓴다.

{% highlight csharp %}
public int Width { get; set; }
public int Height { get; set; }
</code></pre>
</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-80409f15ca7604af5ef0fbeb1fdca16f">vscode update 문제. coreCLR</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-03-31" class="text-muted">2017.03.31</time>
        
	</div>
	<p>&ldquo;Unable to attach to CoreCLR&rdquo;
라는 에러가 떴다.</p>
<p>난 vscode + asp.NETCore로 작업하고 있었기 때문에 관련 에러를 검색했더니</p>
<p>'''</p>
<p>Workaround posted on <a href="https://github.com/dotnet/coreclr/issues/10279">github</a> below. Confirmed works for me.</p>
<p>Here is a work around that worked for Gregg Miskelly:</p>
<p>Download <a href="https://dotnet.myget.org/F/dotnet-core/api/v2/package/runtime.osx.10.10-x64.Microsoft.NETCore.Runtime.CoreCLR/1.1.2-servicing-25123-01">https://dotnet.myget.org/F/dotnet-core/api/v2/package/runtime.osx.10.10-x64.Microsoft.NETCore.Runtime.CoreCLR/1.1.2-servicing-25123-01</a>
Open the resulting file as a zip, and copy out runtimes/osx.10.10-x64/native/libdbgshim.dylib
Open a terminal
cd ~/.vscode/extensions/ms-vscode.csharp-1.8.0/.debugger
cp .
As I said above, but just to repeat here, I expect to have a real fix out soon. But hopefully this will unblock folks in the mean time.</p>
<p>'''
를 찾았고 이를 적용해서 풀었다.</p>
<p>기존에 ~/.vscode/extensions/ms-vscode.csharp-1.8.0/.debugger에 존재했던 libdbgshim.dylib 파일은 삭제 또는 libdbgshim-old.dylib로 바꾸고</p>
<p>새로운 libdbgshim.dylib를 mv 명령어로 mv file1 file2 (file1을 file2로 이동)을 이용해 옮겼다.</p>
<p>OSX 나 Asp.netcore상의 업데이트 문제로 갑작스럽게 문제가 발생한 것같다.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-8d98d9ddbfdb0ffeb0cd82598f4a8532">python 가상환경에서 사용해보기.</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-03-27" class="text-muted">2017.03.27</time>
        
	</div>
	<p><a href="https://beomi.github.io/2017/03/27/Use-GoogleDrive-as-Image-Server/">캡처 자동 업로드하기</a>포스팅을 보다가 삘받아서 시작한 파이썬 가상환경 구축.</p>
<p><a href="http://www.marinamele.com/2014/07/install-python3-on-mac-os-x-and-use-virtualenv-and-virtualenvwrapper.html">가상환경에서 python3 사용해보기</a></p>
<p>python 2, 3</p>
<p>기존에는 /library/framework.python/~ 폴더에 파이썬이 들어가있었어서, (아마 그렇게 해야됬었던 설정이 있었겠지. bash_profile에 그렇게 저장하도록 지정되어있었다.)</p>
<p>virtualenvwrapper를 쓸수 없는 문제가 있었다.</p>
<p>결국 기존에 설치되어있던 python3.5를 지우고 Homebrew를 통해 python3를 다시 설치했다.</p>
<p>virtualenvwrapper를 사용하기 위해, pip(package 설치 관리자)를 이용하여</p>
<p>{% highlight csharp %}
$ pip install virtualenv
$ pip install virtualenvwrapper</p>
<pre><code>
로 두가지를 설치하니 의도했던 /usr/local/bin에 잘 깔렸다.

가상환경들을 담을 폴더를 만들고
{%highlight csharp %}
$ mkdir ~/.virtualenvs
</code></pre><p>.bashrc를 열어(없으면 만들고)
{%highlight csharp %}
export WORKON_HOME=~/.virtualenvs
source /usr/local/bin/virtualenvwrapper.sh</p>
<pre><code>를 추가해준다. /usr/local/bin/에 virtualenvwrapper.sh가 설치 되어있으므로 저런식으로 해준것.

{%highlight csharp %}
source .bashrc
</code></pre><p>를 통해 .bashrc를 활성화해준다.</p>
<p>{%highlight csharp %}
mkvirtualenv
//가상환경 만들기
deactivate
//빠져나오기
workon myenv
//다시 활성화하기</p>
<pre><code>이렇게 하게 되면 각 가상환경마다 다른 패키지를 사용할 수 있으므로 독립된 가상환경이 구축된것이다.
</code></pre>
</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-98e78a7c5acfbe4afb56454502efbdf2">c&#43;&#43;</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-03-23" class="text-muted">2017.03.23</time>
        
	</div>
	<p><a href="https://github.com/CppKorea/IntroductionToModernCpp">cpp 스터디자료</a></p>
<p>지금 조세푸스 푸는중.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-3450e818b3d4ed092d01031d4e3d2f48">Asp.net Core에서 로그인 기능 구현하기</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-03-22" class="text-muted">2017.03.22</time>
        
	</div>
	<h2 id="로그인-기능-구현하기">로그인 기능 구현하기</h2>
<p>본 튜토리얼은
<a href="http://www.binaryintellect.net/articles/b957238b-e2dd-4401-bfd7-f0b8d984786d.aspx">인도아자씨네튜토리얼</a><br/>
<a href="https://andrewlock.net/an-introduction-to-viewcomponents-a-login-status-view-component/">깔끔한아자씨네가 뷰컴포넌트 정리한거</a>
의 튜토리얼을 참고하였음을 알려드립니다.</p>
<ol>
<li>필요한 패키지 설치.</li>
</ol>
<p>{% highlight csharp %}</p>
<p><PackageReference Include="Microsoft.AspNetCore.Identity" Version="1.1.0" />
<PackageReference Include="Microsoft.AspNetCore.Identity.EntityFrameworkCore" Version="1.1.0"/>
<PackageReference Include="Microsoft.AspNetCore.Authentication.Cookies" Version="1.1.0"/></p>
<pre><code>
EntityFrameworkCore를 사용할 예정이므로 함께 연결할 데이터베이스 서버 패키지도 설치해 놓으면 된다.

{% highlight csharp %}
 &lt;PackageReference Include=&quot;Microsoft.EntityFrameworkCore.SqlServer&quot; Version=&quot;1.1.1&quot; /&gt;
</code></pre><p>이외에도 mysql, sqlite등을 연결 할 수 있다.</p>
<ol start="2">
<li>회원정보를 다룰 DbContext, User, Role 클래스를 생성한다.</li>
</ol>
<p>로컬 sql 서버에 회원 정보를 저장할 것이므로, 접근할 때 필요한 db context 를 생성해야한다. 또한 어떤 user type인지, role(역할)은 무엇인지도 저장해야하므로, 위 클래스들을 생성한다.</p>
<p>User은 각 회원의 정보를 저장하므로,</p>
<p>{% highlight csharp %}</p>
<p>public class Account : IdentityUser, IModel
{
public long Id { get;set; }
public string Name { get;set; }</p>
<pre><code>    public virtual ICollection&lt;Post&gt; Posts { get;set; }

    public DateTimeOffset CreatedAt { get; set; } = DateTimeOffset.Now;
    public DateTimeOffset UpdatedAt { get; set; }
}
</code></pre>
<pre><code>
이런식으로 저장할 수 있다. 튜토리얼에는 MyIdentityUser라고 되어있지만 자유롭게 설정가능하다. **주목할 점은, 이 클래스는 IdentityUser을 상속한다는 점이다.** (Microsoft.AspNetCore.Identity.EntityFrameworkCore namespace)

IdentityUser은 UserName, Password, Email 같은 기본 정보들을 저장한다. 따라서 Account에는 내가 따로 저장하고 싶은 프로퍼티를 저장하면 된다.

마찬가지로 AccountIdentityRole 모델도
{% highlight csharp %}
using Microsoft.AspNetCore.Identity.EntityFrameworkCore;

public class AccountIdentityRole : IdentityRole
{
    public string Description { get; set; }
}
</code></pre><p>와 같이 나타낼 수 있다. identityrole에는 RoleName과 같은 필드가 저장되므로, Description 추가를 원하면 위와 같이 추가해도 되고 아니면 그냥 안해도 RoleName은 쓸 수있다.
{% highlight csharp %}
public class MomLueContext : IdentityDbContext&lt;Account, AccountIdentityRole, string&gt; , IDatabaseContext
{
public DbSet<Account> Accounts { get; set; }
public DbSet<Post> Posts { get; set; }</p>
<pre><code>protected override void OnConfiguring(DbContextOptionsBuilder options)
{
    options.UseMySql(&quot;server=localhost;userid=root;password=;database=helloworld;&quot;);
}
</code></pre>
<pre><code>이렇게 MomLueContext 를 구성하여 회원정보, 역할을 파라미터로 가지는 IdentityDbContext를 상속, IDatabaseContext를 구현하도록 만든다.

IdentityDbContext가 이미 DbContext를 상속했을 것이므로, 굳이 DbContext를 또 상속하도록 해주지 않아도 된다.

4. Startup.cs에 설정하기.(configuration)

{%highlight csharp %}
services.AddIdentity&lt;Account, AccountIdentityRole&gt;()
        .AddEntityFrameworkStores&lt;MomLueContext&gt;()
        .AddDefaultTokenProviders();
{%endhighlight%}
를 정의했기에, Identity framework가 MomLueContext로 database context를 사용한다는 것을 알 수 있다. Account가 사용자를 담는 모델이름이고, 이는 MyIdentityUser이런식으로 정의할 수 있다.(Account는 예약어가 아니다.) 마찬가지로 AccountIdentityRole도 다른 이름의 모델로 사용할 수 있다.
[다른 context instance 쓰는 문제](http://www.jerriepelser.com/blog/resolve-dbcontext-as-interface-in-aspnet5-ioc-container/)

{%highlight csharp %}
services.AddDbContext&lt;MomLueContext&gt;();
//MomLueContext를 이 application의 dbcontext로 사용한다.
services.AddScoped&lt;IDatabaseContext&gt;(provider =&gt; provider.GetService&lt;MomLueContext&gt;());
{%endhighlight%}
IDatabaseContext는  
기존에 &lt;span style=&quot;color:#003366&quot;&gt;services.AddScoped&lt;IDatabaseContext, MomLueContext&gt;();&lt;/span&gt;로 되어 있었다.

[password 관련해서 configuration 하는법](https://docs.microsoft.com/en-us/aspnet/core/security/authentication/identity-configuration)

{%highlight csharp %}
  services.Configure&lt;IdentityOptions&gt;(options =&gt; {
      options.Password.RequireDigit = true;
      options.Password.RequiredLength = 8;
      options.Password.RequireNonAlphanumeric = false;
      options.Password.RequireUppercase= false;
  });
</code></pre><p>이렇게 안해주니 패스워드 조건 디폴트가 너무 까다로웠다. 위 조건으로 해결.</p>
<p>{%highlight csharp %}</p>
<p>{%endhighlight%}</p>
<ul>
<li>해결:: 태그 헬퍼 사용하기.</li>
</ul>
<p><strong>_ViewImports.cshtml</strong>
{%highlight csharp %}
@addTagHelper &ldquo;<em>, Microsoft.AspNetCore.Mvc.TagHelpers&rdquo;
@addTagHelper &ldquo;</em>, MomLue&rdquo;
{%endhighlight%}
로 했더니 안되던 태그 헬퍼가 작동한다. 헬퍼가 적용이 안되서 결국 html 헬퍼로 임시방편해두었었는데, 저렇게 하니 되는군. &ldquo;&ldquo;를 안붙혔어서 그랫나보다.
*<em>@addTagHelper <em>, Microsoft.AspNetCore.Mvc.TagHelpers</em></em>
이런식으로 냅뒀었다. 그래서 안되었었나보다.</p>
<p>{%highlight csharp %}
<label asp-for="Title" class="col-lg-3 col-sm-3 control-label">제목</label></p>
  <div class="col-lg-6" >
    <input asp-for="Title" class="form-control" />
  </div>
{%endhighlight%}
<p>장점은 asp-for 가 동작한다는것. @Html.TextBoxFor(x=&gt;x.Email, new { @class= &ldquo;form-control&rdquo;})
이런식으로 안써도 된다!!! 예헤이!!</p>
<p>{%highlight csharp %}
public class Repository<T> : IRepository<T> where T : class, IModel
{
public virtual DbSet<T> GetAll()
{
return Context.Set<T>();
}
{%endhighlight%}
IRepository를 상속하는 Repository 클래스에서 테이블을 통째로 가져오는 GetAll 메소드를 호출할떄</p>
<p>부모인 IRepository에서
{%highlight csharp %}
public interface IRepository<T> where T : class
{
{%endhighlight%}
T: class 안해주면
{%highlight csharp %}
public virtual DbSet<T> GetAll()
{
return Context.Set<T>();
}
{%endhighlight%}
가 안먹는다.</p>
<p>{%highlight csharp %}
public IActionResult Index()
{
List<Post> postList = PostRepository.GetAll().Include( post=&gt; post.Account )
.ToList();
{%endhighlight%}
암튼 저렇게 repository를 구성해주면 위 코드가 잘 먹는데, 해당 테이블 뿐만 아니라 참조하고 있는 다른 테이블 (여기서는 Account 테이블)을 함께 가져올 수 있도록 한다. <span style="color:#003366">lazy loading</span>이 지원되지 않기 때문에 Eager loading을 수행한것이다.
<a href="https://docs.microsoft.com/en-us/ef/core/querying/related-data">loading 관련 documentation</a></p>
<p>{%highlight csharp %}
[Authorize]
public IActionResult Create()
{
var postViewModel = new PostViewModel();
return View(postViewModel);
}
[HttpPostAttribute]
public async Task<IActionResult> Insert(PostViewModel postview)
{
var userAccount = UserManager.GetUserAsync(HttpContext.User).Result;</p>
<pre><code>var post = new Post {
    Account = userAccount,
    Title = postview.Title,
    Content = postview.Content,
    Tag = postview.Tag,
};

PostRepository.Insert(post);
await PostRepository.SaveChangesAsync();

return RedirectToAction(&quot;Index&quot;, &quot;Post&quot;);
</code></pre>
<p>}
{%endhighlight%}
create 액션은 인증된 사용자가 수행할 수 있도록 Authorize옵션을 주고,</p>
<p>실제 데이터베이스에 집어넣는 과정은 Insert 액션을 통해 수행한다. UserManager<Account> UserManager;을 통해 생성한 UserManager 객체로
HttpContext내에 존재하는 user 객체를 얻어 userAccount에 넣고 이를 이용해 Post 객체를 생성하여 미리 만들어준 PostRepository(포스트 저장소)에 insert 메소드를 이용해서 넣어준다. 그리고 이를 SaveChangesAsync를 이용해 repository에 저장한다.</p>
<p>{%highlight csharp %}
{%endhighlight%}</p>
<p>{%highlight csharp %}
{%endhighlight%}</p>
<p>{%highlight csharp %}
{%endhighlight%}</p>
<p>{%highlight csharp %}
{%endhighlight%}</p>
<p>{%highlight csharp %}
{%endhighlight%}</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-81a3a13a371e06839510ff4ed6f5b76c">Asp.net repository pattern</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-03-21" class="text-muted">2017.03.21</time>
        
	</div>
	<p><a href="http://www.c-sharpcorner.com/article/generic-repository-pattern-in-asp-net-core/">generic repository pattern으로 디자인 하기</a></p>
<p>위 링크를 아~주 많이 참고헀다. 굉장히 유익했던 튜토리얼.</p>
<p><strong>한글로 쉽게 설명해보겠다~!</strong></p>
<p>Repository 디자인 패턴을 고려한 컨트롤러는 다음과 같이 작성해볼 수 있겠다.</p>
<p>Post Model을 다루는 Post Controller</p>
<p>{%highlight csharp %}
public class PostController : Controller
{
private IRepository<Post> PostRepository;
public PostController(IRepository<Post> PostRepository)
{
this.PostRepository = PostRepository;
}
{%endhighlight%}</p>
<p>즉, startup.cs에 AddScoped 메소드를 통해 IRepository<Post>를 Repository<Post>로 구현한다고 명시해놓았기 때문에,(의존성 주입)
{%highlight csharp %}
services.AddScoped&lt;IRepository<Post>,Repository<Post>&gt;();
{%endhighlight%}</p>
<p>Post Controller내에 이런식으로
{%highlight csharp %}
private IRepository<Post> PostRepository;
{%endhighlight%}
IRepository 형식으로 PostRepository를 선언할 수 있다.</p>
<p>위와 같이 Interface형식으로 선언했지만 class처럼 사용할 수 있는것은 바로 아까 그 <em>의존성 주입</em> 때문이지.
<strong>아무튼, PostRepository는 post 모델의 crud를 맡아 해결하게 될것이다.</strong>
그럼 post 모델은 어떻게 되어있나 볼까?
{%highlight csharp %}
public class Post : IModel
{
public long Id { get;set; }
public string Title { get;set; }
public string Content { get;set; }</p>
<pre><code>    public string Tag { get; set; }
    public int AccountId { get;set; }
    public virtual Account Account{ get; set; }
</code></pre>
<p>{%endhighlight%}
이런식으로 되어있고, virtual Account Account 이부분을 보자. virtual은 &lsquo;가상&rsquo;이라는 키워드로, 이 클래스를 상속하는 클래스에서 재정의할 수 있도록 하기 위해 쓴다. 여기서는 EntityFrameworkCore에서 Account와 Post의 관계를 정의할때 재정의 함수를 쓸수 있게 virtual로 정의해놓았다. 여기서 중요한 점은 Post와 Account는 N:1 관계이다. 즉, Account 한개가 Post 여러개를 가질 수 있다. 이때 Account.cs에</p>
<p>{%highlight csharp %}
public class Account : IModel
{
public long Id { get;set; }
public string Name { get;set; }</p>
<pre><code>    **public virtual ICollection&lt;Post&gt; Posts { get;set; }**

    public DateTimeOffset CreatedAt { get; set; } = DateTimeOffset.Now;
    public DateTimeOffset UpdatedAt { get; set; }
}
</code></pre>
<p>{%endhighlight%}
이런식으로 virtual ICollection<Post> Posts 로 1:N 관계를 표현하는 것 뿐만 아니라, <strong>Post Model에서도 Mapping되는 Account 객체를 가질 수 있다는 점이다.</strong>
이 부분으로 인하여
{%highlight csharp %}
public IActionResult Index()
{
var postList = PostRepository.GetAll()
.Select(p =&gt; new PostViewModel{
Id = p.Id,
Name = p.Account.Name,
Tag = p.Tag
})
.ToList();</p>
<pre><code>return View(postList);
</code></pre>
<p>}
{%endhighlight%}
이것이 가능하게 되었다. 무슨소리냐 하면, 이는 IQueryable 객체를 반환한다. PostRepository.GetAll()이 쿼리 객체를 반환하고 Select를 통해 각각의 멤버 p로 각각에 대한 PostViewModel을 만든다. 그리고 IQueryable을 반환, 이를 ToList()를 통해 실제 객체로 변환해서 postList로 대입한다.</p>
<p>{%highlight csharp %}
{%endhighlight%}</p>
<p>{%highlight csharp %}
{%endhighlight%}</p>
<p>{%highlight csharp %}
{%endhighlight%}</p>
<p>{%highlight csharp %}
{%endhighlight%}</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-07f953adf20c6e53b2467f41303c3479">operating system 요약</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-03-20" class="text-muted">2017.03.20</time>
        
	</div>
	<p><a href="http://theuranus.tistory.com/2817">quicktime player 속도 빠르게 하는법</a></p>
<p>option 키를 누른채로 재생버튼 왼쪽 오른쪽의 버튼을 누르면 1.1, 1.2 또는 0.9 0.7의 속도로 재생할 수 있다. 개꿀팁!</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-936db5b3897490074fcab775a1ac5851">논문 아이디어</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-03-20" class="text-muted">2017.03.20</time>
        
	</div>
	<p>*드디어 키움 증권 계좌 개설~~*</p>
<p><img src="https://nayoonhwang.blob.core.windows.net/newcontainer/vm%20isolation.png" alt="가상화 cpu pinning 그림"></p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-f26e0cd84c6f0d539e85d0d4fc2fa34a">Asp.net study</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-03-13" class="text-muted">2017.03.13</time>
        
	</div>
	<p><a href="https://www.tutorialspoint.com/asp.net_core/index.htm">asp.net 튜토리얼</a>
이 외에도 <a href="www.codeschool.com">코드스쿨</a>, <a href="http://www.binaryintellect.net/articles/b957238b-e2dd-4401-bfd7-f0b8d984786d.aspx">인도아자씨 튜토리얼</a></p>
<h2 id="aspnet-core-파헤치기">ASP.NET CORE 파헤치기</h2>
<h1 id="i-객체-지향-언어">i) 객체 지향 언어.</h1>
<p>가장 중요한 건 c# 자체의 특성을 이해하는 것부터 시작한다.
java와 비슷하게 OOP 언어인 c#은 상속(부모-자식), 인터페이스, 개념을 정확하게 이해해야한다.</p>
<p><strong>Class(클래스)</strong>
-&gt; 객체(instance)화 =&gt; DRY(Don’t Repeat Yourself) : 효율성 증가.
-&gt; 클래스내에 method 존재 : 가독성 증가.</p>
<p>왜 인터페이스/상속을 사용해야하나?
-&gt; 대규모 웹 서비스에 모듈식으로 사용 가능
==&gt; 코드 구조의 체계성/ 코드 재사용성 증가.</p>
<p>인터페이스의 특징 -&gt; field가 없고 property 존재. method 존재. =&gt; interface의 property와 method는 반드시 구현(implement)해야하므로 제약(constraint)을 줄 수 있다.</p>
<p><a href="https://teamtreehouse.com/library/c-basics/prepare-and-plan/introduction">팀트리 하우스 강의</a>
배워봅시다.</p>
<h1 id="ii-web-application-configuration-설정">ii) Web Application Configuration 설정</h1>
<p><strong>Program + Startup.cs</strong></p>
<p>asp.net은 program의 main 메소드에서 수행된다.</p>
<p>그리고 import 해야하는 package들 같은 경우,</p>
<p>닷넷 코어 1.1 부터는 csproj에서 의존성 패키지를 정의한다고 한다. 프로젝트 자체는 최대한 가볍게 하기 위해 패키지를 일단 명세 해놓고 실행할 때 로컬 컴퓨터에서 패키지를 설치하는 방법으로 가기 위함이다.</p>
<p>“
new 명령을 통해 기본적인 파일은 생성 되었지만, 이 프로젝트가 의존해야 하는 여러 어셈블리가 없는 상태입니다</p>
<p>현재 프로젝트에 대한 의존성 패키지 정의는 test.csproj에 들어있습니다.
이 전 RC에서는 project.json에 정의되어있었으나 버전업하면서 다시 xml기반의 .csproj로 퇴화 변경되었습니다. 이러한 이유로 시중에 출간된 책과 많은 번역 글에는 project.json 기반의 설명이 많습니다 ^^;
“</p>
<p>후..project.json 기반의 설명이 많아 힘들었다. 하지만 그게 기준이 아니었다는거..!</p>
<p>“
현재 프로젝트 설정에 맞게 필요한 어셈블리를 다운로드 하려면 다음의 명령을 사용합니다.</p>
<p>dotnet restore</p>
<p>필요한 어셈블리를 내려받았으므로 이제 실행할 수 있습니다. 곧장 run을 이용해 실행해보죠.</p>
<p>dotnet run
“
<a href="http://www.bsidesoft.com/?p=3915#%25ea%25b0%259c%25ec%259a%2594">링크 1</a></p>
<p>본 블로그에 상세히 설명되어있다. 그것도 한글로!</p>
<p>이제는 <a href="https://docs.microsoft.com/en-us/aspnet/core/data/ef-mvc/intro">마소공식엔티티링크</a>를 따라할 수 있겠다.</p>
<p>EntityFrameworkCore는 ASP.NET core에 붙힐 수 있는 데이터베이스 관리 프레임워크이다. ORM의 역할을 한다고 생각할 수 있다.
migration을 통해 정의해 놓은 모델로 부터 데이터베이스를 만들 수 있다. (기본 field들부터 각 테이블간의 관계까지.)</p>
<p>내가 사용했던 Rails의 경우 ActiveRecord가 그 일을 했었다.</p>
<p>그리고 팁은 Itemgroup에서 PackageReference랑 DotNetCliToolReference는 따로 itemgroup을 이루도록.</p>
<p><img src="https://nayoonhwang.blob.core.windows.net/newcontainer/pac1.png" alt="pac1"></p>
<p><img src="https://nayoonhwang.blob.core.windows.net/newcontainer/pac2.png" alt="pac2"></p>
<p>이런식으로…!</p>
<p>그리고 dot net cli tool reference 는 command line에 따로 명령어를 입력한다.</p>
<p>이렇게
<img src="https://nayoonhwang.blob.core.windows.net/newcontainer/3.png" alt="사진3"></p>
<p>깔끔히 에러해결..! 후 Microsoft. 옆에 드디어 entity framework가 뜬다.
<img src="https://nayoonhwang.blob.core.windows.net/newcontainer/1.png" alt="그림1"></p>
<p><img src="https://nayoonhwang.blob.core.windows.net/newcontainer/2.png" alt="그림2"></p>
<p>기존의 문제.</p>
<p>이것은 내가 c# framework에 대한 이해가 부족했기 때문인듯하다.</p>
<p>{%highlight csharp %}
startup.cs
// This method gets called by the runtime. Use this method to add services to the container.
public void ConfigureServices(IServiceCollection services)
{
// Add framework services.
services.AddMvc();
// services.AddDbContext<MomLueContext>(options =&gt; options.UseMySql(Configuration.GetConnectionString(&ldquo;DefaultConnection&rdquo;)));
services.AddScoped&lt;IStorage, AzureBlobStorage&gt;();
services.AddScoped&lt;IDatabaseContext, MomLueContext&gt;();
services.Add(new ServiceDescriptor(typeof(IConfiguration), Configuration));
services.AddScoped&lt;IRepository<Post>,Repository<Post>&gt;();
services.AddScoped&lt;IRepository<Account>,Repository<Account>&gt;();
services.AddEntityFrameworkMySql();
}
{%endhighlight%}</p>
<p>startup.cs에서 인터페이스와 클래스를 AddTransient(or AddScoped)로 종속성 주입을 해준다는 개념을 충분히 이해하지 못했기 때문에 발생했던 문제</p>
<p><strong>최대한 변동가능한 코딩(Loosely Coupled, 느슨하게 묶여진 -&gt; 언제든지 바꿔낄 수 있는 것을 말하는 것같다.)</strong></p>
<p>을 위해 다수의 Interface를 두어 Class를 그때 그때 변경 할 수 있도록 startup에서 둘을 묶어준 것이다.</p>
<p>즉 ISettingsProvider를 구현한 구현체는 SettingsProvider이고, ISettingsProvider를 통해</p>
<p>{%highlight csharp %}
services.AddScoped&lt;IStorage, AzureBlobStorage&gt;();
services.AddScoped&lt;IDatabaseContext, MomLueContext&gt;();
{%endhighlight%}</p>
<p>즉, startup.cs에 내가 IStorage Interface 는 AzureBlobStorage로 구현할 거다라는 걸 명시해줘야한다는 것이다. 내가 만약</p>
<p>Azure을 AWS s3로 바꾼다면 IStorage와 AWSS3()로 묶어줄 수 있겠지.</p>
<p>알다시피 컴파일러는 Program의 메인함수를 수행할 것이고 메인함수는 startup.cs를 참조하기 때문에 startup.cs에 이런 사항들을 명시해줘야한다.
이는 의존성 주입(Dependency Injection)의 예시라고 할 수 있다.</p>
<p>이렇게 asp.net 에서는 startup에서 등록(register)하고 사용하는 경우가 많다.</p>
<p>'''
Register the context with dependency injection
ASP.NET Core implements dependency injection by default. Services (such as the EF database context) are registered with dependency injection during application startup. Components that require these services (such as MVC controllers) are provided these services via constructor parameters. You&rsquo;ll see the controller constructor code that gets a context instance later in this tutorial.</p>
<p>To register SchoolContext as a service, open Startup.cs, and add the highlighted lines to the ConfigureServices method.</p>
<p>Copy
C#
public void ConfigureServices(IServiceCollection services)
{
// Add framework services.
services.AddDbContext<SchoolContext>(options =&gt;
options.UseSqlServer(Configuration.GetConnectionString(&ldquo;DefaultConnection&rdquo;)));</p>
<pre><code>  services.AddMvc();
</code></pre>
<p>}
'''</p>
<p><em>참고</em>
<a href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/configuration">config 관련 documentation</a></p>
<p>{%highlight csharp %}
{%endhighlight%}</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-3a74d2ed84a139a2f89740930cbacc77">가상화 기술</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-03-11" class="text-muted">2017.03.11</time>
        
	</div>
	<p>알다시피, 클라우드 컴퓨팅의 기반 핵심 기술은 “가상화” 기술이다. Azure에 관한 포스팅을 시작하기 전에, 가상화 기술에 대해서 어느 정도의 지식을 갖고 Azure를 시작하기 바라는 마음에서 포스팅을 계획하였다.</p>
<p>가상화(Virtualization)에 대한 글을 쓰려다 Operating System Concepts 이라는 예전 운영체제 과목 교재를 꺼내게 되었다. 흠 일단 Computing Environments라는 카테고리를 흥미롭게 읽었는데, 역시 책을 읽기 잘했다.</p>
<p>그리고! 영어 책을 읽길 잘했다.</p>
<p>*참고.</p>
<p>Mobile Computing</p>
<p>Computing 환경이 smart-phone이나 tablet인 경우의 computing 을 “모바일 컴퓨팅”이라고 한다. 기존에 가벼운 무게와 휴대성을 위해 screen size나 메모리 용량, 전체적 기능성을 포기했던 것과 달리 최근 모바일 기기들은 오히려 데스크탑에서 힘든 기능을 제공하기도 한다. Physical feature, 즉 하드웨어적 특성이 다르나, GPS, 가속기계, 회전성에서 모바일 기기들은 Unique Feature를 가진다. Navigation 기능을 제공하는 Application이나, 움직임을 감지하여 모바일 기기를 흔들고 기울이며 새로운 인터페이스를 제공하는 게임도 가능하고, 증강현실(Augmented Reality) 어플리케이션에서도 유용하게 쓰일 수 있다. 이런 어플리케이션들은 노트북이나 데스크탑 시스템에서는 개발 되기 어렵다.
모바일 기기들은 보통 IEEE 표준 802.11 무선 네트워크나 cellular data 네트워크를 이용한다. 메모리의 경우 64gb정도를 제공하는데, 1TB 메모리 용량을 가진 데스크탑이 흔한것과 비교하면 작은 편이다. 프로세서 또한 전원 사용 문제 때문에 작고 느리거나, 보통 데스크탑보다 적은 코어를 가진 프로세서를 사용하는 편이다.
Apple의 IOS와 Google의 Android가 대표적인 모바일 컴퓨팅 운영체제이고 IOS의 경우 Apple 의 기기에서만 동작하게 디자인 되어있다.</p>
<h1 id="가상화virtualization">가상화(Virtualization)</h1>
<p>가상화는 간단하게 말하자면, IT 자원(Resource)을 추상화한 것이다. 여기서 자원은 네트워크, 저장소, 서버등이 될 수 있다. 즉, 물리적인 디바이스에 관계없이 완전히 기능적인 측면, 마치 Application을 사용하듯이 컴퓨팅 자원을 사용할 수 있다는 것이다. 책의 표현을 빌리자면, 운영체제(Operating System, 줄여서 OS) 위에 운영체제들이 마치 일반 응용 프로그램(Application)인 것 처럼 동작(run)할 수 있도록 하는 기술이다. 하지만, 방금 말한 책의 표현은 가상화의 일부이고, 밑에 깔리게 되는 호스트 운영체제 없이 하드웨어, 하이퍼바이저, 그리고 하이퍼바이저 위의 운영체제들만 동작하는 가상화도 존재한다.</p>
<p>내가 참고한 책에서는 가상화(Virtualization)과 에뮬레이션(Emulation)의 개념이 함께 설명되어있는데, 에뮬레이션은 Source CPU와 Target CPU의 타입이 다를때 쓰인다.</p>
<p>예를 들어, Apple이 IBM Power CPU에서 Intel x86 CPU로 CPU를 바꿨을 때, Rosetta라는 emulation 기능을 포함했다고 한다. CPU의 아키텍쳐가 달라졌기 때문에, 기존의 IBM CPU로 컴파일 되도록 디자인된 어플리케이션들이 Intel CPU에서도 실행될 수 있도록 하는 것이다. IBM CPU 기준으로 작성된 모든 Machine-level Instruction들이 target CPU인 Intel CPU의 동등한(Equivalent)한 함수(function)로 한줄 한줄 번역(translate)되어야 하기에 굉장히 무거웠을(heavy) 것이다.</p>
<p>Emulation은 Interpretation이라고 하는, 컴퓨터 언어가 complie 되지 않고, high-level 형태나 중간 형태로 translated 되는 경우에 쓰인다. 대표적으로 자바는 Interpreted 언어이다. Interpretation은 high-level language가 native-CPU instruction으로 번역될 때, 해당 언어가 native하게 동작하는 이론적인 가상 머신을 emulate하는 emulation의 한 형태이다. 따라서 Java Virtual Machine, JVM이 쓰인다. 이렇다보니 당연히 Java는 C보다 느리지만, Platform Independence를 가질 수 있다.</p>
<p>예전에 포켓몬 에뮬레이터를 이용하여 포켓보이용 포켓몬스터 게임이나 피카츄 배구를 실행해본 것이 기억난다. 즉, 해당 플랫폼 또는 아키텍처에서 실행 불가능한 응용 프로그램을 실행가능하도록 만들기 위해 Emulator가 해당 플랫폼에 맞는 Machine Level 언어로 번역하여 해당 플랫폼에 돌아갈 수 있는 Application으로 구현한것이다.</p>
<p>내가 다뤘던 오픈소스 가상화 솔루션 KVM의 경우에는 QEMU라는 하드웨어 에뮬레이터를 사용한다. Virtual Machine들은 에뮬레이트된 하드웨어를 실제 하드웨어처럼 인식하여 사용하는것이다.</p>
<p>정리하자면,</p>
<p>에뮬레이션 해당 OS를 위해 디자인되지 않은 플랫폼(아키텍처)에서 해당 OS를 실행할때. / 예를 들어, MAC OS X를 위해 디자인 된 MacBook Pro에서 Window 용 프로그램을 실행할때 사용 할 수 있다.</p>
<p>다시 가상화로 가자면, 에뮬레이션과 달리 가상화에서는 CPU가 같은 두개의 OS는 함께 구동 될 수 있다.</p>
<p><img src="https://nayoonhwang.blob.core.windows.net/newcontainer/%E1%84%80%E1%85%B3%E1%84%85%E1%85%B5%E1%86%B71.png" alt="그림1"></p>
<p>위와 같이 hardware가 존재하고 그 위에 Virtual Machine Monitor(또는 Manager)가 구동이 된다. VMM은 CPU, 메모리등 하드웨어 자원을 가상화 하여, 한개의 Physical Hardware 위에 여러 개의 Virtual Machine이 구동되는 것을 가능하게 한다. 그림에 나와 있듯이 VMM은 Hypervisor라고도 한다. Virtual Machine들이 Hardware 자원을 요청할때, VMM(Hypervisor)에게 API call을 날리고 Hypervisor가 Hardware에 직접 접근하여 요청을 수행하여 결과물을 Return 해준다. 각각의 VM들은 격리(Isolated) 되어 있고 각 VM들에게 가상CPU(vCPU), 가상 메모리, 가상 네트워크등 컴퓨팅 자원을 가상화하여 제공하기 때문에 다른 VM들과 마치 다른 환경에 있는 것 같은, 각 VM이 각자의 Physical 환경에서 구동되는 것 같은 느낌을 준다. 이런 가상화 기술을 통해 VM을 쓰면서, 물리 머신과의 차이점을 느끼지 못하게 만들 수 있다.</p>
<p>자, 그럼 이 가상화 기술이 어떻게 클라우드 컴퓨팅에 적용되어있는지 살펴보자.</p>
<p>클라우드 컴퓨팅은 컴퓨팅, 저장소, 어플리케이션까지 네트워크를 통한 서비스로 제공하는 컴퓨팅의 한 형태이다. 이러한 기능은 가상화를 기반으로 만들어졌다. 가상화의 논리적인 확장이라고 볼 수 있는 셈이다.</p>
<p>흔히 클라우트 컴퓨팅은 아래 3가지로 구분할 수 있다. IT 리소스를 네트워크를 통해 제공한다는 점에서는 모두 같지만, 어디까지 제공하느냐, 그 범위에 따라 나뉜다. 쉽게 말하면, 밑으로 갈수록 클라우드 제공자가 더 갖춰놓은 환경이라는 것이다. 반대로 위로 갈수록, 사용자 자율이 더 커진다.</p>
<p><img src="https://nayoonhwang.blob.core.windows.net/newcontainer/marker-azure-partner_nxtarx.png" alt="그림1">
*지금 이것도 azure 가상 저장소 Blob을 통해 업로드한 후 가져온 그림이다.</p>
<p>IAAS(Infrastructure-As-A-Service) : 가장 작은 범위를 제공하며, 우리에게 친숙한 서비스이다. 가상 머신(VM), 서버, 저장소등 IT 인프라를 제공한다. Microsoft Azure VM Ubuntu 14.04 하나를 구매했다고 하자. 인터넷으로 언제든지 내가 구매한 Ubuntu에 접근하여 마치 내 컴퓨터인것 처럼 사용할 수 있다. 그리고 내가 사용한 만큼만 지불하면 된다. VM에 사용자의 용도에 맞는 환경을 사용자가 직접 셋팅하고 자유롭게 사용할 수 있다.</p>
<p>PAAS(Platform-As-A-Service): 소프트웨어 응용프로그램을 개발, 제공, 관리하기 위한 소프트웨어 환경(software stack)이 갖춰져서 서비스 되는 형태. 예를 들어, Azure Web App을 이용하여 .NET Framework 프로젝트를 비쥬얼 스튜디오 또는 깃, 깃허브와 같은 원격저장소를 통해 업로드하면, 개발자가 배포(Deploy)를 신경쓰지 않아도 된다. Azure가 알아서 배포 환경을 셋팅하고 배포하기 때문이다.</p>
<p>SAAS(Software-As-A-Service): 말 그대로 인터넷으로 소프트웨어 응용프로그램을 사용하는 것으로, Office365, 일정(calendar)등의 예를 들 수 있고, 이는 기존의 응용프로그램들이 통째로 클라우드로 옮겨진 형태라고 보면 된다. 언제 어디서든 접근이 가능하다는 클라우드의 장점이 더해진것이다.</p>
<p><img src="https://nayoonhwang.blob.core.windows.net/newcontainer/image_3.png" alt="그림2"></p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-b0cd3556ecf93236878c12d758b2b517">랍스타 맛있다</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-03-07" class="text-muted">2017.03.07</time>
        
	</div>
	<p>이태원 레스토랑인 ORENO를 다녀왔다.</p>
<p>내 생일이라 언니가 일단 선물로 랑콤 팩트를 사줬당 호호호 넘 좋당 촉촉한 파운데이션 팩트.</p>
<p>비교대상은 맥, 입생로랑 르 쿠션, 디올 스노우 쿠션이었지만, 디올은 10만원이나 되는 가격(!), 입생로랑도 비쌌고(7만9천원) 맥은 괜찮았지만 랑콤이 가장 저렴하고 무난해서 그걸로 결정!</p>
<p>아무튼 잘 쇼핑하고!</p>
<p>예약해둔 오레노로 향했다.</p>
<p>랍스타 ㅎ흐흐흐ㅡㅎ 일 한정 15마리라고 한다! 다행히 먹을 수 있었고, 와인 한잔씩과 와인 샘플러를 주문했다.</p>
<p><img src="https://nayoonhwang.blob.core.windows.net/newcontainer/UNADJUSTEDNONRAW_thumb_1156.png" alt="랍2"></p>
<p><img src="https://nayoonhwang.blob.core.windows.net/newcontainer/IMG_3869.jpg" alt="랍스타"></p>
<p><img src="https://nayoonhwang.blob.core.windows.net/newcontainer/UNADJUSTEDNONRAW_thumb_1155.jpg" alt="와안"></p>
<p>으흥흥 넘 맛있엉 ㅎㅎㅎㅎ으흫ㅇ흫ㅎ</p>
<p>그 이후에 비스마르크 피자에 맥주까지 더 먹었다는 것은 흐흐흫</p>
<p>게다가 투썸 케익까지 먹음 호우</p>
<p>다이어트 걱정없이 먹었던 하루, 빠이빠이!</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-4a2543332b7a28b2460f3553c052cd86">asp.net study</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-03-06" class="text-muted">2017.03.06</time>
        
	</div>
	<p>ASP.net Core 학습중이다</p>
<p><a href="https://nayoonhwang.visualstudio.com/MySecondProject/_dashboards">내 비쥬얼 스튜디오 온라인 팀프로젝트</a></p>
<p>ASP.net Core 공식 다큐먼테이션을 참고하여 설치하였고</p>
<p>Editor로 VS code를 사용한다. (VS studio for Mac을 설치하여 주말동안 시도해보았으나 삽질하고 그냥 실패, 시간만 날렸다.)</p>
<p><img src="https://nayoonhwang.blob.core.windows.net/newcontainer/pic2.png" alt="이미지">
VSCode에서 Git은 이렇게 사용하면 된다.
initalize 하고, 체크 버튼/ cmd+ enter로 commit 완료.</p>
<p>*본 이미지는 azure 저장소의 blob 을 이용. 컨테이너 설정을 개인이 아니고 blob으로 설정해주면 public access 가능.</p>
<p>터미널에 remote add origin URL 입력해주고 push 해주면 끝.</p>
<p>이때 비쥬얼 스튜디오 온라인 팀프로젝트를 사용하고 싶으면 온라인에서 프로젝트 new 해주고 나오는 URL을 써주면 된다(Github와 같다).</p>
<p>오늘은 기본적인 CRUD를 구현해보았는데,</p>
<p>먼저 게시글을 관리할 Post Controller가 필요하였기에 다음과 같이 만들었다.</p>
<p>{%highlight csharp %}
public IActionResult Create()
{
if(HttpContext.Session.GetInt32(&ldquo;AccountId&rdquo;)!= 0)
return View();
else
return RedirectToAction(&ldquo;Login&rdquo;, &ldquo;Auth&rdquo;);
}
public IActionResult Create(string title, string content){
Post new_post = new Post();
new_post.Title = title;
new_post.Content = content;
var db = new DatabaseContext();
db.Posts.Add(new_post);
db.SaveChanges();
return RedirectToAction(&ldquo;Detail&rdquo;, new{id = new_post.Id});
}
{%endhighlight%}</p>
<p><em>dotnet ef 에 관련한 정보.</em><br />
<strong>migration file 추가 (If it’s the first one, it will add the neccessary folder structure and classes)</strong><br />
<span style="color:#003366">dotnet ef migrations add {MigrationName}</span><br />
<strong>최근 migration 삭제</strong><br />
<span style="color:#003366">dotnet ef migrations remove</span><br />
<strong>최신버전으로 database update (apply all migrations)</strong><br />
<span style="color:#003366">dotnet ef database update</span></p>
<p>dotnet ef database update <previous-migration-name>
을 사용하면 특정 migration 으로 복귀 가능한듯하다.</p>
<p>Create Action같은 경우에는 post로 지정해주면 자동으로 <input> tag를 통해 입력해준 parameter 값들이 전달된다.</p>
<p>{% highlight html %}</p>
<form method="POST">
    <p>게시글 작성</p>
    <p>제목: <input name= "title" type = "text"></p>
    <p>내용:<input name= "content" type = "text"></p>
    <input type= "submit" value = "Submit">
</form>
<p>{% endhighlight%}</p>
<p>{% highlight csharp %}</p>
<pre><code>public IActionResult Create()
{
        if(HttpContext.Session.GetInt32(&quot;AccountId&quot;)!= null)
            return View();
        else
            return RedirectToAction(&quot;Login&quot;, &quot;Auth&quot;);
}

//Post method를 위해 post 어트리뷰트 붙여주기
[HttpPost]

public IActionResult Create(string title, string content)
{
    Post newPost = new Post();
    newPost.Title = title;
    newPost.Content = content;

    var db = new DatabaseContext();
    db.Posts.Add(newPost);
    db.SaveChanges();

    return RedirectToAction(&quot;Detail&quot;, new{id = newPost.Id});
}
</code></pre>
<p>{%endhighlight%}</p>
<p>[HttpPost]를 이용해서 Post Method을 사용하는 Action임을 알리자.  HttpPostAttribute의 준말.</p>
<p>기본 Default인 Get방식을 사용하는 Create()와 구분가능.</p>
<p>모호한 함수지정 에러를 피할 수 있다. (AmbiguousActionException: Multiple actions matched.)</p>
<p>Create Action으로 Post 객체를 생성했으니, Detail로 이동할 차례,</p>
<p><span style="color:#003366">return RedirectToAction(&ldquo;Detail&rdquo;, new{id = newPost.Id});</span></p>
<p>으로 이동해줄텐데, 동일 컨트롤러 내의 Detail 액션으로 이동할 때, 익명 객체를 생성하여 파라미터로 함께 보내준다. new{} 안에 id 객체를 넣을 건데 이는 생성된 post의 id를 넣어 보낸다.</p>
<p>이렇게 보내진 id는</p>
<p>{% highlight csharp %}</p>
<p>public IActionResult Detail(int id)
{
var db = new DatabaseContext();
var post = db.Posts.Find(id);</p>
<pre><code>return View(post);
</code></pre>
<p>}</p>
<p>{%endhighlight%}</p>
<p>기본적으로 controller / action / id로 routing 이 진행된다.</p>
<p>{% highlight csharp %}
app.UseMvc(routes =&gt;
{
routes.MapRoute(
name: &ldquo;default&rdquo;,
template: &ldquo;{controller=Home}/{action=Index}/{id?}&quot;);
});
{%endhighlight%}</p>
<p>따라서,</p>
<p>{%highlight html %}
//Post 객체가 나올 것이라고 예고하기 위해 @model을 썼다.
//@는 c#코드를 html파일에 쓰기 위해 사용하는 기호
@model Post</p>
<p>//c# 코드가 1줄동안 이어지기 때문에 중괄호를 사용해주었다 띄어쓰기가 포함되어있는 c#코드는 {}가 필요하다.
@{Post post= Model;}</p>
<h1>게시글 @post.Id </h1>
<div>
<p>제목: @post.Title</p>
<p>내용: @post.Content</p>
</div>
{%endhighlight%}
<p>여기서 @Model의 Model은 넘겨진 View(post)의 파라미터 Post객체를 의미하겠지.
물론 Detail.cshtml파일에서 Model 을 다루기 위해서는</p>
<p>_ViewImports.cshtml 파일에
@using WebApplication.Models
을 삽입해줘야한다.</p>
<p>마지막 정리는 Session 문제</p>
<p>Login, Join 문제를 위해!</p>
<p>using Microsoft.AspNetCore.Http; 일단 이거 import 해주고,</p>
<p>{% highlight csharp %}
{%endhighlight%}</p>
<p>{% highlight csharp %}
{%endhighlight%}</p>
<p>{% highlight csharp %}
{%endhighlight%}</p>
<p>{% highlight csharp %}
{%endhighlight%}</p>
<p>nullable에 대하여 =&gt; model 간 관계가 optional일때는 nullable 객체가 필요하다.</p>
<p>즉,</p>
<p>{% highlight csharp %}</p>
<p>//related exhibition OPTIONAL
public long? ExhibitionId { get; set; }
public Exhibition RelatedExhibition { get; set; }</p>
<p>{%endhighlight%}</p>
<p>이런식이 되는 것인데, RelatedExhibition은 exhibition 객체이다. 즉. class 객체일 경우 reference 타입(주소값 타입)이라 ?라는 nullable 표시가 필요없다. 하지만 ExhibitionId의 경우 value 타입(값 타입)이기 때문에 빌 수 있다(여기서는 연관된 exhibition을 가지지 않을 수 있다라는 뜻)는 nullable 표시 ?을 붙혀주어야한다. 그래서 long? 타입으로 선언해 준것이다.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-876d4196780603040ae9e884b3e281ff">가상화</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-02-27" class="text-muted">2017.02.27</time>
        
	</div>
	<p>가상화 관련된 논문을 쓰고 있다보니 좋은 자료들이 몇개 보인다.</p>
<p><a href="https://www.slideshare.net/HwanjuKim/3cpu-virtualization-and-scheduling">cpu virtualization and scheduling</a></p>
<p>카이스트 전산학과 분이 만드신 건데 이 분 굉장히 고퀄 논문을 많이 쓰셨다. Xen 기반으로 작업하신듯 하다.</p>
<p>가상화에 대한 블로그글도 쓰기로 했는데 언제쓰냐&hellip;</p>
<p>일단 논문쓰면서 틈틈히 써봐야겠다.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-c6301d9eec3d790c31fe69b331b2cd82">공부중</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-02-22" class="text-muted">2017.02.22</time>
        
	</div>
	<p>공부중.</p>
<p><a href="https://joshua1988.github.io/web_dev/web-protocols/">웹 프로토콜</a></p>
<h1 id="다시-생활리듬이-서울리듬으로-돌아왔다">다시 생활리듬이 서울리듬으로 돌아왔다</h1>
<p><em>11시면 엄청나게 졸렸었는데 지금은 다시 1시 취침모드로,,</em></p>
<p><span style="color:blue">요즘엔 앞으로 뭘 먹고 살아야하는지 어떻게 살아야하는지 개발을 계속 해야하는지 정말 고민된다. </span></p>
<p>맨날 4차 산업 혁명이다, 새로운 User Interface가 등장할 것이다 뭐다. 뭔가 삶의 자세가 바뀌어야 할 것같은 느낌.</p>
<p>일단 한국땅에서 계속 살아야하는지도 고민이 되고,,,다 때려치고 여행작가가 할까 싶기도 하고</p>
<p>고민을 해결하는 방법은 직접 어느정도 개발을 해보는 방법 뿐이겠다 싶어 인턴을 시작하기로 했고 당장 이틀 뒤 출근이다.</p>
<p>4월 말 갈 정보처리학회 때문에 오늘 처음으로 논문을 써봤는데, 왠걸, 꽤 재미있다. 물론 참고문헌 뒤지고 어쩌구 하느라 생각보다 머리아프긴 하지만,,,</p>
<p>일단 지금은 어제 하도 많이 술을 먹어서 숙취가 있는건지 머리가 계속 지끈하다. 어제는 정말 이족 보행이 불가능할정도로 많이 먹었다. 미쳤지 미쳤어&hellip;항상 어느 순간 갑자기 기억을 잃어서 항상 걱정된다.</p>
<p>맨날 고민을 하다보니 자꾸 스트레스 쌓이는듯, 3월 개강하고 모든 거 다 잘할 수 있을까 벌려놓은건 엄청많은데&hellip;.</p>
<p>일단 모니터랑 키보드는 매우 맘에 든다. 갑자기 40만원정도를 지출하긴 했지만 값어치하리라 믿는다.</p>
<p>파이빌 면접도 잘 본것같고,,,,,,<span style="color:#003366">다시 행복해지자 긍정적인 마인드를 항상 잃으면 안된다.</span></p>
<p>근데 자꾸 까먹게 된다.</p>
<p><span style="color:#003366">사람은 망각의 동물이야. 기록을 해야돼 기록을&hellip;</span></p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-ce2bd3b2901fcf0db7d4c036db9ca2f8">실리콘 밸리</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-02-16" class="text-muted">2017.02.16</time>
        
	</div>
	<p>얼마전 실리콘밸리를 다녀와서인지 더 공감되고 내가 바뀌어야하는지를 고민하게만드는 글.</p>
<p><span style="color:#003366">&ldquo;예를 들어 주소록 앱을 만든다고 치면 한국의 대기업에서는 기획서 200장이 나오겠죠. 하지만 여기서는 단 2장의 기획서면 충분합니다.</span>
<span style="color:#003366">한국에서는 기획자가 구성하고 설계하여 엔지니어에게 기한을 정해주고 숙제를 내주는 식으로 기획서를 전달하죠.</span>
<span style="color:#003366">그러면 엔지니어는 기한을 맞추기 위해 내가 잘하던 것 잘하던 언어 쓰던 코드를 갖다 붙힐 수 밖에 없어요.</span></p>
<p><span style="color:#003366">하지만 실리콘 밸리에서는 디자이너, 프로젝트 매니저와 함께 세상을 바꿀 최고의 주소록을 만들어보라며 프로젝트를 던져주고 끝입니다. 내가 처음부터 기획하고 구성하는데 참여하기에 최고의 디자인, 최고의 기능으로 만들고 싶은 욕구가 생기죠. 그렇기에 일이 많아져도, 야근에도 거부감이 없어요.</p>
<p><span style="color:#003366">내가 창조하고 싶은 걸 내손으로 하기 때문입니다.</span></p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-7bb00fe411e20c269d043577447cec85">JAVA</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-01-22" class="text-muted">2017.01.22</time>
        
	</div>
	<p><span style="color:red;font-size:10pt">* 본 포스팅은 <a href="https://www.tutorialspoint.com/java/java_basic_syntax.htm">튜토리얼 포인트</a>를 번역한 게시물입니다.</span></p>
<p>자바 프로그래밍 언어는 Sun Microsystem 창립자 james gosling에 의해 개발되었고 1995년에 Sun Microsystem 자바 플랫폼 코어 컴포넌트로 출시되었다.</p>
<p>자바는</p>
<p>#Object Oriented</p>
<p>객체 지향적이다. 자바에서는 모든것이 객체(object)이다. JAVA는 객체 모델을 기반으로 하고 있기 때문에 쉽게 확장될 수 있다.</p>
<p>#Platform Independent</p>
<p>플랫폼 독립적이다. C나 C++과 같은 많은 다른 프로그래밍 언어들과는 다르게, 자바가 컴파일 될때, 플랫폼 특정적인 머신으로 컴파일 되지 않고 플랫폼 독립적인 바이트 코드로 컴파일된다.</p>
<p>이 바이트 코드는 웹을 통해 분배되고 어떤 플랫폼에서 돌아가던 JVM이라는 자바 가상머신에 의해서 Interpret된다.</p>
<p>#Simple</p>
<p>자바는 쉽게 배울 수 있도록 디자인되었다. OOP 자바의 기본 컨셉을 이해한다면, 마스터하기 쉬울 것이다.</p>
<p>#Secure
자바의 안전한 feature은 바이러스 없이, tamper 없는 시스템을 개발할 수 있도록 한다. 인증 기술을 공개키 암호화에 기반하고 있다.</p>
<p>#Architecture</p>
<p><strong>neutral</strong></p>
<p>중립적이다. - 자바 컴파일러는 아키텍처-중립적인 객체 파일 형식을 생성한다. 이는 컴파일된 코드가 자바 실행환경만 존재한다면, 많은 프로세서에서 실행가능하도록 한다.</p>
<p><strong>Portable</strong></p>
<p>아키텍처 중립적이고 구현 의존적인 면이 없기 때문에 자바는 portable하다. java의 컴파일러는 POSIX의 subset인 ansi c로 쓰여있고 이는 깔끔한 이식성을 자랑한다.
Robust − Java makes an effort to eliminate error prone situations by emphasizing mainly on compile time error checking and runtime checking.</p>
<p><strong>Multithreaded</strong></p>
<p>자바의 multithread 기능으로 많은 task를 <em>동시에</em> 수행할 수 있는 프로그램을 만드는 것이 가능하다. 이런 디자인 특징은 개발자들이 부드럽게 실행될수 있는 대화형 application을 만들 수 있게 한다.</p>
<p><strong>Interpreted</strong></p>
<p>자바의 바이트 코드는 native 머신으로 번역되지만 어디에도 저장되지 않는다. linking이 증가하고 가벼운 프로세스 이기 때문에 개발 프로세스는 더 빠르고 분석적이다.</p>
<p><strong>High Performance</strong></p>
<p>고성능이다. Just-In-Time 컴파일러의 사용으로, 자바는 고성능을 가능하게 한다.</p>
<p><strong>Distributed</strong></p>
<p>분산 환경이다. 자바는 인터넷 분산환경을 기반으로 디자인되었다.</p>
<p><strong>Dynamic</strong></p>
<p>자바는 진화하는 환경에 적응할 수 있도록 디자인 되었기 떄문에 c나 c++보다 더 동적이라고 판단된다. 자바 프로그램은 실행중의 객체로의 접근을 verify하고 해결하는 데 쓰일 수 있는 실행중 정보의 많은 양을 처리할 수 있다.</p>
<p>자바 프로그램은 서로의 method를 호출하면서 통신하는 객체들의 집합으로 정의할수 있다.</p>
<p>Object
객체 - 객체는 상태와 행동을 가진다. <br />ex) 개는 상태를 가진다. 색깔 이름 종, 또한 꼬리를 흔들고 짖고 먹는등 행동도 가진다. 객체는 class의 instance이다.</p>
<p>Class
class는 이 타입의 객체가 지원하는 상태나 행동을 표현하는 template이나 blueprint으로 정의할 수 있다.</p>
<p>Methods
함수는 기본적으로 행동이다. 클래스는 많은 함수를 포함할 수 있다. logic이 쓰이고 데이터가 조작되고 모든 action이 수행되는 곳은 함수이다.</p>
<p>Instance Variables
각각의 객체는 unique한 instance 변수 집합을 가진다. 객체의 상태는 이 instance 변수들에 부여된 값(value)에 의해 만들어진다.</p>
<h1 id="몇-가지-자바의-중요한-규칙들">몇 가지 자바의 중요한 규칙들!</h1>
<p>Case Sensitivity
대소문자 구분, Hello 와 hello는 다르다.</p>
<p>Class Names
클래스 이름 첫 글자는 대문자여야 한다 여러 단어라면 각 단어의 첫 글자는 대문자여야한다.
<span style="color:#003366">Ex) class MyFirstJavaClass </span></p>
<p>Method Names
함수 이름은 소문자여야한다. 여러 단어라면, 각 단어의 첫글자는 소문자여야한다.
<span style="color:#003366"> public void myMethodName()</span></p>
<p>Program File Name
프로그램 파일 이름은 반드시 클래스 이름과 정확히 match 해야한다.</p>
<p>파일을 저장할때, class이름을 사용해서 저장해야한다. ~.java . 만약 파일이름과 클래스 이름이 맞지 않는다면 컴파일 되지 않을 것이다.
<span style="color:#003366"> = &lsquo;MyFirstJavaProgram&rsquo;이 클래스 이름이면, 파일 이름은 &lsquo;MyFirstJavaProgram.java&rsquo;여야한다.</p>
<p>public static void main(String args[])
자바 프로그램 프로세싱은 모든 자바 프로그램의 필수적인 부분인 main 함수부터 시작한다.</p>
<h1 id="기타">기타</h1>
<p><em>Java identifier</em>
클래스 , 함수 , 변수에는 이름이 필요하고 그 이름을 식별자(identifier)라고 한다. 식별자는 글자(letter)로 시작해야한다. 예약어 사용불가.</p>
<p><em>Java Modifiers</em>
다른 언어처럼, 자바는 modifier를 이용하여 클래스, 함수등을 변경할 수 있다. 2가지 종류의 modifier가 있다.
접근 modifier - default, public , protected, private
비접근 modifier - final, abstract, strictfp</p>
<p><em>Java Variables</em>
자바에서 사용하는 종류의 변수이다.
Local Variables - 지역변수
Class Variables (Static Variables) 클래스 변수 - static 변수
Instance Variables (Non-static Variables) - 인스턴스 변수 - 비-static 변수</p>
<p><em>Java Arrays</em>
배열은 같은 타입의 여러개의 변수를 저장하는 객체들이다. 그러나 배열자체는 heap영역의 객체이다.</p>
<p><em>Java Keywords</em>
아래 리스트는 자바의 예약어들이다. 변수 명등으로 쓰일 수 없다.</p>
<blockquote>
<p>abstract	assert	boolean	break<br />
byte	case	catch	char<br />
class	const	continue	default<br />
do	double	else	enum<br />
extends	final	finally	float<br />
for	goto	if	implements<br />
import	instanceof	int	interface<br />
long	native	new	package<br />
private	protected	public	return<br />
short	static	strictfp	super<br />
switch	synchronized	this	throw<br />
throws	transient	try	void<br />
volatile	while<br /></p>
</blockquote>
<p>Inheritance
상속. 자바에서는 클래스는 클래스에서 파생될 수 있다. <br />기본적으로 새로운 클래스를 만들고 싶고 당신이 필요한 코드의 일부를 가지는 클래스가 이미 존재한다면, 새로운 클래스를 이미 존재하는 것에서 파생시키는 것이 가능하다.
<br />이 개념은 당신이 새로운 클래스에서 코드를 다시 작성하지 않아도 현재 존재하는 클래스의 변수나 함수를 재사용할 수 있게 허용한다. 존재하는 클래스는 super클래스이고 파생되는 클래스는 subclass이다.(부모-자식)
Interfaces
자바에서 interface는 서로와 어떻게 통신할건지에대한 객체들 간의 계약으로 정의될 수 있다. 인터페이스들은 중요한 상속의 개념으로 오면 중요한 역할을 수행한다.
An interface defines the methods, a deriving class (subclass) should use. But the implementation of the methods is totally up to the subclass.
interface는 파생되는 클래스가 사용할 함수를 <span style="color:red"><em>정의</em></span>하지만 함수의 구현은 완전히 subclass의 몫이다.</p>
<p>자바는 객체 지향 언어이다. 객체 지향 성질의 언어로서 자바는 다음의 근본적인 개념을 지원한다.
Polymorphism
Inheritance 상속
Encapsulation
Abstraction
Classes
Objects
Instance
Method
Message Parsing</p>
<p>Objects in Java
자바에서의 객체</p>
<p>Classes in Java
자바의 클래스는 어떤 객체에 대한 설계이다.
{% highlight java %}
public class Dog {
String breed;
int ageC
String color;</p>
<p>void barking() {
}</p>
<p>void hungry() {
}</p>
<p>void sleeping() {
}
}</p>
<pre><code>
A class can contain any of the following variable types.

Local variables − Variables defined inside methods, constructors or blocks are called local variables. The variable will be declared and initialized within the method and the variable will be destroyed when the method has completed.

Instance variables − Instance variables are variables within a class but outside any method. These variables are initialized when the class is instantiated. Instance variables can be accessed from inside any method, constructor or blocks of that particular class.

Class variables − Class variables are variables declared within a class, outside any method, with the static keyword.

A class can have any number of methods to access the value of various kinds of methods. In the above example, barking(), hungry() and sleeping() are methods.

Following are some of the important topics that need to be discussed when looking into classes of the Java Language.

Constructors
When discussing about classes, one of the most important sub topic would be constructors. Every class has a constructor. If we do not explicitly write a constructor for a class, the Java compiler builds a default constructor for that class.

Each time a new object is created, at least one constructor will be invoked. The main rule of constructors is that they should have the same name as the class. A class can have more than one constructor.

Following is an example of a constructor −

Example
public class Puppy {
   public Puppy() {
   }

   public Puppy(String name) {
      // This constructor has one parameter, name.
   }
}
Java also supports Singleton Classes where you would be able to create only one instance of a class.

Note − We have two different types of constructors. We are going to discuss constructors in detail in the subsequent chapters.
</code></pre>
</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-65fbf792fc10a6ee62353c1c52faa01b">Scheduling 의 관점에서 본 Thread</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2017-01-16" class="text-muted">2017.01.16</time>
        
	</div>
	<p>11-18 게시물에 OS의 입장에서 바라본 프로세스와 쓰레드에 대해서 포스팅헸다. 오늘 포스팅은 Kernel단과 Hardware단의 Thread에, 특히 스케줄링에 중점을 두어 포스팅하겠다.</p>
<p>Thread의 종류</p>
<p><span style="color:#003366">-       User level threads (application)</span></p>
<p><span style="color:#003366">-       Kernel level thread (operating system)</span></p>
<p><span style="color:#003366">-       Hardware Threads (each processor)</span></p>
<p>*thread는 Scheduling과 연관이 높다.</p>
<p>Single Thread: =&gt; process 단위 스케줄링</p>
<p>But,</p>
<h1 id="thread-단위-scheduling">Thread 단위 scheduling</h1>
<p>Multi-thread =&gt; 자원 사용 확률 (thread가 늘어 날 수 록 선점효과 상승). 연산량/ Real-time/ Delay-critical한 Application들에 사용.</p>
<p>VM – VM – VM =&gt; VM 내 thread scheduler (VM의 OS)</p>
<p>Hypervisor =&gt; Hypervisor내 vCPU scheduler</p>
<p>Hardware</p>
<p>VM은 자기 자신이 그냥 Machine 인줄 알기 때문에 (OS 그대로 넣으니까)</p>
<p>일반적인 scheduling을 한다. 하지만 OS가 schedule하는 vCPU들은 실제 CPU가 아니기 때문에, hypervisor가 vCPU들을 실제 pCPU에 schedule 시켜야한다. (vcpu scheduler)</p>
<h1 id="span-stylecolor003366vcpu-affinity-vcpu--pcpu-간의-연결-관리자-지정--pinning-과-비슷한-개념span"><span style="color:#003366">vcpu affinity: vcpu – pcpu 간의 연결. (관리자 지정) – pinning 과 비슷한 개념.</span></h1>
<p><em>NUMA(Non Uniform Memory Access) : 일종의 processor 설계 방법으로, 메모리 접근 속도를 높이기 위해 core를 분산하여 설계.</em></p>
<p>NUMA node 1, NUMA node 2 이런 식으로 분할한다.</p>
<p>Vcpu가 Pcpu 개수 이상이면, overbooking이라고 한다. =&gt; Public Cloud에서는 이런식으로 장사 함. (Azure, AWS EC2)</p>
<ul>
<li>
<p>Context switching 이 많이 일어날 수 밖에 없다.</p>
</li>
<li>
<p>대규모 Parallel application에서는 절대 안됨!</p>
</li>
</ul>
<ul>
<li>네트워크에서 동적 주소 할당과 비슷한 개념.</li>
</ul>
<p><a href="http://mooneegee.blogspot.kr/2015/01/os-thread.html">관련 자료 링크</a></p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-f2506e6ae7c9a69d2d9a0b09f623b324">네트워크 기말정리</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2016-12-16" class="text-muted">2016.12.16</time>
        
	</div>
	<p>오늘 유쁠러스 오티를 다녀왔는데&hellip;공부를 더더욱 열심히해야겠다는 생각이! 붙여주신 과장님도 뵙고&hellip;</p>
<p>이번 포스팅에서는 이번학기 가장 열심히 들었던 네트워크수업의 기말 정리를 공유하겠습니다..!</p>
<p>네트워크 수업&hellip;정말 어렵기도했지만 막상 끝나니깐&hellip;아쉬웠어요. 나름 재밌게 들었었는데..내 한학기ㅠㅠㅋㅋㅋㅋ 교수님 사랑합니다.</p>
<p><img src="https://s3.ap-northeast-2.amazonaws.com/matilda38.github.io/1.png" alt="1"><br />
<img src="https://s3.ap-northeast-2.amazonaws.com/matilda38.github.io/2.png" alt="2"><br />
<img src="https://s3.ap-northeast-2.amazonaws.com/matilda38.github.io/3.png" alt="3"><br />
<img src="https://s3.ap-northeast-2.amazonaws.com/matilda38.github.io/4.png" alt="4"><br />
<img src="https://s3.ap-northeast-2.amazonaws.com/matilda38.github.io/5.png" alt="5"><br />
<img src="https://s3.ap-northeast-2.amazonaws.com/matilda38.github.io/6.png" alt="6"><br />
<img src="https://s3.ap-northeast-2.amazonaws.com/matilda38.github.io/7.png" alt="7"><br />
<img src="https://s3.ap-northeast-2.amazonaws.com/matilda38.github.io/8.png" alt="8"><br />
<img src="https://s3.ap-northeast-2.amazonaws.com/matilda38.github.io/9.png" alt="9"><br />
<img src="https://s3.ap-northeast-2.amazonaws.com/matilda38.github.io/10.png" alt="10"><br />
<img src="https://s3.ap-northeast-2.amazonaws.com/matilda38.github.io/11.png" alt="11"><br />
<img src="https://s3.ap-northeast-2.amazonaws.com/matilda38.github.io/12.png" alt="12"><br />
<img src="https://s3.ap-northeast-2.amazonaws.com/matilda38.github.io/13.png" alt="13"><br />
<img src="https://s3.ap-northeast-2.amazonaws.com/matilda38.github.io/14.png" alt="14"><br />
<img src="https://s3.ap-northeast-2.amazonaws.com/matilda38.github.io/15.png" alt="15"><br />
<img src="https://s3.ap-northeast-2.amazonaws.com/matilda38.github.io/16.png" alt="16"><br />
<img src="https://s3.ap-northeast-2.amazonaws.com/matilda38.github.io/17.png" alt="17"></p>
<p>짠~!</p>
<p>중간정리와 함께 곧 같이 포스팅해야겠어요!</p>
<p>공부하는데 도움 되셨으면 좋겠습니다.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-69c109fecc4c3e3872f0b650bd3132a0">여행 어플리케이션</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2016-11-19" class="text-muted">2016.11.19</time>
        
	</div>
	<ol>
<li>tripomatic<br /></li>
<li>TourPlanb<br /></li>
<li>Hipmunk<br /></li>
<li>DBNavigator<br /></li>
<li>Waze<br /></li>
<li>Foodspotting<br /></li>
<li>ROME2rio<br /></li>
</ol>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-5890b2a2072b331bf21167ce499ff64c">operating system 요약</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2016-11-18" class="text-muted">2016.11.18</time>
        
	</div>
	<p><img src="http://i.dailymail.co.uk/i/pix/2009/07/08/article-1198262-05A2F11C000005DC-856_233x353.jpg" alt="how to interact with hardware"></p>
<h1 id="span-stylecolor003366font-size2emos란-뭘까span"><span style="color:#003366;font-size:2em;">OS란 뭘까?</span></h1>
<p>사용자(USER)가 hardware를 직접 다루기는 힘들다. 이때 사용자와 hardware를 연결(bridge)하는 역할을 맡은게 운영체제이다.</p>
<p>우리가 흔히 computer system이라고 부르는 것들은 이렇게 4가지 component를 가진다.</p>
<blockquote>
<p><em>User, application programs, Operating systems, hardware.</em></p>
</blockquote>
<p>이 중 기본적인 computing 자원(<em>resource</em>)을 제공하는 것이 hardware, 예를 들어 cpu, i/o (입출력장치), 메모리등이 있겠다.</p>
<p>application program은 유저의 computing problem을 해결하기 위해 resource에 대한 사용 명세서를 담은 프로그램이다.</p>
<p>그리고 operating system은 application과 user의 하드웨어 사용을 제어하고 돕는 역할을 하는 중재자이다.</p>
<p>기본적으로 os의 역할은</p>
<ol>
<li>Resource allocator (각 프로그램 마다 필요한 자원이 있을테니, 프로그램들이 필요할때 해당하는 자원(hardware)를 할당하는 역할.</li>
<li>Control program (프로그램들이 에러가 나지 않게 execute되고 부적절한 사용이 이루어지지 않도록 제어한다)</li>
</ol>
<p>두 가지라고 할 수 있다.</p>
<p>우리가 OS를 이해할 때 빠뜨릴 수 없는 개념이 OS 핵심 구성요소인 kernel인데 kernel에 대해서 잠깐 짚고 넘어가자.</p>
<p>kernel(커널)은 컴퓨터에서 항상 돌아가고 있는 프로그램이다. system programs는 os와 관련된 프로그램이지만, 커널의 일부는 아닌 프로그램이다. 반면 application program은 시스템의 운영(operation)과는 관련없는 모든 프로그램을 일컫는다.</p>
<p>cpu 및 자원들이 공통된 bus를 통해 shared memory에 접근하는 극도로 추상화된 그림을 살펴보며 이해해보자.</p>
<p><img src="https://s3.ap-northeast-2.amazonaws.com/matilda38.github.io/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA+2016-11-20+%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE+2.48.10.png" alt="concurrent execution of cpus and devices competing for memory cycle">
&ldquo;메모리 cycle을 위해 경쟁하는 cpu와 device들의 병렬적 execution&rdquo; 을 담고있는 그림이다.</p>
<h1 id="span-stylecolor003366font-sizeemprocess란-무엇인가span"><span style="color:#003366;font-size:em;">Process란 무엇인가</span></h1>
<p>Process란 간단히, 실행중에 있는 Program이다. 영어로, process is a particular executing instance of a program when loaded to main memory.</p>
<p>즉, 프로그램이 main memory로 load 되었을 때의 실행중인 특정 instance라고 할수있다.</p>
<p>교수님께선 한글(hwp)나 워드도 프로세스의 예로 볼 수 있다고 하셨다. 프로세스는 몇 가지 구성사항을 가지고 있다.</p>
<p><em>프로세스는 각자의 메모리공간을 가진다.</em></p>
<p><img src="https://gabrieletolomei.files.wordpress.com/2013/10/program_in_memory2.png?w=960" alt="출처: gabrieletolomei.wordpress.com">
따라서 다른 프로세스의 메모리 공간에 접근할 수 없다. 따라서 한 프로세스가 다른 프로세스의 결과값을 사용해야할 일이 있다던가 할때 IPC라는 inter process communication, 프로세스간 통신 절차가 필요하다는 얘기이다.</p>
<p>-&gt; 프로세스의 단점.(Context Switching 다수 발생. 프로세스 간 통신이 힘들다)</p>
<ul>
<li>process의 메모리 구조</li>
</ul>
<p><img src="https://elgaabeb.files.wordpress.com/2011/01/process_memory_organization.png?w=598&amp;h=464" alt=""></p>
<h1 id="span-stylecolor003366font-sizeem그-단점을-해결하는-threadspan"><span style="color:#003366;font-size:em;">그 단점을 해결하는 Thread</span></h1>
<p><img src="http://1.bp.blogspot.com/-IuOPNytNwqc/VMVK_OX4raI/AAAAAAAAACc/ZoDkKILClvk/s1600/2000px-Multithreaded_process.svg.png" alt="출처: wikipedia"></p>
<p>Thread는 실타래라는 뜻을 가지고 있듯이, 한 프로그램 내의 실행 흐름이다. 위 그림과 같이 한 프로그램 내의 여러개의 쓰레드를 가지는 것이 Multi-Thread이다.</p>
<p>실행흐름이 여러개이므로 Thread 단위 Scheduling 시에도 이점을 가진다.
<img src="http://2.bp.blogspot.com/-3AB4sE53Dfw/VMVNdWa_V0I/AAAAAAAAACo/UAGFO7f6_UA/s1600/euva3a00.p54z.gif" alt="출처: ibm"></p>
<p>또한, 위 그림과 같이 각 Thread는 각각의 register를 가지지만, 다른 Thread들과 Heap, Code, Data를 공유한다. 즉, stack을 제외한 메모리 부분을 공유한다.</p>
<p><span style="color:green"> - stack: 지역변수 할당과 함수 호출 시 전달되는 인자값들의 저장하기 위한 공간</span><br />
<span style="color:green"> - heap: C의 malloc, calloc과 C++의 new를 통한 동적 할당을 위해 존재하는 공간</span><br />
<span style="color:green"> - data: 전역변수나 static 변수의 할당을 위해 존재하는 공간</span><br />
<span style="color:green"> - code(text): 프로그램을 실행시키면 실행파일 내에 존재하는 명령어가 메모리 상에 올라가야지 프로그램을 동작시킬 수 있을 것이다. 이 명령어들을 위해 존재하는 공간.</span></p>
<p>출처: <a href="http://mooneegee.blogspot.kr/2015/01/os-process.html">http://mooneegee.blogspot.kr/2015/01/os-process.html</a></p>
<p>code를 공유하기 때문에 프로세스가 가지는 함수를 자유롭게 사용할 수 있고, heap, data를 공유하기 때문에 IPC없이 thread간 통신이 가능하다.</p>
<p>동일한 프로세스 내에 존재하는 여러 개의 쓰레드는 heap영역에 변수를 메모리 공간을 (동적)할당하여 통신을 하면 된다. 물론 쓰레드 단위 스케줄링에서 프로세스와 같이 컨텍스트 스위칭이 일어날 수 있지만,</p>
<p>메모리공간을 공유하기 때문에 그 오버 헤드(overhead)가 더 작다.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-640c73fbb61f54301574f65a3fedf835">Bot framework seminar 준비</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2016-11-06" class="text-muted">2016.11.06</time>
        
	</div>
	<p>Bot framework 문서를 번역하면서 공부를 시작한다.</p>
<p>자세한 설명은
<a href="https://docs.botframework.com">마이크로 소프트 docs</a>에 나와있으니 참고하시길.</p>
<h2 id="bot-framework-overview">Bot Framework Overview</h2>
<p><em>MS 봇 프레임워크는 유저들이 대화 경험을 즐길수 있도록 높은 품질의 봇들을 만들고 deploy할 수 있도록 하는 framework이다.</em></p>
<p>봇을 사용하는 개발자들은 같은 문제를 직면한다: 봇들은 기본적인 i/o를 필요로한다.</p>
<p>그들은 언어와 대화 스킬을 가져야 한다. 그들은 최적의 속도를 가져야하고, Responsive해야하며 확장가능해야한다. 그들은 user들과 연결되어야한다 - 이상적으로 user의 어떤 대화 경험이나 언어에. Bot Framework는 당신의 user들이 얘기하고 있는 어디에나 - 스카이프, slack, Facebook Messanger, Kik, Office 365 mail에 문자한다던가 - 자연스럽게 interact하는 똑똑한 봇들을 publish, 관리,연결 하는데 필요한 정확한 그것을 제공한다.</p>
<p>Bot framework는 Bot Builder SDK와 관리 Portal, Bot Directory로 이루어 진다.</p>
<h1 id="bot-builder-sdk">Bot Builder SDK</h1>
<p><img src="https://docs.botframework.com/en-us/images/faq-overview/bot_builder_sdk_july.png" alt="">
Bot Builder SDK는 Node-js, .NET, Rest-API 기반 봇에서 대화를 만들기에 필요한 모든 것을 제공하는, (깃허브에 의해서 호스팅된) 오픈 소스이다.</p>
<h1 id="bot-framework-developer-portal">Bot Framework Developer Portal</h1>
<p><img src="https://docs.botframework.com/en-us/images/faq-overview/developer_portal_july.png" alt=""></p>
<p>봇 프레임워크 개발자 포털은 당신의 bot들을 Skype등 유명 서비스에 연결될 수 있도록 한다. 간단히 당신의 봇을 등록하고, 희망되는 채널을 확인하고 봇 directory를 publish한다. 등록된 모든 봇들은 자동 확인된다.</p>
<h1 id="bot-directory-개발중---다른-사람들이-개발한-봇을-사용해볼-수-있고-내가-개발한-봇을-평가받을-수-있는-장소">Bot Directory (개발중) - 다른 사람들이 개발한 봇을 사용해볼 수 있고, 내가 개발한 봇을 평가받을 수 있는 장소.</h1>
<p><img src="https://docs.botframework.com/en-us/images/faq-overview/bot_directory_july.png" alt="">
봇 Directory는 개발자 포털을 통해 등록된 봇들의 Public Directory이다. 사용자들은 봇 directory에서 그들의 선호하는 대화경험에 봇을 발견하고, 시도하고 더할 수 있을 것이다. 처음엔, Microsoft Build 2016에서 발표된 bot framework의 봇들을 게시할 것이다.</p>
<h1 id="왜-bot을-사용해야하는가">왜 Bot을 사용해야하는가?</h1>
<p>대화형 User 인터페이스 시대가 도달했다. (CUI)</p>
<p>skype나 Facebook Messenger같은 다양한 대화 채널안에서 쏟아지는 채팅 봇들이 우리를 위해 무언가를 하도록 제안하고 있다. 이런 경험의 우선적인 interface는 email, 문자, 카드, 버튼, 음성이다. 대화형 ui는 택시를 잡고, 전자 bill을 지불하고, 친구한테 돈을 보낼 수 있게까지 해준다. Siri, Google Now, Cortana는 GUI보다 CUI가 우선적이거나, 보충할 수 있는 모바일 기기에서 특히 매일 수백만의 사람들에게 가치를 증명한다.</p>
<p>Bot과 대화형 비서(Agent)들은 빠르게 어떤 사람의 디지털 경험의 중요한 부분이 되고 있다. 유저들이 서비스/application과 소통하는데에서 웹사이트나 모바일 서비스만큼 필수적이 되고 있다.</p>
<p>Bot 프레임워크는 봇 인터페이스와 새로운 서비스를 시작하고 싶은 개발자들을 타겟으로 하고 있다.</p>
<p>Bot Framework를 이용함으로써, 당신은,</p>
<p>skype, Web 채널 자동확인,
web chat 제어를 심을 수 있고,
Bot Framework Emulator(on/offline)을 포함한 디버깅 도구,
당신의 봇을 채널 responsive하게 만들 수 있는 자동 카드 표준화,
봇을 당신의 앱에 host하는데 쓸 수 있는 Direct Line API,
언어 이해, 30개가 넘는 언어를 자동 번역을 제공하는 LUIS와 같은 cognitive service나, reflection 제공하는 formflow를 활용하여 당신의 봇을 더 똑똑하게 만드는 강력한 확장기능,</p>
<p>을 할 수 있다.</p>
<h1 id="microsoft가-bot-framework를-개발하는-이유">Microsoft가 bot framework를 개발하는 이유</h1>
<p>결국 플랫폼사업때문이겠지만,
“cui가 우리에게 있다”.라는 측면에서 이런 새로운 대화형 경험을 구축하는데 필요한 도구나 전문성을 가진 개발자는 드물다. 우리는 개발자들이 봇을 만들고 user에게 연결하는것을 쉽게 하기 위하여 bot framework을 만들었다.</p>
<p>cui에 관해 짧게 번역해봤다</p>
<p>1980년대에 애플이나 MS에 의해 개발된 GUI는 오늘날 대부분의 유저들이 친숙한 UI이다. 이전의 컴퓨터들은 text기반이었고 기계와의 우선적인 소통이 흑백 화면에 명령어를 타이핑하는 암호화, 고도의 코드화된 소통이었다. GUI의 등장은 컴퓨팅을 훨씬 직관적이고, 친숙하게, 또 접근이 쉽게 만들었고 우리의 모든 개인 기기의 표준이 되었다.</p>
<p>하지만 GUI가 단점이 없는 건 아니었다. 형편없이 디자인 된 웹사이트나 모바일 어플리케이션은 2분만에 끝날 수 있는 저녁 식사 예약을 20분 동안 싸매게 만들기도 하였다. 이제 가능한 대안을 생각해보자.</p>
<p>이제 우리는, 가끔은, 컴퓨터와 대화를 하는것이 우리가 tap하고 swipe하고 click을 하는 것보다 훨씬 효율적이라는 것을 알수있다. 이때 CUI의 개념이 등장한다. CUI의 가장 매력적인 특징은 대화가 가능하다는 것이다. 물론 현재는 그 통신이 사람과 사람에 한정지어져 있지만, 인공지능은 천천히 등장할 것이다. Siri는 좋은 시작이다. 하지만 아직 우리는 그녀에게 ‘말’하는 것이지, ‘대화’하는 것이다. 하지만 Siri는 분명히 우리에게 AI(인공지능)의 미래가 꽤 밝을 것이며 인공지능 기반의 Interface, CUI의 시대가 도래할 것임을 보여준다. CUI는 분명, 인간을 위한 디자인이다.</p>
<h1 id="끝으로-bot-framework를-시작하는-방법">끝으로, Bot framework를 시작하는 방법.</h1>
<ol>
<li><a href="https://dev.botframework.com/">공식 홈페이지</a>에 접속하면 각종 정보를 얻을 수 있다.<br /></li>
<li>Developer portal에 봇을 등록하기 위해서, microsoft 계정이 필요하다.<br /></li>
<li>Tech 에 따라서 Get started 페이지가 존재한다.<br />
<a href="https://docs.botframework.com/en-us/node/builder/overview/">Node.js</a><br />
<a href="https://docs.botframework.com/en-us/csharp/builder/sdkreference/">.Net</a><br />
<a href="https://docs.botframework.com/en-us/csharp/builder/sdkreference/gettingstarted.html">RestAPI</a></li>
</ol>
<p>참고&ndash;</p>
<p>MS 김영욱 부장님 블로그<br />
<a href="http://blog.naver.com/PostView.nhn?blogId=warit&amp;logNo=220833049518&amp;parentCategoryNo=&amp;categoryNo=&amp;viewDate=&amp;isShowPopularPosts=false&amp;from=postView">Microsoft Bot Framework 시작해보기</a></p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-ebaf3a080d7f4cc05da6b2d18f86beda">Cryptography 중간고사</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2016-10-21" class="text-muted">2016.10.21</time>
        
	</div>
	<p>필기와 자료를 올려본다.</p>
<p>이번 중간에는 기본적인 개념(ex/ two basic building block method)과 연습문제(주로 ppt에 나와있던, ex)GF(1750))들이 나왔다.</p>
<p>대부분 계산이 매우 복잡한 문제였고, 다음 시험부터는 ppt 문제들 답을 어느정도 외워가야겠다는 생각이 들었다. 계속 보면서 친숙해지던지.</p>
<p>일단 이번 시험은 마지막 단원을 못봐서&hellip;너무 아쉬웠다. 다음엔 더 잘 봐야될 필요성이 생겼다. 다음엔 진짜 미리 공부해야지..!</p>
<p>이번 중간고사는 Symmetric Cipher였다.</p>
<h1 id="ch2">CH2</h1>
<p>(다양한 암호화 기법, ceaser부터 playfair(쌍), monoalphabetic, polyalphabetic, autokey, vinegere 등 improved 된 암호기법들이 설명되어있다.)</p>
<p><img src="https://s3.ap-northeast-2.amazonaws.com/matilda38.github.io/crypt/1.png" alt="">
<img src="https://s3.ap-northeast-2.amazonaws.com/matilda38.github.io/crypt/2.png" alt="">
<img src="https://s3.ap-northeast-2.amazonaws.com/matilda38.github.io/crypt/3.png" alt="">
<img src="https://s3.ap-northeast-2.amazonaws.com/matilda38.github.io/crypt/4.png" alt=""></p>
<h1 id="ch3">CH3</h1>
<p>(DES 기법, Fiestal 구조와 상세한 round 에 대한 설명이 있다)
(plaintext가 substitution, Permutation, Key와 XOR 연산 등을 거쳐 ciphertext가 되는 과정)</p>
<p><img src="https://s3.ap-northeast-2.amazonaws.com/matilda38.github.io/crypt/9.png" alt="">
<img src="https://s3.ap-northeast-2.amazonaws.com/matilda38.github.io/crypt/10.png" alt="">
<img src="https://s3.ap-northeast-2.amazonaws.com/matilda38.github.io/crypt/11.png" alt=""></p>
<h1 id="ch4">CH4</h1>
<p>(Mod 즉 나머지 연산을 먼저 소개하고 이어 GCD, modular Arthimetic에 관한 설명. (A+B)mod N= ((A mod N) + (B mod N)) mod N, A와 B의 합동이란 무엇인가,
Finite set 등의 개념을 소개하면서 갈루아 필드, AES에 필요한 내용(GF(2^8)들을 기본적으로 가르친다.)</p>
<p><img src="https://s3.ap-northeast-2.amazonaws.com/matilda38.github.io/crypt/5.png" alt="">
<img src="https://s3.ap-northeast-2.amazonaws.com/matilda38.github.io/crypt/6.png" alt="">
<img src="https://s3.ap-northeast-2.amazonaws.com/matilda38.github.io/crypt/7.png" alt="">
<img src="https://s3.ap-northeast-2.amazonaws.com/matilda38.github.io/crypt/8.png" alt=""></p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-40cb554d6b3357edb4108d23d7e0fe08">배열 기초.</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2016-10-09" class="text-muted">2016.10.09</time>
        
	</div>
	<p>알고리즘을 공부하다보면 부끄러워지는 순간이 한두번이 아니다. 아직까지 이것도 몰랐다니, 또한 어떻게 이런 기본을 까먹을 수 있다니, 등?</p>
<p>오늘의 부끄러움은, 2차원 배열의 저장이다.</p>
<p>c언어에서 2차원 배열을 저장할 때,</p>
<ol>
<li>행/ 열 구분.</li>
</ol>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#000">int</span> <span style="color:#000">arr</span><span style="color:#ce5c00;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">][</span><span style="color:#000">j</span><span style="color:#ce5c00;font-weight:bold">]=</span> <span style="color:#ce5c00;font-weight:bold">~</span> <span style="color:#4e9a06">//</span><span style="color:#a40000">초기화</span>
</code></pre></div><p>당연히 행이 세로이고 열이 가로이므로. (x, y로 표현하자면 y가 행 x가 열)
<img src="https://s3.ap-northeast-2.amazonaws.com/matilda38.github.io/screen1.png" alt="n차원 행렬 예시">
이런 식으로 행렬이 생성되겠죠? 그런데 거꾸로 알고 있었어요. 진짜 미쳤나봄 ㅠㅠㅠ 부끄럽다.</p>
<ol start="2">
<li>주소값 저장.</li>
</ol>
<p>Transpose 즉 전치 행렬 만드는 기본 코드 쓰다가 깨달은 사실
{% highlight c %}
int arr[2][3]={ {1,2,3},{4,5,6} }; //2행 3열 행렬이 생기겠죠?
int *ptr=arr;//arr의 주소를 저장합니다.
for(i=0;i&lt;6;i++)
printf(&quot;%d&quot;,<em>ptr++); //요건 가능.
for(i=0;i&lt;6;i++)
printf(&quot;%d&quot;,</em>(arr+i)); //요건 절대루 안됩니다.</p>
<pre><code>이유를 생각해볼까요?

사실 당연해요. 2차원 배열 같은 경우에는
![다차원배열 주소값](https://s3.ap-northeast-2.amazonaws.com/matilda38.github.io/screen3.png)
이런식으로 저장되기 때문에 arr[i]같은 경우에는 해당 행의 시작주소를 저장하는 것이죠.

arr[i]=&amp;arr[i][0]
*(arr[i])==arr[i][0]
가 되는 거죠.

```ruby

</code></pre><p>반성&hellip;!</p>
<p>블로그 검색 시스템은 언제쯤 만들수 있을까&hellip;.허허</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-a88507ef951a0d6a883594407fd054cf">Malloc, pointer.</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2016-09-26" class="text-muted">2016.09.26</time>
        
	</div>
	<ol>
<li>문자열 상수는 수정불가능한 char형 배열이다.<br /></li>
<li>배열은 그 자신의 첫번째 원소를 가리키는 포인터 주소값으로 자동 변환된다.</li>
</ol>
<p>char *str;<br />
str = &ldquo;abcd&rdquo;;
위 코드는 &ldquo;abcd&quot;라는 문자열 상수의 첫번째 문자인 a가 저장되있는 주소로 str를 초기화하게 된다.</p>
<p>//문제가 발생하는 코드:
char *str = &ldquo;abcd&rdquo;;
str[1] = &lsquo;b&rsquo;;
str은 a의 주소값을 저장하고 있다.(즉, 문자열 상수를 가르킨다). 그런데 문자열 상수 수정을 시도하고 있기때문에 에러가 나는것이다.</p>
<p>//수정이 가능한 문자열 선언:
char str[] = &ldquo;abcd&rdquo;;<br />
str[1] = &lsquo;b&rsquo;;
이 코드에서는 크기 5의 char형 <strong>배열 str을 만들어서</strong>, 그 안에 &lsquo;a&rsquo;, &lsquo;b&rsquo;, &lsquo;c&rsquo;, &rsquo;d', &lsquo;\0&rsquo; 이라는 내용을 저장하게 됩니다.</p>
<p>코드 1에서 문제가 생기는 이유는, C에서는 문자열 상수가 수정이 불가능하기 때문이고, 코드 2에서 문제가 생기지 않는 이유는, char형 배열은 수정이 가능하기 때문입니다. <strong>str[1]이 가리키는 공간의 성격에 대해 유의할 필요가 있습니다.</strong></p>
<p>해당 공간이 문자열 상수인지, 배열인지!</p>
<p>메모리 할당 malloc</p>
<p>c 언어에서 프로그램 작성시 포인터를 사용해야할 일이 많았다. 이번 네트워크 과제에서도 header를 가르키는 포인터가 필요했다. 예를 들어,
{%highlight c%}
struct header* header_p;
header_p-&gt;flag = FLAG_HELLO;
// 이렇게 포인터를 선언만 해주고 바로 사용하려 했다.
// 이러면 에러난다!</p>
<pre><code>
사실 생각해보면 당연하다. 포인터를 선언해주었는데 초기화를 하지않았으므로 **쓰레기값**이 들어갈테고, 참조할 수 없는 포인터가 될것이다. 참조할 수 없는 포인터의 구조체 변수 flag 값을 대입하라니, segmentation fault가 발생한다.
이때는 *malloc으로 포인터에 주소값을 할당해주는 방법으로 해결할 수 있다*.

{%highlight c%}
struct header* header_p= (struct header*)malloc(sizeof(struct header));
</code></pre><p>지긋 지긋했던 segmentation fault 해결!</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-e57b257f7c45bd00a07bdb80deb758ff">network.</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2016-09-22" class="text-muted">2016.09.22</time>
        
	</div>
	<p>네트워크 수업 정리</p>
<p>네트워크의 기본 구성.</p>
<ol>
<li>
<p>Node
정보를 저장하고 처리.
통신(communication)에 참여하는 개체.</p>
</li>
<li>
<p>Link
node를 연결하는 물리적인 매개체.
node들이 연결되어 있는 방식은 topology라고 한다.</p>
</li>
</ol>
<h1 id="네트워크의-중요한-부분은-자원을-어떻게-공유하는가이다">네트워크의 중요한 부분은 자원을 어떻게 공유하는가이다.</h1>
<p>두 가지의 concept 가 존재하는데, 1. switching 2. Multiplexing 이다.</p>
<h2 id="switching은"><strong>switching</strong>은</h2>
<p>router나 switch같은 장비를 활용하여 노드들을 연결하는 것이다.
!(image)[/asset/pic1.png]
위와 같이 direct하게 연결하는 경우에는 O(N2)의 link가 필요하기 때문에 비용이 크다. 따라서 switch를 통해 연결해주자는 것이다.</p>
<p>switching에는 두 가지 방법이 존재하는데,</p>
<ol>
<li>Circuit Switching</li>
<li>Packet Swiching
이다.</li>
</ol>
<p>각각 장단점이 존재한다.</p>
<p>WHAT’S NEXT: CLOUD COMPUTING</p>
<p>of players. In this case, we have the computing industry,
which has become increasingly involved in integrating
computation and communication; the telephone and
cable operators, which recognize the market for carrying
all sorts of data, not just voice and television; and, perhaps
most importantly, the many entrepreneurs creating
new Internet-based applications and services such
as voice over IP (VOIP), online games, virtual worlds,
search services, content hosting, electronic commerce,
and so on. It’s noteworthy that one of today’s
biggest names in “cloud computing,” Amazon.com,
achieved that position by first adopting Internet technologies
to sell consumer products such as books and
then making their computing infrastructure available to
others as a service over the network.
A few years ago, a reasonable goal for networking might
have been to provide network access to every home, but in
developed countries at least that process is now far along. Ubiquitous
networking now includes getting access from anywhere,
including on planes and trains, and on an increasingly wide range
of devices. Whereas the Internet largely evolved in an era of fixed mainframe
and then personal computers, today the set of devices to be connected
together includes mobile phones and even smaller devices such as
sensors (which might also be mobile). Thus, it seems clear that the Internet will
have to continue to scale to support several orders of magnitude more devices than
today and that many of these devices will be mobile, perhaps intermittently connected
over wireless links of highly variable quality. At the same time, these devices
will be connected to large data centers—filled with tens of thousands of processors
and many petabytes of storage—that will store and analyze the data being generated,
all with the hope of enabling even more powerful applications that help us
navigate our daily lives. And, the devices that we carry are often just a means of
accessing “the cloud”—the amorphous set of machines that store and process our
documents, photos, data, social networks, etc., which we expect to be able to access
from anywhere.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-e3b676f3fd164fd797f4199237fd6a5e">데이터 마이닝.</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2016-09-15" class="text-muted">2016.09.15</time>
        
	</div>
	<p>ML methods.</p>
<p>Basic.</p>
<ol>
<li></li>
</ol>
<p>Numeric attributes(continuous): 실수 또는 정수값을 가진다 ex) 1.74
Nominal attributes(finite): 유한한 집합중 하나의 값을 가지며 categorical 이라고도 한다. Ex) True, false.
2.
Arff 형식: Dataset을 표현하는 standard 방식. 독립적이고 순서가 없는 instance들로 이루어져있고 instance들사이의 관계는 포함하지 않는다.
{%highlight ruby%}</p>
<h1 id="weather에-관한-데이터들임을-표시">weather에 관한 데이터들임을 표시.</h1>
<p>@relation weather</p>
<h1 id="3개의-attribute속성를-가진다-각각-nominal-numeric-value를-가진다-앞-두개의-attribute로-세번째-attribute-play를-predict해야한다">3개의 attribute(속성)를 가진다. 각각 nominal, numeric value를 가진다. 앞 두개의 attribute로 세번째 attribute play?를 predict해야한다.</h1>
<p>@attribute outlook { sunny, overcast, rainy }
@attribute humidity numeric
@attribute play? { yes, no }</p>
<p>@data
%
% 3 instances
%
sunny, 85, no
rainy, 80, no
overcast, 83, yes
{%endhighlight%}</p>
<p>Supervised Learning(지도학습)
예시들의 집합 기반으로 예측을 한다. 이제까지의 주식 가격으로 미래 가격을 예측하는데 쓰이는 것과 같다. 훈련을 하는 데 쓰인 각 예시는 이율값으로 label되어있다. 지도 학습 알고리즘은 그런 값 label들에서 pattern을 찾는다. 관련있는 어떤 정보도 사용할 수 있고 각각의 알고리즘은 다른 타입의 패턴을 찾는다. 알고리즘이 최고의 패턴을 찾은 후에, 라벨되지않은 테스팅 데이터를 예측하는데 그 패턴을 사용한다.</p>
<h1 id="1-classification">1. Classification</h1>
<p>데이터들을 category를 예측하는데 사용하는 경우 Classification이라고 한다.</p>
<h1 id="2-regression">2. Regression</h1>
<p>어떤 값(예. 주식 가격)을 예측하는 경우 Regression</p>
<h1 id="3-clustering">3. Clustering</h1>
<p>객체들을 비슷한 집합끼리 묶는것.</p>
<h1 id="4-association">4. Association</h1>
<p>변수들간의 연관성을 찾는것.</p>
<h1 id="5-numeral-prediction">5. Numeral Prediction</h1>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-d4e8f360d6380d22478fbd57b158efc9">2016-2</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2016-09-05" class="text-muted">2016.09.05</time>
        
	</div>
	<p>상반기 끝!</p>
<h1 id="1-멋사-4기-활동-종료">1. 멋사 4기 활동 종료</h1>
<p>드디어, 지난해 12월부터 운영진 활동을 시작했는데&hellip;(사실상 2월부터 했다고 해야 맞지만). 6개월이 넘는 시간동안 해왔던 멋쟁이사자처럼 운영진 활동도 끝이 났다. 멋사 회원으로서는 8월 시작했으니 꼬박 1년을 해온 셈이다. 그동안 멋사는 훨씬 더 크게 성장했고, 회원으로서는 끝났지만 항상 응원할 것이다..! 코딩교육은 정말 필요한 거라고 생각하기도 하고 그 플랫폼으로서 멋사 만한 단체는 없다고 생각하기 때문이다. 멋사 최고~ 두희 대장 최고~.</p>
<h1 id="2-microsoft-student-partner">2. Microsoft Student Partner</h1>
<p>3학년이 되어 취업 생각을 정말 많이 하게 되는데, 정말 들어가고 싶은 기업중 하나인 Microsoft의 대외활동을 지원했다. 엄청나게 바쁜 활동은 아닌듯 하지만, 벌써부터 기대가 된다. 많이 배우고 성장하고 싶다! 사실 Microsoft 인턴도 너무 하고싶다..! 꼭 활동 우수자가 되어야겠다.</p>
<h1 id="3-4개-전공--졸업-프로젝트--아잉-시간표-확정">3. 4개 전공 + 졸업 프로젝트 + 아잉. 시간표 확정.</h1>
<p>전공은 4개만 듣기로 하고, 졸업프로젝트를 진행하기로 했다. 정보 보호, 프로세서 구조, 컴퓨터 네트워크, 기계학습. 그리고&hellip;신소재(New Material) 공학과 학생들과 아잉을 듣는다. 총 17학점, 무리하지 않기로 했다. 과외도 3개나 하니까, 물론 홍석이는 금방 그만둬야되지 않을까 싶다.</p>
<p><strong>이번 학기 목표</strong></p>
<h1 id="1-posehanxing-완성-및-ajax-기능-삽입된-rails-sample-application-제작github">1. Posehanxing 완성 및 ajax 기능 삽입된 Rails Sample Application 제작.(Github)</h1>
<h1 id="2-udacity-강의-들어보기-ios-github등-이-외-여러-mooc-체험-및-인증서-취득">2. Udacity 강의 들어보기 (IOS, Github등). 이 외 여러 MOOC 체험 및 인증서 취득.</h1>
<p>지금 생각하고 있는거는 flearning의 IOS 수업. IOS9 책도 샀으니 같이 해봐야지. 이 외에 유명대학 수업도 들어보고 싶다!</p>
<h1 id="3-전공-열심히-듣기">3. 전공 열심히 듣기.</h1>
<p>이번 학기에는 기계학습, 정보보호, 졸업프로젝트 1, 컴퓨터 네트워크, 프로세서 구조 5개를 듣는다. 15학점만 듣는셈. 정보 검색은 고민하다가 금공강을 위해 포기. 15학점만 듣는 만큼, MSP 활동이나 프로젝트, 영어 시험등 여러가지를 해보고 싶다.</p>
<h1 id="4-알고리즘-스터디">4. 알고리즘 스터디</h1>
<p>코딩테스트를 대비하여 알고리즘 공부를 하고 싶다. C언어로 생각중이다. 윤성우 자료구조도 샀다!</p>
<hr>
<p>추석까지의 진행상황. (2016.9.15)</p>
<blockquote>
<p>눈깜짝하니까 벌써 추석연휴다. 무서울 정도로 시간이 빨리 갔다. 일단, 채용박람회를 다녀왔었고 많이 느꼈다. <br /> 고영테크놀로지, 삼성에스원, 삼성 CE/IM 부서(특히 기업탐방 프로그램), 현대자동차가 인상적이었다. <br /> 블루투스 스피커를 받은 스마일게이트도 좋았다. 음질이 진짜 좋다! <br />취업에 대한 자신감이 생기면서도 부담감이 생기기 시작했다. MSP에서도 많은 실력자들을 만났고, 전공공부도 좀처럼 잘 잡히지 않는 지금 스트레스를 많이 받게되는 듯하다. 약속들도 엄청 많아서 늦게 집에 들어가야할 때도 많았다. <br /> 이럴 때일수록 힘을 내고 열심히 살아야겠다! 운동도 열심히 하고! 과도에서 열심히 공부도 합시다! 나 화이팅ㅋㅋㅋ</p>
</blockquote>
<hr>
<p>2017년이 되어! 결과를 쓰자면!</p>
<h1 id="span-stylecolor0033661-학점-망함span"><span style="color:#003366">1. 학점 망함</span></h1>
<h1 id="span-stylecolor0033662-udacity는-개뿔span"><span style="color:#003366">2. Udacity는 개뿔!</span></h1>
<h1 id="span-stylecolor0033663-알고리즘은-개뿔span"><span style="color:#003366">3. 알고리즘은 개뿔!</span></h1>
<p>그리고 항상 옛날 글은 오그라든다. 손발이 움찔움찔</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-08341d4a57e8bf9935f8b9fcf718a5f6">ABOUT DOCKER</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2016-08-26" class="text-muted">2016.08.26</time>
        
	</div>
	<p>Docker 자료.</p>
<p><a href="http://blog.nacyot.com/articles/2014-01-27-easy-deploy-with-docker/">Docker란 무엇인가?</a>
<a href="https://www.slideshare.net/pyrasis/docker-docker-38286477">Docker란 무엇인가? : Docker 기본 사용법</a></p>
<p>기존의 가상머신 방식이 아니라, 리눅스의 container 방식을 이용한 신개념 가상화 방식이다.</p>
<p><a href="http://www.pyrasis.com/docker.html">가장 빨리 만나는 Docker</a></p>
<p>2014년 책이기는 하지만, 나름 최신 책이 한글로 나와있고, 이 책이 거의 유일하다 싶이 하다. 책 내용을 모두 공개해 놓아서 공부하기 편하다.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-1c3a2ec27dc7485b69471ae91c627dcb">ABOUT WEB SERVER</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2016-08-25" class="text-muted">2016.08.25</time>
        
	</div>
	<p>The word &ldquo;deployment&rdquo; can have two meanings depending on the context. You are also confusing the roles of Apache/Nginx with the roles of other components.</p>
<p>Historic note: This article was originally written on November 6, 2010, when the Ruby app server ecosystem was limited. I&rsquo;ve updated this article on March 15 2013 with all the latest updates in the ecosystem.</p>
<p>Disclaimer: I am one of the authors of Phusion Passenger, one of the app servers.</p>
<p>Apache vs Nginx
일단 아파치와 nginx는 둘 다 HTTP 요청을 받고 HTTP response를 줄 수 있는 reverse proxy로서 기능을 할 수 있는 웹서버라는 점이 공통점입니다. PHP로 웹 데이터베이스 어플리케이션 실습할때 apache를 썼던 기억이 납니다. 또 다른 공통점은 둘 다 루비 앱을 직접 host할 수 없다는 점입니다(정적 웹사이트는 당연히 가능, 동적 웹사이트의 경우 PHP는 가능). 둘 다 별도의 툴이 필요하다는 거죠. 둘의 차이점은 nginx가 좀 더 가볍다는 점입니다. 제공되는 기능이 좀 더 적습니다.</p>
<p>Mongrel and other production app servers vs WEBrick
Mongrel은 application server입니다. 루비 application을 load할 수 있는 또 다른 application인 셈입니다.</p>
<p>Loads your Ruby app inside its own process space.
Sets up a TCP socket, allowing it to communicate with the outside world (e.g. the Internet). Mongrel listens for HTTP requests on this socket and passes the request data to the Ruby web app.
The Ruby web app then returns an object, which describes what the HTTP response should look like, and Mongrel takes care of converting it to an actual HTTP response (the actual bytes) and sends it back over the socket.
However Mongrel is quite dated, nowadays it is no longer maintained. Newer alternative application servers are:</p>
<p>Phusion Passenger
Unicorn
Thin
Puma
Trinidad (JRuby only)
TorqueBox (JRuby only)
I&rsquo;ll cover them later and describe how they differ from each other and from Mongrel.</p>
<p>WEBrick does the same thing as Mongrel, but the differences are:</p>
<p>WEBrick is not fit for production, unlike everything else that I mentioned before. WEBrick is written entirely in Ruby. Mongrel (and most other Ruby app servers) is part Ruby and part C (Mostly Ruby), but its HTTP parser is written in C for performance.
WEBrick is slower and less robust. It has some known memory leaks and some known HTTP parsing problems.
WEBrick is usually only used as the default server during development because WEBrick is included in Ruby by default. Mongrel and other app servers needs to be installed separately. It&rsquo;s not recommended to use WEBrick in production environments, though for some reason Heroku chose WEBrick as its default server. They were using Thin before, so I have no idea why they switched to WEBrick.
The app server and the world</p>
<p>All current Ruby app servers speak HTTP, however some app servers may be directly exposed to the Internet on port 80, while others may not.</p>
<p>App servers that can be directly exposed to the Internet: Phusion Passenger, Rainbows
App servers that may not be directly exposed to the Internet: Mongrel, Unicorn, Thin, Puma. These app servers must be put behind a reverse proxy web server like Apache and Nginx.
I don&rsquo;t know enough about Trinidad and TorqueBox, so I&rsquo;ve omitted them.
Why must some app servers be put behind a reverse proxy?</p>
<p>Some app servers can only handle 1 request concurrently, per process. If you want to handle 2 requests concurrently you need to run multiple app server instances, each serving the same Ruby app. This set of app server processes is called an app server cluster (hence the name Mongrel Cluster, Thin Cluster, etc). You must then setup Apache or Nginx to reverse proxy to this cluster. Apache/Nginx will take care of distributing requests between the instances in the cluster (More on this in section &ldquo;I/O concurrency models&rdquo;).
The web server can buffer requests and responses, protecting the app server from &ldquo;slow clients&rdquo; - HTTP clients that don&rsquo;t send or accept data very quickly. You don&rsquo;t want your app server to do nothing while waiting for the client to send the full request or to receive the full response, because during that time the app server may not be able to do anything else. Apache and Nginx are very good at doing many things at the same time because they&rsquo;re either multithreaded or evented.
Most app servers can serve static files, but are not particularly good at it. Apache and Nginx can do it faster.
People typically set up Apache/Nginx to serve static files directly, but forward requests that don&rsquo;t correspond with static files to the app server, it&rsquo;s good security practice. Apache and Nginx are very mature and can shield the app server from (perhaps maliciously) corrupted requests.
Why can some app servers be directly exposed to the Internet?</p>
<p>Phusion Passenger is a very different beast from all the other app servers. One of its unique features is that it integrates into the web server.
The Rainbows author publicly stated that it&rsquo;s safe to directly expose it to the Internet. The author is fairly sure that there are no vulnerabilities in the HTTP parser (and similar). Still, the author provides no warranty and says that usage is at own risk.
Application servers compared</p>
<p>In this section I&rsquo;ll compare most application servers I&rsquo;ve mentioned, but not Phusion Passenger. Phusion Passenger is such a different beast from the rest that I&rsquo;ve given it a dedicated section. I&rsquo;ve also omitted Trinidad and TorqueBox because I do not know them well enough, but they&rsquo;re only relevant anyway if you use JRuby.</p>
<p>Mongrel was pretty bare bones. As mentioned earlier, Mongrel is purely single-threaded multi-process, so it is only useful in a cluster. There is no process monitoring: if a process in the cluster crashes (e.g. because of a bug in the app) then it needs to be manually restarted. People tend to use external process monitoring tools such as Monit and God.
Unicorn is a fork of Mongrel. It supports limited process monitoring: if a process crashes it is automatically restarted by the master process. It can make all processes listen on a single shared socket, instead of a separate socket for each process. This simplifies reverse proxy configuration. Like Mongrel, it is purely single-threaded multi-process.
Thin uses the evented I/O model by utilizing the EventMachine library. Other than using the Mongrel HTTP parser, it is not based on Mongrel in any way. Its cluster mode has no process monitoring so you need to monitor crashes etc. There is no Unicorn-like shared socket, so each process listens on its own socket. In theory, Thin&rsquo;s I/O model allows high concurrency, but in most practical situations that Thin is used for, one Thin process can only handle 1 concurrent request, so you still need a cluster. More about this peculiar property in section &ldquo;I/O concurrency models&rdquo;.
Puma was also forked from Mongrel, but unlike Unicorn, Puma is designed to be purely multi-threaded. There is therefore currently no builtin cluster support. You need to take special care to ensure that you can utilize multiple cores (More about this in section &ldquo;I/O concurrency models&rdquo;).
Rainbows supports multiple concurrency models through the use of different libraries.
Phusion Passenger</p>
<p>Phusion Passenger works very differently from all the other ones. Phusion Passenger integrates directly into Apache or Nginx, and so can be compared to mod_php for Apache. Just like mod_php allows Apache to serve PHP apps, almost magically, Phusion Passenger allows Apache (and also Nginx!) to serve Ruby apps, almost magically. Phusion Passenger&rsquo;s goal is to make everything Just Work(tm) with as little hassle as possible.</p>
<p>Instead of starting a process or cluster for your app, and configuring Apache/Nginx to serve static files and/or reverse proxying requests to the process/cluster with Phusion Passenger you only need to:</p>
<p>You edit the web server config file and specify the location of your Ruby app&rsquo;s &lsquo;public&rsquo; directory.
There is no step 2.
All configuration is done within the web server config file. Phusion Passenger automates pretty much everything. There is no need to start a cluster and manage processes. Starting/stopping processes, restarting them when they crash, etc. - all automated. Compared to other app servers, Phusion Passenger has far fewer moving parts. This ease of use is one of the primary reasons why people use Phusion Passenger.</p>
<p>Also unlike other app servers, Phusion Passenger is primarily written in C++, making it very fast.</p>
<p>There&rsquo;s also an Enterprise variant of Phusion Passenger with even more features, such as automated rolling restarts, multithreading support, deployment error resistance, etc.</p>
<p>For the above reasons, Phusion Passenger is currently the most popular Ruby app server, powering over 150,000 websites, including large ones such as New York Times, Pixar, Airbnb, etc.</p>
<p>Phusion Passenger vs other app servers</p>
<p>Phusion Passenger provides a lot more features and provides many advantages over other app servers, such as:</p>
<p>Dynamically adjusting the number of processes based on traffic. We run a ton of Rails apps on our resource-constrainted server that are not public-facing, and that people in our organization only use at most a few times a day. Things like Gitlab, Redmine, etc. Phusion Passenger can spin down those processes when they&rsquo;re not used, and spinning them up when they&rsquo;re used, allowing more resources to be available for more important apps. With other app servers, all your processes are turned on all the time.
Some app servers are not good at certain workloads, by design. For example Unicorn is designed for fast-running requests only: See the Unicorn website section &ldquo;Just Worse in Some Cases&rdquo;.
Workloads that Unicorn is not good at are:</p>
<p>Streaming workloads (e.g. Rails 4 live streaming or Rails 4 template streaming).
Workloads in which the app performs HTTP API calls.
The hybrid I/O model in Phusion Passenger Enterprise 4 or later makes it an excellent choice for these kinds of workloads.</p>
<p>Other app servers require the user to run at least one instance per application. By contrast, Phusion Passenger supports multiple applications in a single instance. This greatly reduces administration overhead.
Automatic user switching, a convenient security feature.
Phusion Passenger supports many MRI Ruby, JRuby and Rubinius. Mongrel, Unicorn and Thin only support MRI. Puma also supports all 3.
Phusion Passenger actually supports more than just Ruby! It also supports Python WSGI, so it can for example also run Django and Flask apps. In fact Phusion Passenger is moving into the direction of becoming a polyglot server. Node.js support on the todo list.
Out-of-band garbage collection. Phusion Passenger can run the Ruby garbage collector outside the normal request/response cycle, potentially reducing request times by hundreds of milliseconds. Unicorn also has a similar feature, but Phusion Passenger&rsquo;s version is more flexible because 1) it&rsquo;s not limited to GC and can be used for arbitrary work. 2) Phusion Passenger&rsquo;s version works well with multithreaded apps, while Unicorn&rsquo;s does not.
Automated rolling restarts. Rolling restarts on Unicorn and other servers require some scripting work. Phusion Passenger Enterprise completely automates this way for you.
There are more features and advantages, but the list is really long. You should refer to the comprehensive Phusion Passenger manual (Apache version, Nginx version) or the Phusion Passenger website for information.</p>
<p>I/O concurrency models</p>
<p>Single-threaded multi-process. This is traditionally the most popular I/O model for Ruby app servers, partially because multithreading support in the Ruby ecosystem was very bad. Each process can handle exactly 1 request at a time. The web server load balances between processes. This model is very robust and there is little chance for the programmer to introduce concurrency bugs. However, its I/O concurrency is extremely limited (limited by the number of processes). This model is very suitable for fast, short-running workloads. It is very unsuitable for slow, long-running blocking I/O workloads, e.g. workloads involving the calling of HTTP APIs.
Purely multi-threaded. Nowadays the Ruby ecosystem has excellent multithreading support, so this I/O model has become very viable. Multithreading allows high I/O concurrency, making it suitable for both short-running and long-running blocking I/O workloads. The programmer is more likely to introduce concurrency bugs, but luckily most web frameworks are designed in such a way that this is still very unlikely. One thing to note however is that the MRI Ruby interpreter cannot leverage multiple CPU cores even when there are multiple threads, due to the use of the Global Interpreter Lock (GIL). You can work around this by using multiple multi-threaded processes, because each process can leverage a CPU core. JRuby and Rubinius have no GIL, so they can fully leverage multiple cores in a single process.
Hybrid multi-threaded multi-process. Primarily implemented by Phusion Passenger Enterprise 4 and later. You can easily switch between single-threaded multi-process, purely multithreaded, or perhaps even multiple processes each with multiple threads. This model gives the best of both worlds.
Evented. This model is completely different from the previously mentioned model. It allows very high I/O concurrency and is therefore excellent for long-running blocking I/O workloads. To utilize it, explicit support from the application and the framework is required. However all the major frameworks like Rails and Sinatra do not support evented code. This is why in practice a Thin process still cannot handle more than 1 request at a time, making it effectively behave the same as the single-threaded multi-process model. There are specialized frameworks that can take advantage of evented I/O, such as Cramp.
An article was recently posted on the Phusion blog about optimally tuning the number of processes and threads given your workload. See Tuning Phusion Passenger&rsquo;s concurrency settings.</p>
<p>Capistrano</p>
<p>Capistrano is something completely different. In all the previous sections, &ldquo;deployment&rdquo; refers to the act of starting your Ruby app in an application server, so that it becomes accessible to visitors, but before that can happen one typically needs to do some preparation work, such as:</p>
<p>Uploading the Ruby app&rsquo;s code and files to the server machine.
Installing libraries that your app depends on.
Setting up or migrating the database.
Starting and stopping any daemons that your app might rely on, such as Sidekiq/Resque workers or whatever.
Any other things that need to be done when you&rsquo;re setting up your application.
In the context of Capistrano, &ldquo;deployment&rdquo; refers to doing all this preparation work. Capistrano is not an application server. Instead, it is a tool for automating all that preparation work. You tell Capistrano where your server is and which commands need to be run every time you deploy a new version of your app, and Capistrano will take care of uploading the Rails app to the server for you and running the commands you specified.</p>
<p>Capistrano is always used in combination with an application server. It does not replace application servers. Vice-versa, application servers do not replace Capistrano, they can be used in combination with Capistrano.</p>
<p>Of course you don&rsquo;t have to use Capistrano. If you prefer to upload your Ruby app with FTP and manually running the same steps of commands every time, then you can do that. Other people got tired of it, so they automate those steps in Capistrano.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-4cab6181dc995c1a5f984e9d326c5868">azure deploy!(Nginx&#43;Passenger)</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2016-08-23" class="text-muted">2016.08.23</time>
        
	</div>
	<h4 id="이-튜토리얼은-nginx와-passenger를-사용하여-rails-application-을-azure에-deploy하는-법을-다루고-있습니다">이 튜토리얼은 Nginx와 Passenger를 사용하여 Rails application 을 Azure에 Deploy하는 법을 다루고 있습니다.</h4>
<p>(Edited in 2017.8.28)</p>
<blockquote>
<p><strong><a href="https://github.com/m-gagne/azure-tutorials/blob/master/tutorial-windows-azure-ruby-on-rails-capistrano-3-postgresql.md">참고 튜토리얼1</a></strong>
단, azure의 예전 포탈의 내용이라는 점 주의하시길. 이걸 보고 저도 azure deploy 한글판 튜토리얼을 작성해야겠다는 생각을 하게 되었습니다. <strong><a href="https://www.phusionpassenger.com/library/walkthroughs/deploy/">Deploying a Ruby app with Passenger to production</a></strong>
passenger 라는 서버 deploy tool의 tutorial이었고 개인적으로 가장 친절하고 도움되는 튜토리얼이었습니다.</p>
</blockquote>
<h2 id="1-일단-ssh-key-만들기-for-원격접속">1. 일단 ssh key 만들기 (for 원격접속)</h2>
<p>SSH 공개키 만들기
<a href="https://en.wikipedia.org/wiki/Secure_Shell">ssh란?</a></p>
<p>:원격 접속. 일반 로그인 프로그램들이 패킷을 전송할 때 평문으로 전달을 하기 때문에 패스워드를 쉽게 가로챌 수 있는 것에 비해 SSH는 패킷 자체를 암호화 하여 전송하기 때문에 원격 관리에 혁명을 일으킨 프로그램입니다.</p>
<p>SSH 서버를 운영하지 않는 서버 관리자는 보안에 전혀 관심이 없다고도 할 수 있습니다. 여기서는 ssh1, ssh2 와 호환이 되는 OpenSSH로 설명을 하며 인증키 방식을 설명하지 안고 패드워드 방식으로 설명을 합니다</p>
<p>참고)
<a href="http://www.jeff.wilcox.name/2013/06/secure-linux-vms-with-ssh-certificates/">공개키를 만드는 과정과 관련된 포스팅</a></p>
<p>저는 <strong>ssh key gen</strong> 기능을 이용했습니다.</p>
<p>터미널에 ssh-keygen 을 입력해주시면 ~/.ssh/id_rsa.pub로 자동 생성됩니다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ssh-keygen -t rsa -b <span style="color:#0000cf;font-weight:bold">2048</span>
</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"></code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"></code></pre></div><h2 id="2-azure-portal-에서-가상컴퓨터-생성">2. azure portal 에서 가상컴퓨터 생성</h2>
<p><img src="https://s3.ap-northeast-2.amazonaws.com/matilda38.github.io/azure1.png" alt="Sample Image"></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cat ~/.ssh/id_rsa.pub
</code></pre></div><p>해서 나온 공개키를 복사하여 붙여넣는다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ssh 유저이름@부여받은공인IP주소
</code></pre></div><p>접속한 vm의 ~/.ssh에 authorized key가 저장되어 있습니다.</p>
<p>아래 사항은 오랜만에 애저 vm을 써본 제가 확인해본바 현재 아래 상황은 발생하지 않습니다. 단순히 ssh만 해도 잘 접속되네요.</p>
<h3 id="deprecated"><em>Deprecated</em></h3>
<p><em>주의점 endpoint 에서 http 생성해야합니다!(port 80). 포털에 끝점 추가 기능을 활용해주세요.
저 같은 경우에는 ssh <a href="mailto:username@dnsname.cloudapp.net">username@dnsname.cloudapp.net</a> -p 22 로 가상컴퓨터에 접속하려 할때 계속 public key denied 에러가 나서..
.pub의 공개키암호 파일을 .pem으로도 바꿔보고 열심히 해봤으나&hellip; 계속 안되던 문제가 azure CLI 설치로 해결되었습니다.(ㅠㅠ)
즉 여기서 key-gen 으로 생성한 제 공개키를 넣고 터미널에 azure CLI를 설치한거죠.</em></p>
<h2 id="3-ssh로-접속-했으면-git등-필요한-패키지-설치">3. ssh로 접속 했으면! Git등 필요한 패키지 설치.</h2>
<p><em>우리는 가상컴퓨터로 linux 컴퓨터에서 작업하고 있다는 사실을 잊으시면 안됩니다~! 내 컴퓨터 아닙니다!^^</em></p>
<p>sudo apt-get 으로 필요한것들 설치. Git libssl, libsqlite3, nodejs, nginx등을 설치한다.</p>
<p><strong>apt-get</strong>이란?
ubuntu같은 리눅스 계열의 패키지 관리 명령어! yum등 다른 패키지 관리자도 있습니다. Mac에서는 homebrew를 쓰기도 합니다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># for ubuntu</span>

sudo apt-get update
sudo apt-get install -y curl gnupg build-essential

</code></pre></div><p>설치후엔 rbenv를 설치해주어야합니다 루비를 깔아야합니까! 내 가상컴퓨터엔 없기 때문입니다.</p>
<p>rbenv는 rvm과 같은 루비 설치 관리자라고 생각하시면 됩니다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ git clone git://github.com/sstephenson/rbenv.git .rbenv
</code></pre></div><p>.bashrc에 다음 추가. (bash_profile 없으면 그냥 bashrc에다가!! ubuntu는 .bashrc)
<a href="https://github.com/rbenv/rbenv">공식문서</a></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#204a87">echo</span> <span style="color:#4e9a06">&#39;export PATH=&#34;$HOME/.rbenv/bin:$PATH&#34;&#39;</span> &gt;&gt; ~/.bash_profile
~/.rbenv/bin/rbenv init
<span style="color:#204a87">type</span> rbenv
</code></pre></div><p><a href="https://github.com/rbenv/ruby-build#readme">ruby-build 설치</a></p>
<p>rbenv가 저장된 디렉토리를 RBENV_ROOT 환경 변수에 export 하고, rbenv 실행 파일이 들어 있는 디렉토리를 PATH에 추가한다.</p>
<p>쉘을 실행할때마다 rbenv init - 명령을 실행한다. (MAC에서 나도 겪었던 에러! 안하면 절대 안됨)</p>
<p>rbenv가 설치 된 경로를 PATH에 저장해서 rbenv 실행시 엉뚱한게 실행되지 않게 함입니다. 터미널을 다룰 땐 항상 PATH가 민감한 문제죠.</p>
<p><strong>맥에 루비 까는 법도 rbenv를 통해서 깔 수 있습니다. .bash_profile/ .bashrc 설정을 따로 해주어야 하는 점 또한 동일합니다.</strong></p>
<blockquote>
<p><a href="https://gist.github.com/m-gagne/9234940">혹시 이 방법이 안된다면 참고</a></p>
</blockquote>
<h2 id="4-재설정-및-bundler-설치-재시작">4. 재설정 및 bundler 설치, 재시작</h2>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># 엄청 오래걸릴 수 있습니다</span>
rbenv install 2.3.0

rbenv rehash
rbenv global 2.3.0
ruby -v
ruby 2.3.0p0 <span style="color:#ce5c00;font-weight:bold">(</span>2015-12-25 revision 53290<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">[</span>x86_64-linux<span style="color:#ce5c00;font-weight:bold">]</span>
gem install bundler
</code></pre></div><h4 id="주의-이거-생각보다-오래걸립니다-일반-컴퓨터에-설치하는-것보다-약간-더-오래걸린다고-보시면-됩니다-에러-아닙니다">(주의) 이거 생각보다 오래걸립니다. 일반 컴퓨터에 설치하는 것보다 약간 더 오래걸린다고 보시면 됩니다. 에러 아닙니다!</h4>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo apt-get install -y nodejs <span style="color:#ce5c00;font-weight:bold">&amp;&amp;</span>
sudo ln -sf /usr/bin/nodejs /usr/local/bin/node
</code></pre></div><p>nodejs 설치. Rails&rsquo;s asset pipeline compiler requires a Javascript runtime라서 설치한다고 합니다.</p>
<p>/usr/bin/nodejs로의 연결을 /usr/local/bin/node로 바꿔주었군요.</p>
<h2 id="5-postgresql-설치-및-user-추가"><em>5. postgresql 설치 및 user 추가.</em></h2>
<p>SQL 중 하나인 postgresql을 설치&hellip;하려하였으나 왜&hellip;안되는걸까요&hellip;나중에 다시&hellip;일단&hellip;</p>
<h2 id="6-passenger-설치"><em>6. Passenger 설치.</em></h2>
<h1 id="원래는-capistrano를-설치하려-하였으나">원래는 capistrano를 설치하려 하였으나&hellip;</h1>
<p>capistrano는 루비로 작성된 원격 서버 automation과 deployment 툴입니다. 서버 세팅 관리와 디플로이에 사용할 것입니다!
<a href="http://www.talkingquickly.co.uk/2014/01/deploying-rails-apps-to-a-vps-with-capistrano-v3/">tutorial</a>
<a href="https://www.tiagoamaro.com.br/2013/10/28/how-to-compile-assets-locally-with-capistrano/">tutorial2</a>
튜토리얼 따라하다가 포기.</p>
<p>그러다가 passenger라는 것을 발견하게 되었습니다. 잉? capistrano가 deploy 툴인 줄 알았더니 얜 또 뭐야 스러웠죠! 그렇게 웹 서버의 종류에 대해 알아보게 되다가&hellip;stackoverflow를 뒤지다 굉장히 좋은 글을 발견하고 다음 포스팅에서 번역을 진행하겠습니다.</p>
<p>암튼! 결론은 Passenger라는 툴로 갈아탔습니다. 그래서 이 포스팅이 Passenger+ Nginx 로 RoR Application을 Deploy하기! 가 되었죠 ㅎㅎ</p>
<p>기준: Ubuntu 12.04 LTS (with APT).</p>
<p>제 Azure 계정의 가상 컴퓨터는 위 모델이었기 때문에 해당 모델 버전의 tutorial 을 참고하였습니다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># PGP key를 받고 설치. APT를 위한 HTTP 지원 추가.</span>
sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys 561F9B9CAC40B2F7
sudo apt-get install -y apt-transport-https ca-certificates

<span style="color:#8f5902;font-style:italic"># Add our APT repository</span>
sudo sh -c <span style="color:#4e9a06">&#34;echo deb https://oss-binaries.phusionpassenger.com/apt/passenger precise main &gt; /etc/apt/sources.list.d/passenger.list&#34;</span>
sudo apt-get update

<span style="color:#8f5902;font-style:italic"># Install Passenger + Nginx</span>
sudo apt-get install -y nginx-extras passenger
</code></pre></div><p>/etc/nginx에 설치 되었을 겁니다. /etc/nginx/nginx.conf 파일의</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># include /etc/nginx/passenger.conf;</span>

요 주석을 풀어주세요. passenger 설정을 풀어주는 겁니다!

<span style="color:#8f5902;font-style:italic"># 재시작</span>
sudo service nginx restart

<span style="color:#8f5902;font-style:italic"># 제대로 설치되었는가!</span>
sudo /usr/bin/passenger-config validate-install
 * Checking whether this Phusion Passenger install is in PATH... ✓
 * Checking whether there are no other Phusion Passenger installations... ✓

<span style="color:#8f5902;font-style:italic"># nginx가 passenger core process를 시작했는지 체크</span>
sudo /usr/sbin/passenger-memory-stats
<span style="color:#8f5902;font-style:italic"># pid와 size등으로 프로세스가 출력되면 성공.</span>

<span style="color:#8f5902;font-style:italic"># apt로 업데이트 해주세요.</span>
sudo apt-get update
sudo apt-get upgrade
</code></pre></div><p>드디어!</p>
<h2 id="app-deploy-하기">app deploy 하기</h2>
<ol>
<li>일단 내 코드를 원격 저장소 git에 업로드해주세요.</li>
<li>ssh 로 내 가상 컴퓨터로 로그인.</li>
<li>튜토리얼에는 새로운 유저를 만들어서 deploy용 유저로 활용하라는 내용이 있습니다만,(you should create an operating system user account for your app) 저는 새로운 유저를 만들면 왜 인진 모르겠느나 자꾸 루비가 예전버전으로 회귀 ㅠㅠ. 알고보니 새로 만든 유저로 su를 이용해 접속하면 rbenv도 없고 설정 자체가 안되더라구요. 그래서 그냥 제 원래 관리자계정으로 ㅠㅠ 진행하였습니다.</li>
<li>nano config/database.yml로 database.yml을 수정해줍니다.</li>
</ol>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">production:
  adapter: sqlite3
  database: db/production.sqlite3
</code></pre></div><p>배포 모드를 설정해주는 거에요. nano는 text editor라고 생각하시면 됩니다.
5. 세션을 암호화하기 위한 비밀 키를 만들어 주세요.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># 일단 만약 내가 깃에서 다운 받은 코드가 지금 접속한 user의 권한이 아니라면 권한 설정을 해주어야 한다. 아니면 cd 명령도 안먹힌다.</span>
sudo chown -R username /var/www/myapp/myapp

bundle <span style="color:#204a87">exec</span> rake secret
</code></pre></div><p>만들어 진 키를 secret.yml에 넣어주어야 합니다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># 파일 오픈</span>
nano config/secrets.yml

<span style="color:#8f5902;font-style:italic"># 여기 환경변수 자리에 넣어주세요</span>
production:
  secret_key_base: &lt;%<span style="color:#ce5c00;font-weight:bold">=</span>ENV<span style="color:#ce5c00;font-weight:bold">[</span><span style="color:#4e9a06">&#34;SECRET_KEY_BASE&#34;</span><span style="color:#ce5c00;font-weight:bold">]</span>%&gt; <span style="color:#8f5902;font-style:italic"># 이 자리!!</span>
</code></pre></div><ol start="6">
<li>본격 배포 시작 전, precomplie과 migrate 수행. 저는 seed까지. (RAILS_ENV=production가 매우 중요합니다. default 는 development이기 떄문에 production 설정을 해주지 않으면 배포시 migrate가 되지 않았던 에러가 날 것입니다.)</li>
</ol>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bundle <span style="color:#204a87">exec</span> rake assets:precompile db:migrate <span style="color:#000">RAILS_ENV</span><span style="color:#ce5c00;font-weight:bold">=</span>production
bundle <span style="color:#204a87">exec</span> rake db:seed <span style="color:#000">RAILS_ENV</span><span style="color:#ce5c00;font-weight:bold">=</span>production
</code></pre></div><ol start="7">
<li>passenger가 수행하는 루비버전입니다. 메모해놓으세요. 설정에서 써야됩니다!</li>
</ol>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">passenger-config about ruby-command
passenger-config was invoked through the following Ruby interpreter:
  Command: <span style="color:#8f5902;font-style:italic"># 이거!(루비 저장 위치)</span>

sudo nano /etc/nginx/sites-enabled/<span style="color:#ce5c00;font-weight:bold">(</span>*내꺼 이름*<span style="color:#ce5c00;font-weight:bold">)</span>.conf

<span style="color:#8f5902;font-style:italic">#/etc/nginx 에 각종 설정들이 저장되어 있습니다. sites-enabled 폴더에는 활성화 된 어플리케이션들 설정이 들어가고 거기에 내 어플리케이션 설정을 추가해야합니다.</span>

server <span style="color:#ce5c00;font-weight:bold">{</span>
    listen 80<span style="color:#000;font-weight:bold">;</span> <span style="color:#8f5902;font-style:italic"># 포트 80</span>
    server_name name<span style="color:#000;font-weight:bold">;</span> <span style="color:#8f5902;font-style:italic"># DNS 주소 또는 IP 주소 값을 넣어주세요. IP 추천.</span>

    <span style="color:#8f5902;font-style:italic"># 내 코드가 들어있는 위치!</span>
    root /var/www/myapp/code/public<span style="color:#000;font-weight:bold">;</span>

    <span style="color:#8f5902;font-style:italic"># Turn on Passenger</span>
    passenger_enabled on<span style="color:#000;font-weight:bold">;</span>
    passenger_ruby ruby_path<span style="color:#000;font-weight:bold">;</span> <span style="color:#8f5902;font-style:italic"># 내 루비가 설치되어있는 위치(아까 복사한 값)</span>
<span style="color:#ce5c00;font-weight:bold">}</span>

curl http://yourserver.com/
<span style="color:#8f5902;font-style:italic"># 뭔가가 나오나요?</span>
<span style="color:#8f5902;font-style:italic"># sites-enabled를 확인해서, 내 application 외 default 존재 =&gt; 삭제해주세요</span>

sudo service nginx restart
<span style="color:#8f5902;font-style:italic"># 설정을 바꿨다면 서버를 재시작해주세요.</span>

</code></pre></div><h2 id="deploy-완료"><strong>Deploy 완료&hellip;!</strong></h2>
<p><img src="https://s3.ap-northeast-2.amazonaws.com/matilda38.github.io/sc.png" alt="sample Image"></p>
<h1 id="추가">+추가</h1>
<p>계속 겪었던 어려움.</p>
<p>nginx error들.
=&gt; conf 파일(아마 nginx.conf)를 보면 error log가 어디에 저장되어있는지가 나와있습니다. 해당 파일을 참고하여 에러를 해결해주시면 됩니다. 에러메세지를 구글에다 쳐보세요.</p>
<p>사이트 내부 에러.
=&gt; 내 application의 log 폴더 =&gt; production.rb에 배포 단계의 log 가 나와있습니다. <strong>꼭 참고해주세요.</strong></p>
<p>저 같은 경우에 post 라우팅이 안되서 계속 찾아봤더니, nginx 에러가 아니라 <strong>code error</strong>였습니다. (<em>var/nginx/error.log 에선 더이상 에러가 없는데 계속 에러가 나는게 이상했죠.</em>)</p>
<p>code 수정 후 migrate를 수행했는데 그냥 rake db:migrate했더니 development 모드애서만 migrate 가 되었고,</p>
<p><strong>production 모드의 경우 수정 전 migrate 만 적용되어 수정사항이 반영되지 않았던 거죠.</strong></p>
<p>rake db:migrate RAILS_ENV=production rake db:seed RAILS_ENV=production 수행 후엔 해결 되었습니다.</p>
<p>배포 단계에서의 migrate는 따로 해줘야 하는 것을 몰랐던 거죠.</p>
<p>rails console을 통해 알았어야 하는데 이것 또한 <em>rails console production</em> 이라고 해야 배포단계의 console이 나오기 때문에 계속 헤맸습니다.</p>
<p>rails console 만 쳐서 development 단계의 migration만 확인하고 왜 안될까 계속 헤맸습니다&hellip;ㅠㅠ 무식하면 힘들다.</p>
<h1 id="-추가-2-2016-8-29-멋사-해커톤">+ 추가 2 (2016. 8. 29 멋사 해커톤)</h1>
<p>gem uglifier 에러
-&gt; load 할 수 없다는 에러가 떠서 gem &lsquo;therubyracer&rsquo; 이거 uncomment 해줬더니 해결</p>
<h1 id="-참고도움을-많이-받았던-vm-ssh-연결법-azure-도움말httpsazuremicrosoftcomko-krdocumentationarticlesvirtual-machines-linux-ssh-from-linux">+ 참고<a href="https://azure.microsoft.com/ko-kr/documentation/articles/virtual-machines-linux-ssh-from-linux/">도움을 많이 받았던 VM, SSH 연결법 azure 도움말</a></h1>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-8e0bce59bc1f951cdbf2e01efabdfa03">PYTHON</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2016-08-18" class="text-muted">2016.08.18</time>
        
	</div>
	<p>virtualenv로 가상환경을 만들어 python을 실행해야하는데, 귀찮다..</p>
<p>python3</p>
<p>python은 여러모로 충격적인 언어이다.
일단 x라는 문자를 입력받았을때 <strong>int(x)하면 걍 정수가 나온다</strong>. (atoi(const char*), Int32.parseInt(char*)이런거 필요없음)</p>
<p>DashInsert문제를 풀때 Python으로 풀면,
{% highlight python %}
def even(x,y):
if int(x)%2 == 0 and int(y)%2==0:
return True
else:
return False</p>
<p>def odd(x,y):
if int(x)%2 == 1 and int(y)%2==0:
return True
else:
return False</p>
<p>def DashInsert(s):
ans = []
for i in range(0,len(s)-1):
if even(s[i],s[i+1]):
ans.append('*')
elif odd(s[i],s[i+1]):
ans.append('-')
else:
ans.append(s[i])
ans.append(s[-1])
return ans</p>
<p>print(DashInsert(input()))</p>
<pre><code>위와 같이 풀수 있다. input()을 통해 문자열입력을 받고, ans라는 리스트를 선언하고,
입력받은 문자열 배열에서 연속적인 두 수가 둘 다 짝수이면, 또는 홀수이면, 각 함수를 실행하게 만들 수 있다.

여기서,충격적인 점은 다음과 같다.
람다를 사용하면,

*lambda 인자 : 표현식* 와 같이 함수를 간단히 작성할 수 있다.
lambda를 이용한 파이썬 응용은, map, reduce, filter가 있는데,

 - map(함수, 리스트) : map은 순서형 자료(리스트)를 받아서 모든 항을 함수처리를 해준 후 새로운 리스트를 반환한다.
&gt; list(map(lambda x: x ** 2, range(5)))     # 파이썬 2 및 파이썬 3
 [0, 1, 4, 9, 16]

 - filter(함수, 리스트) : filter의 함수는 무조건 true/false를 반환하는 함수로 true를 반환하는 항만 살리고 나머지는 삭제한 리스트를 반환하는 함수이다.
&gt;filter(lambda x: x &lt; 5, range(10))       # 파이썬 2
[0, 1, 2, 3, 4]  

 - reduce(함수, 순서형 자료) : reduce는 특이하게 인자가 두개이고, 순서형자료(리스트, 튜플, 문자열)를 받고 원소들을 누적적으로 함수에 적용시킨다.
 즉, 순서형 자료형에서 1,2번째 원소의 함수 적용값이 2,3번째 원소의 x값이 되는 것.
&gt;reduce(lambda x, y: x + y, [0, 1, 2, 3, 4])
10//0에다 1더하고, 그 결과인 1에다 2더하고, 그 결과인 3에다 3을, 그 결과인 6에다 4를 더해 10을 결과로 반환.

암튼 충격적인건 이문제를 reduce로 풀 수있다는 것이다.
{% highlight python %}
from functools import reduce
def DashInsert(s): return reduce(lambda x, y: x + ['\*','','\-'][int(x[-1])%2 + int(y) % 2] + y, s)
</code></pre><p>와 진짜 이런생각 어떻게 하지?
ㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋ</p>
<p>연속되는 두 원소 x,y에 대해서, 두 수가 모두 짝수이면 나머지가 0이고, 두 수가 모두 홀수이면 나머지가 모두 1이기 때문에,</p>
<ul>
<li>두 원소 모두 짝수</li>
<li>두 원소 모두 홀수</li>
<li>(짝.홀) 또는 (홀.짝)
세 조건 중 하나라는 점을 이용해서,</li>
</ul>
<p>reduce함수가 원소를 누적적으로 함수에 적용시킨다는 점을 이용해서, 문제를 풀고 단, 연속적인 두 원소에 대해서 짝/홀을 검사해야하므로 int(x[-1])로 이전 결과값 문자열의 마지막 값에 대해 검사하도록 했다.</p>
<p>이거 보고 박수쳤다&hellip;ㅠㅠㅠ</p>
<p>예를 들어, 32493이면,</p>
<p>3 + ['*','','-'][1+0] + 2 이므로 32가 반환,
32 + ['*','','-'][0+0] + 4 이므로 32<em>4가 반환,
32</em>4 + ['*','','-'][1+0] + 9 이므로 32<em>49가 반환,
32</em>49 + ['*','','-'][1+1] + 3 이므로 32<em>49-3가 반환
결과적으로 32</em>49-3이 반환된다.</p>
<p>문자열의 길이를 계산할 필요도 없고, 정말 좋다&hellip;ㅠㅠㅠ 으악 파이썬 람다식 대박, 리듀스 대박.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-fea55a51b4b901341edd293ead23d4da">커리어?..커리어!</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2016-08-15" class="text-muted">2016.08.15</time>
        
	</div>
	<p>tab을 얼마나 켜놨는지 저만큼 열려있었다. udacity 에서 how to be developer 였나 career 관련 게시물을 계속 찾아보다보니. 아까 <strong>git</strong>도 공부해야된다고 했는데&hellip;일단 제일 첫번쨰 탭에 있네. 그래..해야지..</p>
<p>커리어 관련 세미나에 참석하면 항상 듣는 얘기가 있다.</p>
<p>가장 중요한 포인트. 컴퓨터의 기초 과목. 컴퓨터공학의 기초.</p>
<blockquote>
<ol>
<li>자료구조.
: 프로그래밍은 데이터를 다루는 일. 자료구조는 데이터를 저장해 두는 곳이다. &ldquo;여기에는 어떤 자료구조가 적합한가.&rdquo; 각 자료구조간 장단점/차이점. ex) linked list와 hash map의 차이.</li>
</ol>
</blockquote>
<ol start="2">
<li>알고리즘.
: 작업의 단계+ 작업 효율성의 척도. Time complexity&amp; Space Complexity. 자료구조 별 access, search, insert, delete 작업의 time complexity 비교.
Sorting 알고리즘 별 time &amp; space complexity 공부로 시작하세요.</li>
<li>네트워크.
: 브라우저에 <a href="http://naver.com">http://naver.com</a>을 입력하면 어떤 일들이 일어날까?
OSI 7 layer, DNS / HTTP는 왜 TCP/IP일까? TCP/IP와 UDP의 차이점.
SPDY 프로토콜.</li>
</ol>
<ul>
<li>HTTP 작동방식을 이해.</li>
<li>왜 실시간 커뮤니케이션을 할 때 단점이 있는지</li>
<li>HTTP/2</li>
</ul>
<ol start="4">
<li>멀티쓰레드 환경에서의 개발.
: Asynchronous VS synchronous(동기 vs 비동기)</li>
</ol>
<ul>
<li>다른 쓰레드에 맡긴 작업의 결과를 기다리는 동안 다른 작업을 할 수 있느냐, 못하느냐</li>
</ul>
<ol start="5">
<li>SW 아키텍쳐.</li>
</ol>
<ul>
<li>디자인 패턴.</li>
<li>새로운 언어나 프레임워크를 학습할때 빠른 시간 내에 숙달 가능.</li>
</ul>
<ol start="6">
<li>동료 개발자와의 협업.</li>
</ol>
<ul>
<li>새로운 클래스가 추가되고 다른 개발자가 추가되더라도 어려움이 없도록 구조가 깔끔한 코드를 짜야한다.</li>
</ul>
<p>Udacity에 Career 안내가 나와있다.</p>
<h1 id="1-your-path-to-getting-hired"><em>1. Your Path to Getting Hired</em></h1>
<p>커리어를 쌓고 이력서 작성법 등에 대하여 작성되어있다. <a href="https://career-resource-center.udacity.com/">Go</a></p>
<p>여러 메뉴중 난 <a href="https://career-resource-center.udacity.com/explore-your-career-options">career resource center</a>를 참고했다.</p>
<p>정말 자세히 설명되어있다. 중간중간 blog.udacity로 연결되는 몇 링크가 존재한다.</p>
<p><a href="http://alistapart.com/topics">http://alistapart.com/topics</a> 이거뭐지?
<a href="http://www.snow.or.kr/lecture/applied_sciences/computer_science/?&amp;cline=0">숙명여대 번역 해외강의사이트.</a>
mit, havard, berkely등 유명 대학강의가 번역되어있다.</p>
<h1 id="2-coding-practice"><em>2. Coding Practice</em></h1>
<blockquote>
<p>Coding Practice에서 참고할 수 있었던 세개의 사이트.</p>
</blockquote>
<p><a href="http://www.codewars.com/">Code wars</a></p>
<p>프로젝트 오일러라는 알고리즘 공부사이트.
<a href="http://projecteuler.net/">오일러</a></p>
<p><a href="https://www.hackerrank.com/">HackerRank</a></p>
<p>흠 <a href="https://www.codecademy.com/">codeacademy</a>, <a href="https://www.codeschool.com/">codeschool</a> 이런건 없네?</p>
<p><strong>hackathon</strong>에 대해서 설명이 있네.</p>
<blockquote>
<p>해커톤은 네트워킹, 협업, 혁신을 위한 곳이다. 보통 하루나 며칠정도 열리는데, 소프트웨어 개발에 관련한 종사자들이 모두 함께 협업한다.</p>
</blockquote>
<p><em>정말 해커톤은 좋은 것같다. 몸이 썩는 것같은 느낌빼고는? 내 호르몬 ㅠ</em></p>
<h1 id="다음-opensource-contributing">다음, <strong>opensource contributing!</strong></h1>
<p>중요성을 굉장히 많이 들었는데 정확한 방법을 모르겠네. 다른 포스팅에서 자세히 알아보도록 하겠습니다.</p>
<p>요약: 오픈 소스에 공헌하기. 오픈소스 코드 또는 소프트웨어는 모두가 사용 가능하다. 오픈소스 프로젝트에서 협업하고 창의적이며 현재 존재하는 프로젝트를 만드는 재료로 사용하는 것은 흔하다. 라는 설명과 아래 자세한 링크들이 첨부되어있는데 꼭 읽어봐야겠다.</p>
<h1 id="3-커뮤니티들"><em>3. 커뮤니티들.</em></h1>
<blockquote>
<p><em>코딩 커뮤니티</em>에 함께하는 것은 당신과 비슷한 관심사를 가진 사람들에 연결되는 훌륭한 방법이다. 커뮤니티에 join하면서, 최신 트렌드와 네트워크에 머무를 수 있다.</p>
</blockquote>
<p>나도 요즘 노력중이다. 페북이나 slack으로 여러 모임이 형성되어 있는듯하다. <em>9xD 개발자 모임, 이상한 모임, 파이썬 코리아, okky 닷컴, Django Girls</em>등 개발자 모임이 생각보다 정말 많았다. 개발 모임은 아니지만 로열모, 로봇걸즈 등 로봇 관련 모임도 많았는데, 로봇같은 경우 좀 더 고급 산업이라는 느낌이 있어서인지 참여하고 싶었다. 안그래도 이번에 DEVCAMP라는 모임에 참가하는데, 기대가 된다.</p>
<p>마지막으로 깃허브에서 본 좋은 <a href="https://github.com/rorlakr/rorla_api/wiki/%EA%B0%9C%EB%B0%9C%EC%97%90-%EB%8F%84%EC%9B%80%EC%9D%B4-%EB%90%98%EB%8A%94-%EC%9E%90%EB%A3%8C-%EB%AA%A8%EC%9D%8C">자료</a></p>
<blockquote>
<p><a href="https://www.youtube.com/watch?v=fHyTA-UIcqs">개발자의 9가지 기술</a> // <a href="https://slipp.net/questions/13">자바 웹 개발자</a>
<a href="http://tmondev.blog.me/220784164984">티몬 웹 블로그 추천 시스템</a> // <a href="https://facebook.github.io/react/docs/thinking-in-react.html#step-1-break-the-ui-into-a-component-hierarchy">react 에 대하여</a></p>
</blockquote>
<p>진짜 마지막으로 코딩할때 자주쓰는 웹 메모장</p>
<blockquote>
<p>[메모장](data:text/html, <html contenteditable>)</p>
</blockquote>
<p>P.S 조언들.</p>
<ol>
<li>개발 실력은 코딩하는 만큼 업그레이드 된다.</li>
</ol>
<ul>
<li>내가 만들고 싶은 걸 찾아서 만들면 재미도 있고 개발도 는다.</li>
</ul>
<ol start="2">
<li>프로젝트 경험(무언가를 만들어보세요). 토이프로젝트!</li>
</ol>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-211264775bbcd104c1752d594e48ae5c">Git!</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2016-08-12" class="text-muted">2016.08.12</time>
        
	</div>
	<p>프로젝트에서 버전관리를 사용하면 프로젝트의 모든 코드가 중앙의 저장소 Repository에 저장된다. 프로젝트의 스냅샷을 저장한다고 생각하면 된다.</p>
<p>프로젝트 Repo의 주소를 복사하여</p>
<blockquote>
<p>git clone (url)</p>
</blockquote>
<p>하면 해당 저장소의 프로젝트를 로컬 저장소로 내려받을 수 있다.(check-out)</p>
<p>또는 내 Project를 원격 저장소로 업로드 하기 위해(check-in)</p>
<blockquote>
<p>git remote add (name) (url)</p>
</blockquote>
<p>name은 보통 origin으로 한다. 원격저장소의 이름과 주소를 적어주면 원격저장소를 등록할 수 있고</p>
<p>등록된 원격저장소에 내 로컬 저장소에 있는 내용들(로컬 깃에 커밋완료 된것)</p>
<blockquote>
<p>git push origin (branch-name)</p>
</blockquote>
<p>로 업로드할 수 있다.</p>
<p><a href="http://greatgift.tistory.com/36">sourceTree로 배우기</a></p>
<p><a href="http://gitimmersion.com/lab_06.html">깃 따라하기</a></p>
<p><a href="http://class.likelion.net/tutorials/8">클래스 라이언</a></p>
<p>Git focuses on the changes to a file rather than the file itself. When you say git add file, you are not telling git to add the file to the repository. Rather you are saying that git should make note of the current state of that file to be committed later.</p>
<p>$ git status
On branch master
Changes to be committed:
(use &ldquo;git reset HEAD <file>&hellip;&rdquo; to unstage)</p>
<pre><code>modified:   hello.rb
</code></pre>
<p>Changes not staged for commit:
(use &ldquo;git add <file>&hellip;&rdquo; to update what will be committed)
(use &ldquo;git checkout &ndash; <file>&hellip;&rdquo; to discard changes in working directory)</p>
<pre><code>modified:   hello.rb
</code></pre>
<p>Notice how hello.rb is listed twice in the status. The first change (adding a default) is staged and is ready to be committed. The second change (adding a comment) is unstaged. If you were to commit right now, the comment would not be saved in the repository.</p>
<p>Let’s try that.</p>
<p>GDG 세션에서 배운것도 활용하자.</p>
<ol>
<li>Git Branch</li>
</ol>
<blockquote>
<p>git branch</p>
</blockquote>
<p>branch는 가지라는 뜻이다. 즉, Git에서도 개발 가지이다. 브랜치는 협업에서는 필수이다. 각각의 브랜치에 있을때는 각각의 브랜치 내용만 저장되기 때문에 편하다.</p>
<blockquote>
<p>git checkout -b nayoon/smsSend dev
dev브랜치 에서 nayoon폴더 밑 smsSend 브랜치를 새로 생성하여 이동</p>
</blockquote>
<blockquote>
<p>git branch -d dev
dev 브랜치를 삭제한다</p>
</blockquote>
<ol start="2">
<li>Git push</li>
</ol>
<blockquote>
<p>git push &ndash;set-upstream origin nayoon/sms-auth
이러면 nayoon폴더 sms-auth branch를 기본 branch로 설정하고 push 할 수 있다.
다음부터 git push 로 하면 자동으로 nayoon/sms-auth로 설정된다</p>
</blockquote>
<p>'''
현재 존재하는 브랜치로부터 새로운 브랜치를 파고 싶을때.</p>
<p>First change/checkout into the branch from where you want to create a new branch.For example if you have the following branches like:</p>
<p>master
dev
branch1
So if you want to create a new branch called &ldquo;subbranch_of_b1&rdquo; under the branch named &ldquo;branch1&rdquo; follow the steps:</p>
<h2 id="checkout-or-change-into-branch1">Checkout or change into &ldquo;branch1&rdquo;</h2>
<p><em>branch1로 checkout</em>
git checkout branch1</p>
<p><em>b1의 sub branch인 &ldquo;subbranch_of_b1&quot;를 생성한다.(b 옵션은 브랜치 생성후 바로 checkout하기 위함이다.)</em>
git checkout -b subbranch_of_b1 branch1</p>
<p>The above will create a new branch called subbranch_of_b1 under the branch branch1 (Note that  branch1 in the above command isn&rsquo;t mandatory since the HEAD is currently pointing to it, you can precise it if you are on a different branch though)</p>
<p>Now after working with the subbranch_of_b1 you can commit and push or merge it locally or remotely.
'''
<img src="../assets/images/git.jpg" alt="git image"></p>
<p><a href="https://backlogtool.com/git-guide/kr/stepup/stepup6_3.html">깃 특정 커밋의 상태로 돌아가기</a>
<a href="http://crynut84.github.io/2015-06-19/basic-command-git.html">깃 기초 명령어</a></p>
<h2 id="git-ignore-파일-추가하기">Git Ignore 파일 추가하기</h2>
<p>.gitignore파일로 git 저장소에 올리고 싶지 않은 파일들을 제외시킬 수 있다. 나의 경우엔</p>
<pre><code>.idea/
*.o
bundle/
Gemfile
Gemfile_o
secret/
</code></pre><p>이런식으로 지정해줬는데 IDE 사용시 자동으로 추가되는 파일이나, 루비 젬파일들은 굳이 깃헙에 올려놓을 필요가 없으므로 제외시켰고, o같은 확장자를 가진 파일들은 대개 컴파일 과정에서 생기는 불필요한 파일이므로 제외시켜주었다. secret폴더에는 밖에 보이는 글말고 혼자 보고 싶은 글을 마크다운으로 작성해서 저장해놓기 위해 gitignore에 추가해주었다.</p>
<p>{% highlight bash%}
git rm -r –cached .
git add .
git commit -m “Updated .gitignore”</p>
<pre><code>
이런식으로 기존 cache를 지우고, gitignore가 업데이트 된것을 add 해준후, commit 해주면 gitignore가 반영된다.
이는 git이 traking하는 파일들을 초기화하는 작업과 같다. 즉, gitignore에 있는 파일/폴더들은 track하지 마라 이 뜻과 같다.

이미 add된 특정 파일만 untrack하기 위한 명령어는

**git rm --cached filename** 라고 한다. [stackoverflow](https://stackoverflow.com/questions/1139762/ignore-files-that-have-already-been-committed-to-a-git-repository)
</code></pre>
</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-b30faf004c8afffa6d5fe9bc032ffe04">mentoring 자료!</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2016-08-01" class="text-muted">2016.08.01</time>
        
	</div>
	<p>python web crawler</p>
<p>개발자 도구 (오른쪽 버튼 + 검사)</p>
<p>c9.io</p>
<p>아이들에게 필요한건 portfolio를 쌓아주는 것이다. 논술전형이 없어진다는 말을 듣곤, 일반고 학생들에게 점점 기회가 사라지고 있다는 생각이 들었다. 논술을 차차 줄이면서 학생부를 준비할 수 있는 기회를 줘야하는데 아예 바로 없애버리니까 아이들의 혼란이 더 커질거라고 생각한다. 아직 스펙 쌓을 수 있는 인프라가 부족한 일반고에서는 대학입시가 더욱 더 힘들어질 것이다.</p>
<blockquote>
<p>아무래도 나라도 학원을 하나&hellip;세워야 되지 않을까&hellip;ㅠㅠ돈이 없어 슬프다. 있으면 바로 세울텐데.</p>
</blockquote>
<p>각 전공별로 3학년 이상의 대학생 선생님 10명 확보(각 전공당 2명씩). 대학 1.2학년 수준의 포트폴리오 제작.</p>
<blockquote>
<p>진짜&hellip;! 해보고싶다.</p>
</blockquote>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-58d2796147445545b42f879cb588b4d6">드디어 3일간의 개고생이 끝났다.</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2016-07-31" class="text-muted">2016.07.31</time>
        
	</div>
	<p>3일동안 celebrity#show 에 게시판 만들고 그 안에 post를 만들고 또 그 아래 댓글을 ajax로 하다가 진짜 죽는줄 알았다. 땀은 줄줄 나는데 망할 놈의 404 500 에러는 진짜 계속나고&hellip;처음엔 통신문젠가 했는데 역시 코드 문제였다. 코드 문제로 골머리를 앓을땐, 특히 웹개발할 땐 터미널의 로그를 보도록 한다. 거기에 답이 있다. 에러를 반드시 표시한다.</p>
<p>일단 날라갈지도 모르므로&hellip;메모를&hellip;git 너무 무섭다&hellip;</p>
<h2 id="가장-중요한-controller">가장 중요한 controller</h2>
<p>지금은 이해 안될지도 모른다. 일단 잘 살펴보고 뒤에 파일들도 보도록 한다.</p>
<p><em>comment_controller.rb</em></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">CommentsController</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">ApplicationController</span>
  <span style="color:#000">before_action</span> <span style="color:#4e9a06">:comment_params</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">only</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">[</span><span style="color:#4e9a06">:create</span><span style="color:#ce5c00;font-weight:bold">]</span>


  <span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">create</span>
    <span style="color:#8f5902;font-style:italic">#1st you retrieve the post thanks to params[:post_id]</span>
    <span style="color:#000">@post</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Post</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">find</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">comment_params</span><span style="color:#ce5c00;font-weight:bold">[</span><span style="color:#4e9a06">:post_id</span><span style="color:#ce5c00;font-weight:bold">]</span><span style="color:#000;font-weight:bold">)</span>
    <span style="color:#8f5902;font-style:italic">#2nd you create the comment with arguments in params[:comment]</span>
    <span style="color:#000">@comment</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">@post</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">comments</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">create</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">comment_params</span><span style="color:#000;font-weight:bold">)</span>

    <span style="color:#000">respond_to</span> <span style="color:#204a87;font-weight:bold">do</span> <span style="color:#ce5c00;font-weight:bold">|</span><span style="color:#204a87">format</span><span style="color:#ce5c00;font-weight:bold">|</span>
      <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">@comment</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">save</span>
        <span style="color:#204a87">format</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">js</span>
      <span style="color:#204a87;font-weight:bold">end</span>
    <span style="color:#204a87;font-weight:bold">end</span>
  <span style="color:#204a87;font-weight:bold">end</span>


  <span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">destroy</span>
    <span style="color:#000">@post</span> <span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">Post</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">find</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">params</span><span style="color:#ce5c00;font-weight:bold">[</span><span style="color:#4e9a06">:post_id</span><span style="color:#ce5c00;font-weight:bold">]</span><span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000">@comment</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">@post</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">comments</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">find</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">params</span><span style="color:#ce5c00;font-weight:bold">[</span><span style="color:#4e9a06">:id</span><span style="color:#ce5c00;font-weight:bold">]</span><span style="color:#000;font-weight:bold">)</span>
      <span style="color:#000">respond_to</span> <span style="color:#204a87;font-weight:bold">do</span> <span style="color:#ce5c00;font-weight:bold">|</span><span style="color:#204a87">format</span><span style="color:#ce5c00;font-weight:bold">|</span>
        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">@comment</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">destroy</span>
        <span style="color:#204a87">format</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">js</span>
        <span style="color:#204a87;font-weight:bold">end</span>
      <span style="color:#204a87;font-weight:bold">end</span>
  <span style="color:#204a87;font-weight:bold">end</span>

  <span style="color:#204a87;font-weight:bold">private</span>
    <span style="color:#8f5902;font-style:italic"># Use callbacks to share common setup or constraints between actions.</span>
    <span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">comment_params</span>
      <span style="color:#000">params</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">require</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">:comment</span><span style="color:#000;font-weight:bold">)</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">permit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">:post_id</span><span style="color:#000;font-weight:bold">,</span><span style="color:#4e9a06">:celebrity_id</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">:user_id</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">:content</span><span style="color:#000;font-weight:bold">)</span>
    <span style="color:#204a87;font-weight:bold">end</span>

<span style="color:#204a87;font-weight:bold">end</span>
</code></pre></div><h2 id="view">view</h2>
<p>(상세정보 -&gt; 게시판 -&gt; 댓글 ajax가 한화면에서 이뤄져야 한다)</p>
<p><em>celebrity#show</em></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="color:#000;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">h2</span><span style="color:#000;font-weight:bold">&gt;</span>댓글<span style="color:#000;font-weight:bold">&lt;/</span><span style="color:#204a87;font-weight:bold">h2</span><span style="color:#000;font-weight:bold">&gt;</span>
    <span style="color:#000;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">div</span> <span style="color:#c4a000">class</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;comments&#34;</span><span style="color:#000;font-weight:bold">&gt;</span>
     <span style="color:#000;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">div</span> <span style="color:#c4a000">class</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;comment_header&#34;</span><span style="color:#000;font-weight:bold">&gt;</span>
        <span style="color:#000;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">h2</span><span style="color:#000;font-weight:bold">&gt;</span>Comments:<span style="color:#000;font-weight:bold">&lt;/</span><span style="color:#204a87;font-weight:bold">h2</span><span style="color:#000;font-weight:bold">&gt;</span>
     <span style="color:#000;font-weight:bold">&lt;/</span><span style="color:#204a87;font-weight:bold">div</span><span style="color:#000;font-weight:bold">&gt;</span>
      <span style="color:#000;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">div</span> <span style="color:#c4a000">class</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;comments_list&#34;</span><span style="color:#000;font-weight:bold">&gt;</span>
       <span style="color:#000;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">ul</span> <span style="color:#c4a000">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;comments_list_&lt;%=post.id%&gt;&#34;</span><span style="color:#000;font-weight:bold">&gt;</span>
        <span style="color:#a40000">&lt;</span>% if post.comments.size &gt; 0 %&gt;
         <span style="color:#a40000">&lt;</span>%= render post.comments %&gt; #post에 연결된 comment들이 출력된다.
        <span style="color:#a40000">&lt;</span>% else %&gt;
         <span style="color:#000;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">li</span><span style="color:#000;font-weight:bold">&gt;</span>
         No comments
         <span style="color:#000;font-weight:bold">&lt;/</span><span style="color:#204a87;font-weight:bold">li</span><span style="color:#000;font-weight:bold">&gt;</span>
        <span style="color:#a40000">&lt;</span>% end %&gt;
       <span style="color:#000;font-weight:bold">&lt;/</span><span style="color:#204a87;font-weight:bold">ul</span><span style="color:#000;font-weight:bold">&gt;</span>
     <span style="color:#000;font-weight:bold">&lt;/</span><span style="color:#204a87;font-weight:bold">div</span><span style="color:#000;font-weight:bold">&gt;</span>
    <span style="color:#a40000">&lt;</span>%=render &#39;comments/form&#39;, post:post%&gt;
    <span style="color:#000;font-weight:bold">&lt;/</span><span style="color:#204a87;font-weight:bold">div</span><span style="color:#000;font-weight:bold">&gt;</span>

</code></pre></div><p>render post.comments를 보자. post와 연결된 comment들이 호출된다. 물론 post.rb에서 1:n 으로 comment를 연결해주었기 때문에 post.comments 같은 method 호출이 가능하다. 주목할 점은 render post.comments가 comment 폴더내에 있는 _comment.html.erb파일의 layout에 맞춰 모든 comment들을 출력해준다는 점이다. code를 작성하는 입장해서 @comments.each do |c| 이런 식의 문법이 필요없었으므로 매우 편리했다.
두번째 줄의 &lt;%=render &lsquo;comments/form&rsquo; post:post%&gt; 이건 밑에 _form.html.erb를 보면서 설명하겠다.</p>
<h2 id="comment-폴더-내-파일들">comment 폴더 내 파일들</h2>
<p><em>_comment.html.erb</em></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">
<span style="color:#000;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">li</span> <span style="color:#c4a000">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;comment_&lt;%=comment.id %&gt;&#34;</span><span style="color:#000;font-weight:bold">&gt;</span>
  <span style="color:#a40000">&lt;</span>%= comment.content%&gt;
  <span style="color:#a40000">&lt;</span>%= time_ago_in_words(comment.created_at) %&gt; ago
  <span style="color:#a40000">&lt;</span>%= link_to &#39;delete&#39;, [comment.post, comment], method: :delete, remote: true, data: { confirm: &#34;Are you sure?&#34; } %&gt;
<span style="color:#000;font-weight:bold">&lt;/</span><span style="color:#204a87;font-weight:bold">li</span><span style="color:#000;font-weight:bold">&gt;</span>
</code></pre></div><p>_comment.html.erb 파일명을 주목하자 _가 붙어있는 걸 보아 render partial로 사용할것이 짐작이 가는가? 뒤에 나오는 _form.html.erb도 같은 맥락으로 이해하면 된다.</p>
<p><em>comments/_form.html.erb</em></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">
<span style="color:#a40000">&lt;</span>% @comment = post.comments.new%&gt; #post에 해당하는 댓글을 새로 생성한다.
<span style="color:#8f5902;font-style:italic">&lt;!--댓글 form--&gt;</span>
<span style="color:#000;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">div</span> <span style="color:#c4a000">class</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;comments_form&#39;</span><span style="color:#000;font-weight:bold">&gt;</span>
  <span style="color:#000;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">div</span> <span style="color:#c4a000">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;comments_form_&lt;%=post.id%&gt;&#34;</span><span style="color:#000;font-weight:bold">&gt;</span> # 추후에 js에서 유용히 쓸 예정이다.
    <span style="color:#a40000">&lt;</span>%= form_for [post, @comment], remote: true do |f| %&gt;
        <span style="color:#000;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">div</span> <span style="color:#c4a000">class</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;field&#34;</span><span style="color:#000;font-weight:bold">&gt;</span>
          <span style="color:#a40000">&lt;</span>%= f.hidden_field :user_id, :value =&gt; current_user.id %&gt;
          <span style="color:#a40000">&lt;</span>%= f.hidden_field :post_id, :value =&gt; post.id %&gt;
          <span style="color:#a40000">&lt;</span>%= f.hidden_field :celebrity_id, :value =&gt; @celebrity.id %&gt;
        <span style="color:#000;font-weight:bold">&lt;/</span><span style="color:#204a87;font-weight:bold">div</span><span style="color:#000;font-weight:bold">&gt;</span>

        <span style="color:#000;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">div</span> <span style="color:#c4a000">class</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;field&#34;</span><span style="color:#000;font-weight:bold">&gt;</span>
          <span style="color:#a40000">&lt;</span>%= f.label :content %&gt;
          <span style="color:#a40000">&lt;</span>%= f.text_area :content, placeholder: &#39;Add a comment.&#39; %&gt;
        <span style="color:#000;font-weight:bold">&lt;/</span><span style="color:#204a87;font-weight:bold">div</span><span style="color:#000;font-weight:bold">&gt;</span>

        <span style="color:#000;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">div</span> <span style="color:#c4a000">class</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;actions&#34;</span><span style="color:#000;font-weight:bold">&gt;</span>
          <span style="color:#a40000">&lt;</span>%= f.submit %&gt;
        <span style="color:#000;font-weight:bold">&lt;/</span><span style="color:#204a87;font-weight:bold">div</span><span style="color:#000;font-weight:bold">&gt;</span>
    <span style="color:#a40000">&lt;</span>% end %&gt;
  <span style="color:#000;font-weight:bold">&lt;/</span><span style="color:#204a87;font-weight:bold">div</span><span style="color:#000;font-weight:bold">&gt;</span>
<span style="color:#000;font-weight:bold">&lt;/</span><span style="color:#204a87;font-weight:bold">div</span><span style="color:#000;font-weight:bold">&gt;</span>
</code></pre></div><p>&lt;%=render &lsquo;comments/form&rsquo; post:post%&gt;를 기억하는가? 위에 언급했었다. celebrity#show에 작성되어 있었다. 이는 form 에서 사용하는 변수 post는 현재 우리 view 파일에서 사용하는 변수 post를 의미하는 겁니다~ 라고 이해하자. 일종의 parameter로 이해하면 되겠다.
&lsquo;form_for [post, @comment], remote: true&rsquo; 이 부분에 주목해야하는데 form_for 뒤에 것은 url에 관련된 것이다. 즉, posts/:post_id/comments 이고 method는 post로 던진다.
&lsquo;remote true&rsquo;이는 create.js.erb가 작동하게 해준다. 즉, post로 posts/:post_id/commments를 request 하므로 보통 controller에서 create 액션으로 연결되고 당연히 create.html.erb가 작동하지만 우리가 필요한건 create.js.erb이다. ajax를 통해 화면 이동 없이 댓글이 달려야 하기 때문이다. 따라서 create.js.erb로 연결가능하게 만들어 주려면
&lsquo;remote: true&rsquo; option이 꼭 필요하다.</p>
<blockquote>
<p>ajax 를 가능하게 해준 create.js.erb 이다. 중요! controller의 create action이 수행된 후 호출되는 js이다.</p>
</blockquote>
<p><em>create.js.erb</em></p>
<p>{%highlight js%}</p>
<p>&lt;% if @comment.errors.size == 0 %&gt;
$('&lt;%=j render @comment %&gt;').appendTo($(&quot;#comments_list_&lt;%=@post.id %&gt;&quot;)).hide().fadeIn(&lsquo;fast&rsquo;);
$(&quot;#comments_form_&lt;%=@post.id %&gt; form&quot;)[0].reset();
&lt;% else %&gt;
alert(&ldquo;Please submit after commenting&hellip;&quot;);
&lt;% end %&gt;</p>
<pre><code>
create.js.erb의 내용을 설명하자면,
&gt;&lt;%=j render @comment%&gt;는 js로 @comment, 즉 controller의 create action을 통해 생성된 댓글 객체의 layout을 render하고 그것을 show action view file에 id= &quot;comment_list_&lt;%=@post.id%&gt;&quot; 인 list에 추가하라는 것이다.
그리고 comment_form 은 지워진 상태로 reset한다.

destroy.js.erb

{%highlight js%}
$(&quot;#comment_&lt;%=@comment.id %&gt;&quot;).slideUp('fast');
</code></pre><p>삭제이므로, 삭제될 comment가 slideup되는 것이다. <em>comment.html.erb에 있는 view file를 참고하면 왜 $(&quot;#comment</em>&lt;%=@comment.id %&gt;&quot;)인지 알수 있을것이다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">CreateComments</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">ActiveRecord</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">Migration</span><span style="color:#ce5c00;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">5</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">change</span>
    <span style="color:#000">create_table</span> <span style="color:#4e9a06">:comments</span> <span style="color:#204a87;font-weight:bold">do</span> <span style="color:#ce5c00;font-weight:bold">|</span><span style="color:#000">t</span><span style="color:#ce5c00;font-weight:bold">|</span>

      <span style="color:#8f5902;font-style:italic"># user와 post에 종속</span>
      <span style="color:#000">t</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">integer</span> <span style="color:#4e9a06">:user_id</span>
      <span style="color:#000">t</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">integer</span> <span style="color:#4e9a06">:post_id</span>
      <span style="color:#000">t</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">integer</span> <span style="color:#4e9a06">:celebrity_id</span>

      <span style="color:#000">t</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">string</span> <span style="color:#4e9a06">:content</span>

      <span style="color:#000">t</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">timestamps</span>
    <span style="color:#204a87;font-weight:bold">end</span>
  <span style="color:#204a87;font-weight:bold">end</span>
<span style="color:#204a87;font-weight:bold">end</span>

<span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">Comment</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">ApplicationRecord</span>
  <span style="color:#000">belongs_to</span> <span style="color:#4e9a06">:post</span>
  <span style="color:#000">belongs_to</span> <span style="color:#4e9a06">:user</span>
<span style="color:#204a87;font-weight:bold">end</span>

</code></pre></div><p>참고로 이 두개는 기본적으로 되어있어야한다.</p>
<p>P.S</p>
<p>말이 씨가 된다더니 이 포스팅 끝나고 fetch 강제로 해서 업데이트 상황 다운 받으려다 망했다.</p>
<p>무섭다 정말..ㅠㅠㅠㅠㅠㅠㅠㅠ</p>
<p>깃 제대로 배워야겠다 진짜 ㅠㅠ</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-8999ddb29437782cf315b76d5d5a00ab">ihanxing application 구현</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2016-07-23" class="text-muted">2016.07.23</time>
        
	</div>
	<p>일단 이 web application은 model이 celebrity, posts, timelines, schedules, favorites, user, tips으로 많았다. 여기서 가장 중요했던 것은 모델들 관의 관계였는데, 모델이 많다보니 controller를 각각 1개씩 만들었다. 내겐 scaffold가 훨씬 편했기 때문에 user빼고는 모두 scaffold로 제작하였다. 일전에 posting했던 누워서 scaffold application 만들기는 강의평가사이트였는데 모델이 딱 두개라 professor_evaluations_path(pro) 로 pro라는 교수 객체를 던져 professor/professor_id/evaluations, 즉 해당 id의 교수 평가를 조회할 수 있었다.</p>
<p>하지만 ihanxing application의 경우 연예인 personal page에서 timeline, schedule, post를 모두 확인하고 싶었기 때문에 (action의 이동이 없었다) celebrities/celebrity_id/timelines 보다는, celebrities/celebrity_id 로 celebrity 모델의 show 액션에서 모든 모델들을 보여주는 방식을 택했다.</p>
<p>일단 route 를 확인해보자.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#000">root</span> <span style="color:#4e9a06">&#39;celebrities#index&#39;</span>

  <span style="color:#000">devise_for</span> <span style="color:#4e9a06">:users</span>

  <span style="color:#000">get</span> <span style="color:#4e9a06">&#39;home/mypage&#39;</span> <span style="color:#ce5c00;font-weight:bold">=&gt;</span> <span style="color:#4e9a06">&#39;/mypage&#39;</span>

  <span style="color:#000">resources</span> <span style="color:#4e9a06">:tips</span>

  <span style="color:#000">resources</span> <span style="color:#4e9a06">:celebrities</span> <span style="color:#204a87;font-weight:bold">do</span>
    <span style="color:#000">resources</span> <span style="color:#4e9a06">:schedules</span>
    <span style="color:#000">resources</span> <span style="color:#4e9a06">:timelines</span>
    <span style="color:#000">resources</span> <span style="color:#4e9a06">:posts</span>
  <span style="color:#204a87;font-weight:bold">end</span>
</code></pre></div><p><img src="/assets/images/1.png" alt="Sample Image">
route와 image에서 볼수 있듯이 모델의 관계는 저렇게 정의 되어있다. celebrity와 1:N 관계에있는 세개의 모델, user와 M:N 관계를 형성하는 celebrity, 그 관계를 구현하기위한 favorite 모델이 존재한다. 마지막으로 독립적으로 존재하는 tips 모델.</p>
<p>이제 실제 코드를 살펴보자.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby">
 <span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">index</span>
    <span style="color:#204a87;font-weight:bold">unless</span> <span style="color:#000">user_signed_in?</span>
      <span style="color:#000">redirect_to</span> <span style="color:#4e9a06">&#39;/users/sign_in&#39;</span>
    <span style="color:#204a87;font-weight:bold">end</span>
    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">user_signed_in?</span>
      <span style="color:#000">$stars</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">current_user</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">celebrities</span>
    <span style="color:#204a87;font-weight:bold">end</span>
    <span style="color:#000">@celebrities</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Celebrity</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">all</span>

  <span style="color:#204a87;font-weight:bold">end</span>

  <span style="color:#8f5902;font-style:italic"># GET /celebrities/1</span>
  <span style="color:#8f5902;font-style:italic"># GET /celebrities/1.json</span>
  <span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">show</span>
    <span style="color:#000">@timelines</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">@celebrity</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">timelines</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">all</span>
    <span style="color:#000">@schedules</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">@celebrity</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">schedules</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">all</span>
    <span style="color:#000">@posts</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">@celebrity</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">posts</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">all</span>
  <span style="color:#204a87;font-weight:bold">end</span>

</code></pre></div><p>if user_signed_in? 사용자가 로그인 되어있으면 현재 유저의 연결된 celebrities를 호출할 수 있다. 두 모델이 M:N으로 연결되어있기에 가능한 것이다.</p>
<p>마찬가지로 show action에서 해당 연예인의 타임라인 스케줄 포스트를 모두 호출 가능하다. 1:N으로 연결해놓았기 때문이다. 그렇다면 @celebrity는 어디서 오는가?</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby">
<span style="color:#000">before_action</span> <span style="color:#4e9a06">:set_celebrity</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">only</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">[</span><span style="color:#4e9a06">:show</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">:edit</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">:update</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">:destroy</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">:goods</span><span style="color:#ce5c00;font-weight:bold">]</span>
    <span style="color:#ce5c00;font-weight:bold">~</span>
<span style="color:#204a87;font-weight:bold">private</span>
  <span style="color:#8f5902;font-style:italic"># Use callbacks to share common setup or constraints between actions.</span>
  <span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">set_celebrity</span>
    <span style="color:#000">@celebrity</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Celebrity</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">find</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">params</span><span style="color:#ce5c00;font-weight:bold">[</span><span style="color:#4e9a06">:id</span><span style="color:#ce5c00;font-weight:bold">]</span><span style="color:#000;font-weight:bold">)</span>
  <span style="color:#204a87;font-weight:bold">end</span>
</code></pre></div><p>id로 해당 연예인을 찾는다. 아마 디테일 버튼 등을 누르면 celebrity 객체가 날라가고, 자동적으로 그는 id를 날리기 때문에(변경가능한 설정) set_celebrity action을 먼저 수행할 수 있다.
예를 들어,&lsquo;celebrity_path(cb)&rsquo; cb는 @celebrities.each do |cb|의 cb이다.</p>
<p>이제 celebrity의 show 액션으로 들어오면 프로필, 타임라인, 스케줄, &hellip;이 있다. 이는 tab으로 넘기게 구현하였다. default는 timeline이다.
timeline, schedule는 모두 관리자가 데이터베이스를 업데이트하는 문제여서 별다른 action들을 사용할 필요가 없었다. 게시판은 직접 유저가 글을 올려야했기에,</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#ce5c00;font-weight:bold">&lt;%=</span><span style="color:#000">link_to</span> <span style="color:#4e9a06">&#39;write&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">new_celebrity_post_path</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">@celebrity</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#4e9a06">class</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#39;btn btn-success text-uppercase waves&#39;</span> <span style="color:#ce5c00;font-weight:bold">%&gt;</span>
</code></pre></div><p>celebrities/celebrity_id/posts/new로 가게되어 post의 new 액션이 수행된다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="color:#a40000">&lt;</span>%= form_for(post,url: celebrity_posts_path) do |f| %&gt;
생략.
  <span style="color:#000;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">div</span> <span style="color:#c4a000">class</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;field&#34;</span><span style="color:#000;font-weight:bold">&gt;</span>
    <span style="color:#a40000">&lt;</span>%= f.hidden_field :user_id, :value =&gt; current_user.id %&gt;
    <span style="color:#a40000">&lt;</span>%= f.hidden_field :celebrity_id, :value =&gt; @celebrity.id %&gt;
  <span style="color:#000;font-weight:bold">&lt;/</span><span style="color:#204a87;font-weight:bold">div</span><span style="color:#000;font-weight:bold">&gt;</span>
<span style="color:#a40000">&lt;</span>% end %&gt;
</code></pre></div><p>user_id, celebrity_id가 hidden field로 전송된다. 그 값은 각각 현재 접속 유저, set_celebrity로 찾아진 해당 연예인의 id이다.
routing의 경우, helper, path의 적극 사용으로 이런 hidden field 사용이 필요 없었으나, 직접 업로드를 가능하게 해야하는 post의 특성상 이렇게 hidden field를 사용할 수 밖에 없었다.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-cbe3298bd4273627ce522120428bedf2">rails 5 업데이트!</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2016-07-21" class="text-muted">2016.07.21</time>
        
	</div>
	<h1 id="지상-최고-생산성-프레임워크-rails-파이팅">지상 최고 생산성 프레임워크 rails 파이팅!!</h1>
<blockquote>
<p><strong>일단 영어 원문을 올려 놓습니다&hellip;언젠간 번역할거니까&hellip;</strong></p>
</blockquote>
<p><em>Rails 5.0: Action Cable, API mode, and so much more</em></p>
<p>레일즈 5.0이 출시되었습니다. 역시 바로 바로 업그레이드 해줘야겠죠. 본 포스팅에서 제시하는 업그레이드법은 rails 4.2.0 이상에서 업그레이드 할때입니다. 전 4.2.5에서 업그레이드 했습니다. rails -v로 버전을 확인해보세요.</p>
<p>공식홈페이지에 따르면, 4번의 베타를 거친 끝에 드디어 5.0이 제대로 release되었다고 합니다. 가장 완전한 버전이라 확신한다고 하네요!가장 두드러진 특징 두 가지 먼저!</p>
<blockquote>
<p>Action Cable은 rails에서 web socket을 다룰때 필요한 framework라고 합니다. server-side를 위한 channel layer와 client-side를 위한 javascript layer를 이어준다고 하는데</p>
</blockquote>
<p><em>뭔소리다냐? 실시간 채팅이나 알림을 쉽게 해준다고 하는데, web socket을 공부해야 할듯합니다 Basecamp3는 또 뭘까요 ㅋㅋㅋ</em></p>
<blockquote>
<p>action cable이 진짜 사랑스러운 건 당신의 웹 소켓 작업에서 active record와 poro에 접근할 수 있다는 것입니다.</p>
</blockquote>
<p><em>디비에 접근 가능하단 건가?</em></p>
<blockquote>
<p>개발시에, action cable은 당신의 앱 나머지와 in process로 실행됩니다. 그걸 위해 기본 서버 환경을 webbrick에서 puma로 바꿨다고 하네요. production 시에는 action cable server가 각자 process에서 실행되도록 원할 수 있다. 그게 basecamp에서 우리가 하는 거다.</p>
</blockquote>
<p><em>점점 미궁에 빠지고 있습니다.</em></p>
<p>API mode</p>
<p>api가 무슨 뜻인지 올해초에 알게되었고 수업을 들으면 서 많이 접하게 되었죠. Application Programming Interface로 아랫단쪽(운영체제등)에서 윗단이 아랫단 신경안쓰고 편하게 쓸수 있도록 제공하는 interface입니다. framework와 비슷한 맥락에서 나온 개념이지용.
Rails is not only a great choice when you want to build a full-stack application that uses server-side rendering of HTML templates, but also a great companion for the new crop of client-side JavaScript or native applications that just needs the backend to speak JSON. We’ve made this even clearer now with the new –api mode. If you create a new Rails application using rails new backend &ndash;api, you’ll get a slimmed down skeleton and configuration that assumes you’ll be working with JSON, not HTML.</p>
<p>There’s still more work to be done on this feature, but we’re off to a great start. By default, API mode just relies on #to_json calls on model classes. But you can either use Jbuilder, Active Model Serializers, or look at the new JSONAPI::Resources project for a more advanced solution.</p>
<p>Thanks in particular to Santiago Pastorino and Jorge Bejar for making this happen.</p>
<p><strong>다른 주요 업데이트 사항!</strong></p>
<p>이제 rake db:migrate 아니고 rails db:migrate입니다. 헷갈리셨던 분들께 좋은 소식일듯하네요!
test runner가 이제 실패를 inline으로 report하기 때문에 뭐가 문젠지 살피기 위해 suite를 완료할 필요가 없답니다.
application record라는 모든 모델들에대한 부모 class가 새로 생긴듯합니다.
ActiveRecord::Relation#in_batches makes it much easier to deal with record work in batches at a time to lessen memory overloads.
관계정의에 in_batches가 생겨서 악 뭔소리지??
Post.where(‘id = 1’).or(Post.where(‘id = 2’)) gives you exactly what you’d think!
rails console창에서 Celebrity.find_by(id:1)이렇게 했던거랑 비슷한걸까요.
예전엔 이게 안됬나? where로 id찾는거였던것 같은데??</p>
<p>No more accidentally halting Active Record callbacks because the last statement is false. Now you throw(:abort) explicitly!
이것도 뭔소린지&hellip;</p>
<p>언급되지 않은 업데이트들로 여러 changelog들이 link되어 있습니다.(mailer model record등 다양하네요)</p>
<p>Rails 5.0 also ships with Turbolinks 5 – the one with native iOS and Android wrapper implementations! If you’ve dismissed Turbolinks in the past,
I urge you to checkout Sam Stephenson’s RailsConf presentation: Turbolinks 5: I Can’t Believe It’s Not Native!.</p>
<p>rails update하기!</p>
<p>gemfile에</p>
<p>gem &lsquo;rails&rsquo;, &lsquo;~&gt; 5.0&rsquo;</p>
<h1 id="bundle-edge-rails-instead-gem-rails-github-railsrails">Bundle edge Rails instead: gem &lsquo;rails&rsquo;, github: &lsquo;rails/rails&rsquo;</h1>
<p>해주고 bundle!</p>
<p>그 뒤 rails app:update를 수행해주자.</p>
<p>몇개 overwrite하면 update 완료!</p>
<p>주의 devise가 안 먹히는 문제가 있었습니다.
user.rb에
&lsquo;extend Devise::Models&rsquo;
gemfile에
gem &lsquo;devise&rsquo;, :github =&gt; &lsquo;plataformatec/devise&rsquo;, :branch =&gt; &lsquo;master&rsquo;
로 추가 해주니 다시 되더군요 주의하시길 바랍니다.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-0f1702d99fad7a7b711511ba50bfa864">밤샘 코딩! 드디어 완성.(0802 수정)</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2016-07-21" class="text-muted">2016.07.21</time>
        
	</div>
	<h2 id="드디어-ihanxing-rails-application">드디어 ihanxing rails application</h2>
<h2 id="기능-대부분-구현">기능 대부분 구현.</h2>
<p>일단 user와 celebrity를 연결하는 (M:N관계) favorite이라는 table을 generate하였고, 그 과정에서
&lsquo;has_many :celebrities, through: :favorites&rsquo;을 사용!</p>
<p>일단 favorite 테이블의 코드를 살펴보자.</p>
<p>{%highlight ruby%}
class CreateFavorites &lt; ActiveRecord::Migration
def change
create_table :favorites, id: false do |t|
t.integer :celebrity_id
t.integer :user_id</p>
<pre><code>  t.timestamps null: false
end
</code></pre>
<p>end</p>
<p>end</p>
<pre><code>
코드를 보면 celebrity_id, user_id가 뭘 의미하는지 느낌이 올겁니다. M:N관계를 구현하기 위해 user외 celebrity를 연결하는 장치죠. 각 테이블의 primary key가 favorite table의 foriegn key인 셈입니다. 동시에 그 두 개의 key는 favorite 의 composite primary key입니다. 두 개의 column이 primary key역할을 하는 거죠. 저렇게 되어야지만 unique조건을 만족합니다. 연예인 1명에 몇명의 유저가 좋아할 수도 있고, 한 유저가 다양한 연예인을 좋아할 수도 있기 때문이죠. 하지만 특정 유저가 특정 연예인을 좋아하는 row가 겹치면 안되기 때문에 composite primary key를 도입한겁니다. favorite 자체의 id는 key 역할을 하면 안되겠죠?
'id: false' 조건을 도입한 이유입니다.

{%highlight ruby%}
rails g migration AddIndexToFavorites
</code></pre><p>이 명령어로 migration 파일을 생성한뒤 해당 파일을 이렇게 수정해줍시다.</p>
<p>{%highlight ruby%}
class AddIndexToFavorites &lt; ActiveRecord::Migration
def change
add_index :favorites, [:user_id, :celebrity_id], unique: true
end
end</p>
<pre><code>
이렇게 수정하준뒤

{%highlight ruby%}
rake db:migrate
</code></pre><p>마이그레이트 수행하면! schema.rb가 수정될겁니다.</p>
<p>celebrity.rb
{%highlight ruby%}
has_many :favorites
has_many :user, through: :favorites
{%endhighlight%}</p>
<p>favorite.rb
{%highlight ruby%}
belongs_to :user
belongs_to :celebrity
{%endhighlight%}</p>
<p>user.rb
{%highlight ruby%}
has_many :favorites
has_many :celebrities, through: :favorites
{%endhighlight%}</p>
<p>추가해주면! 완료입니다&hellip;구현은!</p>
<p>간단한 사용법을 안내해드리면~!</p>
<p>{%highlight ruby%}
current_user.favorites.create(celebrity: @celebrity)
{%endhighlight%}</p>
<p>현재 유저가 좋아하는 스타를 즐겨찾기에 넣고 싶을 때! 버튼을 클릭하면 자동으로 넣어지게 하기 위해 짠 코드입니다. user가 연결되어있는 celebrity는 객체로 받아왔습니다.</p>
<p>쉽쬬?</p>
<p>bar에 항상 떠있는 view입니다.(application.html.erb)</p>
<p>{%highlight html%}
&lt;%if user_signed_in?%&gt;
&lt;%$stars.each do |s|%&gt;
<li>&lt;%= link_to s.name, celebrity_timelines_path(s), class:&lsquo;a&rsquo;%&gt;</li>
&lt;%end%&gt;
&lt;%end%&gt;
{%endhighlight%}</p>
<p>$stars라는 괴이한 변수를 선언했는데, 페이지가 이동해도 계속 유지되어야 하기 때문에 전역변수로 설정해서입니다.</p>
<p>{%highlight ruby%}
if user_signed_in?
$stars=current_user.celebrities
end
{%endhighlight%}</p>
<p>celebrity_controller에 이렇게 변수를 선언했습니다. favorite으로 연결되어있기때문에 저렇게 .celebrities로 호출이 가능한것이죠.</p>
<p>이제 사용자별 즐겨찾기 스타 설정 가능! 흐..드디어!</p>
<p>p.s 좋아요 기능 찾아봤는데 그게 진짜 어렵다.(ajax 때문에..)</p>
<p>$stars가 아무래도 걸려서.. 결국 수정하였습니다! applicationcontroller에서</p>
<p>{%highlight ruby%}
class ApplicationController &lt; ActionController::Base</p>
<h1 id="prevent-csrf-attacks-by-raising-an-exception">Prevent CSRF attacks by raising an exception.</h1>
<h1 id="for-apis-you-may-want-to-use-null_session-instead">For APIs, you may want to use :null_session instead.</h1>
<p>protect_from_forgery with: :exception
ActiveSupport.halt_callback_chains_on_return_false = false
before_action :set_variable</p>
<p>def set_variable
if user_signed_in?
@stars=current_user.celebrities
end
end</p>
<p>end
{%endhighlight%}
로 set variable이라는 action를 만든후, @stars에 current_user의 연예인들을(favorite으로 연결되어있습니다) 호출하여 집어넣었다.
application controller이기 때문에 모든 controller에 적용된다. 하지만 주 목적은 layout 에 application.html.erb 에 적용시키기 위해 해당 controller에 넣었다. before_action로 무조건 set_variable을 실행하게 하였다.
따라서! application.html.erb에서 사용가능하게 되었다! 이렇게 쉬운걸 $stars라는 이상한 전역변수를 만들었다니! 아는 대로 보인다더니..암튼!</p>
<p>이걸 해결하고 나니 더 중대한 문제를 발견했다. 물론 변수 형태를 바꿔서 생긴 문제는 아니었고, 원래 문제였는데 지금 밝혀진것&hellip;상세페이지를 방문하면&hellip;무조건 favorite에 추가가 된다&hellip;도대체 왜&hellip;일단 고쳐야겠다는 생각이 들어
&lsquo;onclick=&lt;%current_user.favorites.create(celebrity: @celebrity)%&gt;&lsquo;부터 고쳤다. 얘를 고치고 대신</p>
<p>{%highlight html%}</p>
<div class="profile-userbuttons">
          <button class="btn btn-danger btn-lg" onclick="favorite()" data-toggle="popover" data-content="등록 완료!" data-placement="top"><i class="fa fa-star-o"></i> Favorite</button>
        </div>
        <script>
          function favorite() {
            var xhttp;
            xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function() {
              if (xhttp.readyState == 4 && xhttp.status == 200) {
                document.getElementById("txtHint").innerHTML = xhttp.responseText;
              }
            };
            xhttp.open("GET", "/favorite/<%=@celebrity.id%>", true);
            xhttp.send();
          }
        </script>
<p>{%endhighlight%}
이런식으로 view파일을 수정했다. ajax를 사용한 셈이다. 즉, click 되면 favorite()이란 함수를 수행하여,</p>
<p>xhttp.open(&ldquo;GET&rdquo;, &ldquo;/favorite/&lt;%=@celebrity.id%&gt;&rdquo;, true); GET 방식으로 접속하였다</p>
<p>routing을 get &lsquo;favorite/:id&rsquo; =&gt; &lsquo;celebrity#favorite&quot;로 설정하여 해당 연예인의 id를 전달한 셈이 된다.</p>
<p>controller를 보면</p>
<p>favorite이란 새로운 action 을 celebrity controller에 만들고! favorite 추가해주는 코드를 여기에다 넣었다.</p>
<p>{%highlight ruby%}
def favorite
current_user.favorites.create(celebrity: @celebrity)
end
{%endhighlight%}</p>
<p>@celebrity= Celebrity.find(:id)로 해당 연예인을 찾았다. routing이 /:id으로 되어있기 때문에 가능한 일이다.</p>
<p>여기서 @celebrity는 before_action :set_celebrity에서 찾은건데</p>
<p>routing을 get &lsquo;favorite/:id&rsquo; =&gt; &lsquo;celebrity#favorite&quot;로 설정하여 @celebrity= Celebrity.find(:id)로 해당 연예인을 찾았다.</p>
<p>끝!</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-6ab789de5358a44d422e80b06e7e96a5">jekyll blog를 처음 시작하며</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2016-07-19" class="text-muted">2016.07.19</time>
        
	</div>
	<p>지킬 블로그는 사실 정말 좋습니다. 사실 정적(static) 블로그에 대한 개념도 정확하지 않고 무슨 소린지는 차차 알아나가야 하겠지만,</p>
<p>일단 1. github pages에서 무료 호스팅을 제공한다는 점. 2. 개발블로그로써 조금 더 적합하다는 점 에서 다른 블로그보다 지킬을 쓰게 되는 것같습니다.</p>
<p>이 블로그를 시작하면서 워낙 컴퓨터 전공자지만 개발에는 입문 수준이라 삽질을 여러번 하였기에 설치 과정을 포스팅 할까 하였으나 저보다 훨씬 더 잘 설명하시는 블로그(nolboo님의 블로그를 추천합니다)가 많기에 기본적 설치는 포스팅하지 않겠습니다. 단지 간단히 설명하자면 jekyll을 설치하고 github_ID.github.io라는 이름으로 프로젝트/repository를 동시에 만든 후에 master branch로 커밋, push 완료 후 조금(생각보다 오래 걸릴수도 있습니다) 기다리시면 완성되어 있을 것입니다. 사실 매우 간단한데 이 과정에서도 저처럼 삽질을 하는 사람이 있더라구요.</p>
<p>지킬 테마는 여러가지 존재하고 제 테마의 경우에는 &lsquo;<a href="https://github.com/SalGnt'">https://github.com/SalGnt'</a>에서 fork 해온 테마입니다.</p>
<p>개인적으로 힘들었던 부분인 comment 추가 부분에 대해서 말씀드리겠습니다. 이것도 사실 엄청 간단한데 ㅠㅠ 한국어 블로그들 보면서 삽질하다가 결국 영어 블로그 하나로 5분만에 해결했는데요.</p>
<p>댓글 시스템은 두가지가 가능합니다. 1. facebook 2. disqus 1번의 단점은 facebook 로그인을 해야한다는것&hellip;그래서 어쩔수 없이 disqus에 가입 한후 install 절차를 수행하였습니다.</p>
<p>universal code를 클릭하면 제공되는 코드를 이용하였는데요. comments.html를 _includes 폴더 안에 넣어 두었지요. 물론 comments.html에는 해당 universal code가 들어있습니다.</p>
<p>일단 config.yml에서 disqus_shortname=제 disqus 계정의 username 을 쓰고</p>
<p>post.html에</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">{% if site.disqus_shortname %}
  {% include comments.html %}
{% endif %}
</code></pre></div><p>이런식으로 추가해주었습니다. 몇시간을 삽질 하던게 이거 한방에 해결되었습니다. ㅠㅠㅠㅠㅠㅠㅠㅠ</p>
<p>아무튼 지킬 화이팅~~.</p>
<p>&ndash;추가 (2016.08.15 광복절)</p>
<p>google search console에 내 사이트를 등록할 수 있습니다. 안내하는 몇가지 절차를 걸치면 구글에 제 블로그를 검색했을 때 제대로 검색되게 만들 수 있습니다.</p>
<p>등록을 완료하면 메일도 오구요!</p>
<p>최근에 Search Console에서 사이트를 확인(또는 사이트를 자동으로 확인하는 Blogger나 Google 사이트 도구에서 사이트 생성)한 것으로 Google 시스템에 표시됩니다.</p>
<p>console에 사이트가 등록되면 추가적으로 sitemap을 등록할 수 도 있습니다. sitemap.xml을 등록하면 되는데 jekyll의 경우에는 gem이 존재합니다. 따라서 자동으로 생성해주고, 제 경우에는 sitemap error가 떠서 살펴봤더니 xml의 url에 https://가 빠져있었기 때문이었습니다. 주의하시길 바랍니다!</p>
<p>이제 검색이 되네요! &gt;ㅇ&lt; 밑에는 sitemap.xml에 등록한 내용이 출력되는걸 보실수 있습니다.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-643b127f60871dc652e6c8b53da03e3b">scaffold로 Rails application 누워서 만들기</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2016-07-19" class="text-muted">2016.07.19</time>
        
	</div>
	<p>scaffold로 쉽게 rails application을 만드는 걸 접했을땐 정말 신세계였습니다&hellip;와..대박이당&hellip;!</p>
<p>이제 여러분께 그 경험을 나누려고 합니다.</p>
<h2 id="오늘은-scaffold로-수강평가사이트를-만들어-보겠습니다">오늘은 scaffold로 수강평가사이트를 만들어 보겠습니다!</h2>
<p>일단 과목 정보를 담은 table, 과목에 대한 평가를 담은 evaluation table 두개가 필요합니다.</p>
<p>두 개의 테이블은 1:N 관계가 되겠죠.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">rails g scaffold subject name:string professor:string place:string semester:string
rails g scaffold evaluation title:string author:string content:text subject_id:integer
</code></pre></div><p>여기까지 하고! 이제 subject, evaluation이란 이름으로 model controller view가 동시에 생성됩니다.</p>
<p>각 모델마다 controller view를 갖게 되는 것이지요. 게다가 실제 코드를 보면 미리 일부 코드가 작성되어있는것을 볼 수 있습니다.</p>
<p>일단 아래 코드로 evaluation table 과 subject table의 관계를 정의하겠습니다. evaluation table을 먼저 봅시다</p>
<p>evaluation.rb</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#000">belongs_to</span> <span style="color:#4e9a06">:subject</span>

<span style="color:#000">validates</span> <span style="color:#4e9a06">:name</span><span style="color:#000;font-weight:bold">,</span>  <span style="color:#4e9a06">:presence</span> <span style="color:#ce5c00;font-weight:bold">=&gt;</span> <span style="color:#204a87;font-weight:bold">true</span>
<span style="color:#000">validates</span> <span style="color:#4e9a06">:title</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">:presence</span> <span style="color:#ce5c00;font-weight:bold">=&gt;</span> <span style="color:#204a87;font-weight:bold">true</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#4e9a06">:length</span> <span style="color:#ce5c00;font-weight:bold">=&gt;</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">:minimum</span> <span style="color:#ce5c00;font-weight:bold">=&gt;</span> <span style="color:#0000cf;font-weight:bold">5</span> <span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>validates 문 같은 경우에는, name을 반드시 작성, title의 경우에는 반드시 작성해야하고 길이가 최소 5자 이상이어야 한다는 조건입니다. 저 조건을 만족하여야지, evaluation table이 제대로 create/update 된다는 것입니다.</p>
<p>subject.rb</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#000">has_many</span> <span style="color:#4e9a06">:evaluations</span>
</code></pre></div><p>이제 controller를 보겠습니다 controller는 어떤 블로그에서 본 표현인데 정말 적절하여 빌려씁니다. &ldquo;컨트롤러는 URL 요청을 들어올 때 특정 url pattern에 해당되는 메소드와 매핑하여 필요한 Model과 또는 특정 작업을 처리한 이후에 관련된 View를 랜더링시켜서 데이터와 함께 view를 호출하는 곳이다. &quot;
크으&hellip;</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">SubjectsController</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">ApplicationController</span>
 <span style="color:#000">before_action</span> <span style="color:#4e9a06">:set_subject</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">only</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">[</span><span style="color:#4e9a06">:show</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">:edit</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">:update</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">:destroy</span><span style="color:#ce5c00;font-weight:bold">]</span>
    <span style="color:#8f5902;font-style:italic"># GET /subjects</span>
    <span style="color:#8f5902;font-style:italic"># GET /subjects.json</span>
   <span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">index</span>
     <span style="color:#000">@subjects</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">subject</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">all</span>
   <span style="color:#204a87;font-weight:bold">end</span>

   <span style="color:#8f5902;font-style:italic"># GET /subjects/1</span>
   <span style="color:#8f5902;font-style:italic"># GET /subjects/1.json</span>
   <span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">show</span>
   <span style="color:#204a87;font-weight:bold">end</span>

   <span style="color:#8f5902;font-style:italic"># POST /subjects</span>
   <span style="color:#8f5902;font-style:italic"># POST /subjects.json</span>
   <span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">create</span>
     <span style="color:#000">@subject</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">subject</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">new</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">subject_params</span><span style="color:#000;font-weight:bold">)</span>

     <span style="color:#000">respond_to</span> <span style="color:#204a87;font-weight:bold">do</span> <span style="color:#ce5c00;font-weight:bold">|</span><span style="color:#204a87">format</span><span style="color:#ce5c00;font-weight:bold">|</span>
       <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">@subject</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">save</span>
         <span style="color:#204a87">format</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">html</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">redirect_to</span> <span style="color:#000">@subject</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">notice</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;subject was successfully created.&#39;</span> <span style="color:#000;font-weight:bold">}</span>
         <span style="color:#204a87">format</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">json</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">render</span> <span style="color:#4e9a06">:show</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">status</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">:created</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">location</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000">@subject</span> <span style="color:#000;font-weight:bold">}</span>
       <span style="color:#204a87;font-weight:bold">else</span>
         <span style="color:#204a87">format</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">html</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">render</span> <span style="color:#4e9a06">:new</span> <span style="color:#000;font-weight:bold">}</span>
         <span style="color:#204a87">format</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">json</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">render</span> <span style="color:#4e9a06">json</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000">@subject</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">errors</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">status</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">:unprocessable_entity</span> <span style="color:#000;font-weight:bold">}</span>
       <span style="color:#204a87;font-weight:bold">end</span>
     <span style="color:#204a87;font-weight:bold">end</span>
   <span style="color:#204a87;font-weight:bold">end</span>

   <span style="color:#8f5902;font-style:italic"># PATCH/PUT /subjects/1</span>
   <span style="color:#8f5902;font-style:italic"># PATCH/PUT /subjects/1.json</span>
   <span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">update</span>
     <span style="color:#000">respond_to</span> <span style="color:#204a87;font-weight:bold">do</span> <span style="color:#ce5c00;font-weight:bold">|</span><span style="color:#204a87">format</span><span style="color:#ce5c00;font-weight:bold">|</span>
       <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">@subject</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">update</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">subject_params</span><span style="color:#000;font-weight:bold">)</span>
         <span style="color:#204a87">format</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">html</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">redirect_to</span> <span style="color:#000">@subject</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">notice</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;subject was successfully updated.&#39;</span> <span style="color:#000;font-weight:bold">}</span>
         <span style="color:#204a87">format</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">json</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">render</span> <span style="color:#4e9a06">:show</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">status</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">:ok</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">location</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000">@subject</span> <span style="color:#000;font-weight:bold">}</span>
       <span style="color:#204a87;font-weight:bold">else</span>
         <span style="color:#204a87">format</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">html</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">render</span> <span style="color:#4e9a06">:edit</span> <span style="color:#000;font-weight:bold">}</span>
         <span style="color:#204a87">format</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">json</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">render</span> <span style="color:#4e9a06">json</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000">@subject</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">errors</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">status</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">:unprocessable_entity</span> <span style="color:#000;font-weight:bold">}</span>
       <span style="color:#204a87;font-weight:bold">end</span>
     <span style="color:#204a87;font-weight:bold">end</span>
   <span style="color:#204a87;font-weight:bold">end</span>

   <span style="color:#8f5902;font-style:italic"># DELETE /subjects/1</span>
   <span style="color:#8f5902;font-style:italic"># DELETE /subjects/1.json</span>
   <span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">destroy</span>
     <span style="color:#000">@subject</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">destroy</span>
     <span style="color:#000">respond_to</span> <span style="color:#204a87;font-weight:bold">do</span> <span style="color:#ce5c00;font-weight:bold">|</span><span style="color:#204a87">format</span><span style="color:#ce5c00;font-weight:bold">|</span>
       <span style="color:#204a87">format</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">html</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">redirect_to</span> <span style="color:#000">subjects_url</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">notice</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;subject was successfully destroyed.&#39;</span> <span style="color:#000;font-weight:bold">}</span>
       <span style="color:#204a87">format</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">json</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">head</span> <span style="color:#4e9a06">:no_content</span> <span style="color:#000;font-weight:bold">}</span>
     <span style="color:#204a87;font-weight:bold">end</span>
   <span style="color:#204a87;font-weight:bold">end</span>

 <span style="color:#204a87;font-weight:bold">private</span>
    <span style="color:#8f5902;font-style:italic"># Use callbacks to share common setup or constraints between actions.</span>
    <span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">set_subject</span>
      <span style="color:#000">@subject</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">subject</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">find</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">params</span><span style="color:#ce5c00;font-weight:bold">[</span><span style="color:#4e9a06">:id</span><span style="color:#ce5c00;font-weight:bold">]</span><span style="color:#000;font-weight:bold">)</span>
    <span style="color:#204a87;font-weight:bold">end</span>

    <span style="color:#8f5902;font-style:italic"># Never trust parameters from the scary internet, only allow the white list through.</span>
    <span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">subject_params</span>
      <span style="color:#000">params</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">fetch</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">:subject</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">{})</span>
    <span style="color:#204a87;font-weight:bold">end</span>

<span style="color:#204a87;font-weight:bold">end</span>
</code></pre></div><p>보시면 알겠지만 코드가 다 미리 짜져있습니다..헉! scaffold란 이런것입니다 여러분!</p>
<p>기본적인 crud가 구현이 되어있고 주석처리 되어 있는 부분은 기본 routing 되어있는 것입니다. 가장 첫줄의
&lsquo;before_action :set_subject, only: [:show, :edit, :update, :destroy]&rsquo;
의 경우에는 해당 action 수행 전에 set_subject 액션을 먼저 수행해라. 즉, 밑에 보시면 알겠지만, id로 먼저 해당 과목을 찾고 @subject에 집어 넣는다. 그렇다면 params[:id]는 어디서 오는가? 바로 view 파일에서 옵니다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="color:#a40000">&lt;</span>% @subjects.each do |s| %&gt;
<span style="color:#000;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">div</span> <span style="color:#c4a000">class</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;col-sm-6 col-md-4&#34;</span><span style="color:#000;font-weight:bold">&gt;</span>
	<span style="color:#000;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">h3</span><span style="color:#000;font-weight:bold">&gt;</span><span style="color:#a40000">&lt;</span>%=cb.name%&gt;<span style="color:#000;font-weight:bold">&lt;/</span><span style="color:#204a87;font-weight:bold">h3</span><span style="color:#000;font-weight:bold">&gt;</span>
	<span style="color:#000;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">p</span><span style="color:#000;font-weight:bold">&gt;</span>
	<span style="color:#a40000">&lt;</span>%= link_to &#39;evaluation&#39;, subject_evaluations_path(s), class:&#39;btn btn-primary waves&#39; %&gt;
</code></pre></div><p>여기를 주목해보면 이거는 subject/:id/evaluations로 이동하게 됩니다.(rake routes 참고) method는 get이구요! 즉 해당 과목의 객체를 보내면(s)자동으로 id가 전송되는 것이지요. 그래서 controller에서 params[:id]로 해당 과목을 받을 수 있었던 겁니다. 이 방법을 통해 해당 과목에 대한 평가를 조회할 수 있습니다.</p>
<p>또 하나 중요한 부분은 routing을 봅시다</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#000">Rails</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">application</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">routes</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">draw</span> <span style="color:#204a87;font-weight:bold">do</span>
  <span style="color:#8f5902;font-style:italic"># see http://guides.rubyonrails.org/routing.html</span>
    <span style="color:#000">root</span> <span style="color:#4e9a06">&#39;subjects#index&#39;</span>
    <span style="color:#000">devise_for</span> <span style="color:#4e9a06">:users</span>

    <span style="color:#000">resources</span> <span style="color:#4e9a06">:subjects</span> <span style="color:#204a87;font-weight:bold">do</span>
      <span style="color:#000">resources</span> <span style="color:#4e9a06">:evaluations</span>
    <span style="color:#204a87;font-weight:bold">end</span>
<span style="color:#204a87;font-weight:bold">end</span>
</code></pre></div><p>마지막 resources에서 subject와 evaluation 사이의 종속 관계를 알 수 있습니다. rake routes를 해보시면 알겠지만 저 조치로 인해,</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby">  <span style="color:#000">subject_evaluations</span>    <span style="color:#000">GET</span>    <span style="color:#4e9a06">/celebrities/</span><span style="color:#4e9a06">:subject_id</span><span style="color:#ce5c00;font-weight:bold">/</span><span style="color:#000">evaluations</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#4e9a06">:format</span><span style="color:#000;font-weight:bold">)</span>          <span style="color:#000">evaluations</span><span style="color:#8f5902;font-style:italic">#index</span>
                         <span style="color:#000">POST</span>   <span style="color:#4e9a06">/celebrities/</span><span style="color:#4e9a06">:subject_id</span><span style="color:#ce5c00;font-weight:bold">/</span><span style="color:#000">evaluations</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#4e9a06">:format</span><span style="color:#000;font-weight:bold">)</span>          <span style="color:#000">evaluations</span><span style="color:#8f5902;font-style:italic">#create</span>
  <span style="color:#000">new_subject_evaluation</span> <span style="color:#000">GET</span>    <span style="color:#4e9a06">/celebrities/</span><span style="color:#4e9a06">:subject_id</span><span style="color:#ce5c00;font-weight:bold">/</span><span style="color:#000">evaluations</span><span style="color:#ce5c00;font-weight:bold">/</span><span style="color:#204a87;font-weight:bold">new</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#4e9a06">:format</span><span style="color:#000;font-weight:bold">)</span>      <span style="color:#000">evaluations</span><span style="color:#8f5902;font-style:italic">#new</span>
 <span style="color:#000">edit_subject_evaluation</span> <span style="color:#000">GET</span>    <span style="color:#4e9a06">/celebrities/</span><span style="color:#4e9a06">:subject_id</span><span style="color:#ce5c00;font-weight:bold">/</span><span style="color:#000">evaluations</span><span style="color:#ce5c00;font-weight:bold">/</span><span style="color:#4e9a06">:id</span><span style="color:#ce5c00;font-weight:bold">/</span><span style="color:#000">edit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#4e9a06">:format</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000">evaluations</span><span style="color:#8f5902;font-style:italic">#edit</span>
      <span style="color:#000">subject_evaluation</span> <span style="color:#000">GET</span>    <span style="color:#4e9a06">/celebrities/</span><span style="color:#4e9a06">:subject_id</span><span style="color:#ce5c00;font-weight:bold">/</span><span style="color:#000">evaluations</span><span style="color:#ce5c00;font-weight:bold">/</span><span style="color:#4e9a06">:id</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#4e9a06">:format</span><span style="color:#000;font-weight:bold">)</span>      <span style="color:#000">evaluations</span><span style="color:#8f5902;font-style:italic">#show</span>
                         <span style="color:#000">PATCH</span>  <span style="color:#4e9a06">/celebrities/</span><span style="color:#4e9a06">:subject_id</span><span style="color:#ce5c00;font-weight:bold">/</span><span style="color:#000">evaluations</span><span style="color:#ce5c00;font-weight:bold">/</span><span style="color:#4e9a06">:id</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#4e9a06">:format</span><span style="color:#000;font-weight:bold">)</span>      <span style="color:#000">evaluations</span><span style="color:#8f5902;font-style:italic">#update</span>
                         <span style="color:#000">PUT</span>    <span style="color:#4e9a06">/celebrities/</span><span style="color:#4e9a06">:subject_id</span><span style="color:#ce5c00;font-weight:bold">/</span><span style="color:#000">evaluations</span><span style="color:#ce5c00;font-weight:bold">/</span><span style="color:#4e9a06">:id</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#4e9a06">:format</span><span style="color:#000;font-weight:bold">)</span>      <span style="color:#000">evaluations</span><span style="color:#8f5902;font-style:italic">#update</span>
                         <span style="color:#000">DELETE</span> <span style="color:#4e9a06">/celebrities/</span><span style="color:#4e9a06">:subject_id</span><span style="color:#ce5c00;font-weight:bold">/</span><span style="color:#000">evaluations</span><span style="color:#ce5c00;font-weight:bold">/</span><span style="color:#4e9a06">:id</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#4e9a06">:format</span><span style="color:#000;font-weight:bold">)</span>      <span style="color:#000">evaluations</span><span style="color:#8f5902;font-style:italic">#destroy</span>
</code></pre></div><p>와 같은 routing이 가능해짐을 알 수 있습니다. 종속적인 routing이 가능해진것이지요!</p>

</div>





    
	
  

    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-936196286d8b2c724f189212da4526b8">2019</h1>
	
	<div class="td-byline mb-4">
		
        
	</div>
	
</div>





    
      
  
  
  
  

  
  

  
    
    
	
    


  

<div class="td-content" style="">
    <h1 id="pg-488f0ebb0a422b1ed493c128b199c91b">Wine list for beginners</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2019-12-30" class="text-muted">2019.12.30</time>
        
	</div>
	<p>부담스럽지 않은 입문용 쉬라즈/멜롯 세미나 를 진행한다면 시음하고 싶은 와인 리스트</p>
<p>d&rsquo;Arenberg, Footbolt Shiraz 2016
다렌버그, 풋볼트 쉬라즈 2016</p>
<p>와인 구매하는 법</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-55a315b9f51fcea8969bee7d245547e1">Passing Slice to a function</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2019-12-26" class="text-muted">2019.12.26</time>
        
	</div>
	<p>절차지향 프로그래밍의 가장 흔한 특징은 배열 개념이다. 배열은 간단한 것처럼 보이지만 우리가 언어에 배열을 적용할때에는 몇가지 답변해야할 문제들이 있다.</p>
<ul>
<li>고정된 사이즈인가 변수인가?</li>
<li>사이즈가 타입의 부분인가?</li>
<li>다차원 배열은 어떻게 생겼는가?</li>
<li>빈 배열이 의미가 있는가?</li>
</ul>
<p>이 문제들의 답변은 배열이 그저 언어의 특징인지, 디자인의 핵심부분인지에 영향을 끼친다.</p>
<p>Go에서는 고정 길이 배열을 기반으로 만들어져 유동적이고 확장가능한 데이터 구조를 가지는 Slice가 이 문제의 답변의 핵심이다.</p>
<h1 id="배열">배열</h1>
<p>배열은 고에서 중요한 부분이지만, 어떤 건물의 토대처럼 눈에 보이는 컴포넌트들 아래 숨겨져있다. 우리는 좀 더 흥미로운 주제인 Slice를 이야기하기 전에 배열에 대해서 간단히 짚고 넘어가야한다.</p>
<p>배열은 사이즈가 타입의 일부이고, 이는 표현성을 한정시키기 떄문에 Go 프로그램에서 그닥 잘 보이지 않는다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#204a87;font-weight:bold">var</span> <span style="color:#000">buffer</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">256</span><span style="color:#000;font-weight:bold">]</span><span style="color:#204a87;font-weight:bold">byte</span>
</code></pre></div><p>이는 buffer라는 256바이트짜리 변수를 선언한다. 이 변수 buffer의 타입은 256이라는 사이즈를 포함한다. 이 배열과 관련된 데이터는 딱 원소들의 배열일 것이다. 설계상으로 아마 이렇게 메모리에 있을 것이다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">buffer: byte byte byte ... <span style="color:#0000cf;font-weight:bold">256</span> <span style="color:#204a87">times</span> ... byte byte byte
</code></pre></div><p>즉, 이 변수는 256 바이트의 데이터&quot;만&quot; 저장하고 있다. 이 원소들은 buffer[0], buffer[1] 같은 친숙한 인덱싱 문법으로 접근할 수 있다. 배열은 보통 slice를 위한 저장소로서의 목적으로 가장 많이 사용된다.</p>
<h1 id="slice">slice</h1>
<p>slice를 쓰기위해서는 그것들이 무엇이고 무엇을 하는지 정확히 이해를 하고 있어야한다.</p>
<p>slice는 slice 변수 그 자체와는 별개로 저장되는 배열의 연속적인 섹션을 표현하기 위한 자료구조이다. slice는 배열이 아니다. slice는 배열의 일부를 나타낸다. 우리 buffer 배열이 있다고 할때, 배열을 slicing 함으로써 우리는 100에서 150까지의 원소를 나타내는 slice를 만들 수 있다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#204a87;font-weight:bold">var</span> <span style="color:#000">slice</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">byte</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#000">buffer</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">100</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">150</span><span style="color:#000;font-weight:bold">]</span>
<span style="color:#8f5902;font-style:italic">// var slice = buffer[100:150]
</span><span style="color:#8f5902;font-style:italic">// slice := buffer[100:150]
</span></code></pre></div><p>slice 변수는 정확히 무엇일까? 정확히 그런건 아니지만, 일단 slice를 길이와 배열의 원소에 대한 포인터, 두 개 원소를 가지는 자료구조라고 생각해보자.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#204a87;font-weight:bold">type</span> <span style="color:#000">sliceHeader</span> <span style="color:#204a87;font-weight:bold">struct</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#000">Length</span>        <span style="color:#204a87;font-weight:bold">int</span>
    <span style="color:#000">ZerothElement</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#204a87;font-weight:bold">byte</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#000">slice</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">sliceHeader</span><span style="color:#000;font-weight:bold">{</span>
    <span style="color:#000">Length</span><span style="color:#000;font-weight:bold">:</span>        <span style="color:#0000cf;font-weight:bold">50</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#000">ZerothElement</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">buffer</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">100</span><span style="color:#000;font-weight:bold">],</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>물론 이건, 그냥 예시다. 사실 sliceHeader는 프로그래머들에게 보이는 영역이 아니고, 원소의 포인터의 타입이 원소 타입에 의존적이지만, 이 예시는 slice의 원리를 설명하고 있다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000">slice2</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">slice</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">10</span><span style="color:#000;font-weight:bold">]</span>
<span style="color:#8f5902;font-style:italic">// 밑에 sliceHeader 구조체는 이런식으로 생겼을것이다.
</span><span style="color:#8f5902;font-style:italic">// slice2 := sliceHeader {
</span><span style="color:#8f5902;font-style:italic">// 	 Length: 5,
</span><span style="color:#8f5902;font-style:italic">// 	 ZerothElement: &amp;buffer[105],
</span><span style="color:#8f5902;font-style:italic">// }
</span></code></pre></div><p>이 헤더가 buffer 변수에 저장되 있는 같은 배열을 가르키고 있다는 걸 주의해야한다.</p>
<p>또한 reslice할 수 있는데, slice를 slice해서 기존의 slice 구조체로 결과를 다시 저장하는 것을 의미한다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000">slice</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#000">slice</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">10</span><span style="color:#000;font-weight:bold">]</span>
</code></pre></div><p>이것의 sliceHeader 구조는 slice2 변수꺼와 아예 같을 것이다. slice를 truncate할때와 같이, reslicing을 하는 경우는 종종 볼 수 있다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000">slice</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#000">slice</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">:</span><span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">slice</span><span style="color:#000;font-weight:bold">)</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">]</span>
<span style="color:#8f5902;font-style:italic">// sliceHeader {
</span><span style="color:#8f5902;font-style:italic">//	 Length: 3,
</span><span style="color:#8f5902;font-style:italic">//	 ZerothElement: &amp;buffer[106]
</span><span style="color:#8f5902;font-style:italic">// }
</span></code></pre></div><p>짬 찬 go 프로그래머가 slice header 에 대해서 말하는 걸 들은 적 있을 것이다. slice header는 사실 실제로 slice 변수가 가지고 있는 값이다. slice를 argument로 가지는 함수를 호출할때, 함수에 실제로 전달되는 건 sliceheader이다. slice header에는 사실 한가지 아이템이 더 있는데, 일단 슬라이스 헤더의 존재여부가 slice를 다루는 프로그램에 어떤 영향을 주는 지부터 알아본다.</p>
<h1 id="함수에-slice를-전달할때">함수에 slice를 전달할때</h1>
<p>Slice가 포인터를 포함하고 있지만 그자체로서는 &ldquo;값&quot;이라는 걸 이해하는 게 중요하다.</p>
<p>Slice는 포인터와 길이를 가지고 있는 구조체 값이다. 구조체를 가르키는 포인터가 아니다.</p>
<p>이전 예시에서 IndexRune을 호출할때 우리는 slice header의 복사본을 전달한것이다.</p>
<p>예를 들어,</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000">AddOneToEachElement</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">slice</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">byte</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#204a87;font-weight:bold">range</span> <span style="color:#000">slice</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#000">slice</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">++</span>
    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>slice를 돌면서 값을 1씩 증가시키는 함수가 있다고 할때,</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000">main</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#000">slice</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">buffer</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">10</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">20</span><span style="color:#000;font-weight:bold">]</span>
    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#000;font-weight:bold">&lt;</span> <span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">slice</span><span style="color:#000;font-weight:bold">);</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#000">slice</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#204a87">byte</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000;font-weight:bold">}</span>
    <span style="color:#000">fmt</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;before&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">slice</span><span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000">AddOneToEachElement</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">slice</span><span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000">fmt</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;after&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">slice</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>slice header가 <em>값</em>으로 전달된다고 하더라도, 헤더에는 배열의 원소를 가르키는 pointer가 있기 때문에, 기존 슬라이스 헤더와 함수에 전달된 복사된 헤더 모두 같은 배열을 가르킨다. 그러므로, 함수가 return될때 slice들의 원소 값들이 변경된 걸 확인할 수 있는 것이다.</p>
<p>함수 파라미터는 정말 <em>복사본</em>이다. 아래 예시에서 확인할 수 있다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000">SubtractOneFromLength</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">slice</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">byte</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">byte</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#000">slice</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#000">slice</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">0</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">slice</span><span style="color:#000;font-weight:bold">)</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">]</span>
    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">slice</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000">main</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#000">fmt</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Before: len(slice) =&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">slice</span><span style="color:#000;font-weight:bold">))</span>
    <span style="color:#000">newSlice</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">SubtractOneFromLength</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">slice</span><span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000">fmt</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;After:  len(slice) =&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">slice</span><span style="color:#000;font-weight:bold">))</span>
    <span style="color:#000">fmt</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;After:  len(newSlice) =&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">newSlice</span><span style="color:#000;font-weight:bold">))</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>Go 에서 파라미터를 전달할때 Reference가 아닌, Value로 전달한다. Slice의 경우에도 마찬가지이다. 이는 Pointer와 길이를 가진 구조체 값이라고 할 수 있다.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-ab9a7f95cb158b008022bd723c3ae945">gorm-postgresql 사용 주의</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2019-12-20" class="text-muted">2019.12.20</time>
        
	</div>
	<p>gorm 을 통해 go 에서 orm을 사용하고 있었다. gorm은 mysql, postgresql 등 메인 dbms를 지원하면서도 꽤 편리하게 데이터베이스 operation들을 관리할 수 있었기 때문에 잘 사용하고 있었다.</p>
<p>계속 조회만 했었어서 Update 로직을 딱히 사용할 일이 없다가, 이번에 한번 사용할 일이 있어서 사용해보았다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000">rdb</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Debug</span><span style="color:#000;font-weight:bold">().</span><span style="color:#000">Table</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;test&#34;</span><span style="color:#000;font-weight:bold">).</span><span style="color:#000">Where</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;user_id = $1&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">user</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">UserID</span><span style="color:#000;font-weight:bold">).</span><span style="color:#000">UpdateColumn</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;test_column&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">postgres</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Jsonb</span><span style="color:#000;font-weight:bold">{</span><span style="color:#000">RawMessage</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000">resBytes</span><span style="color:#000;font-weight:bold">})</span>
</code></pre></div><p>뭐 이런 코드였는데, 자꾸 에러가 발생하길래 뭐지싶어서 디버그 옵션을 키고 돌려봤다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">pq: column <span style="color:#4e9a06">&#34;test_column&#34;</span> is of <span style="color:#204a87">type</span> jsonb but expression is of <span style="color:#204a87">type</span> text
UPDATE <span style="color:#4e9a06">&#34;testcases&#34;</span> SET <span style="color:#4e9a06">&#34;test_column&#34;</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#39;[123 34 99 111 ~ ]&#39;</span> WHERE <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">user_id</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#39;[123 34 99 111 ~ ]&#39;</span>
</code></pre></div><p>쿼리가 저렇게 찍혀있었다. 즉, 앞에 있는 where 절의 user_id 에 test_column 에 넣을 데이터가 덮어쓰기 되어있었다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000">rdb</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Debug</span><span style="color:#000;font-weight:bold">().</span><span style="color:#000">Table</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;test&#34;</span><span style="color:#000;font-weight:bold">).</span><span style="color:#000">UpdateColumn</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;test_column&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">postgres</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Jsonb</span><span style="color:#000;font-weight:bold">{</span><span style="color:#000">RawMessage</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000">resBytes</span><span style="color:#000;font-weight:bold">}).</span><span style="color:#000">Where</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;user_id = $1&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">user</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">UserID</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>혹시 몰라서 where 절의 위치를 바꿔봤는데 아예 where 절이 무시된다.</p>
<p><a href="http://gorm.io/docs/update.html">http://gorm.io/docs/update.html</a> 공식 documentation에서</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000">db</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Table</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;users&#34;</span><span style="color:#000;font-weight:bold">).</span><span style="color:#000">Where</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;id IN (?)&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">int</span><span style="color:#000;font-weight:bold">{</span><span style="color:#0000cf;font-weight:bold">10</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">11</span><span style="color:#000;font-weight:bold">}).</span><span style="color:#000">Updates</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">map</span><span style="color:#000;font-weight:bold">[</span><span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">]</span><span style="color:#204a87;font-weight:bold">interface</span><span style="color:#000;font-weight:bold">{}{</span><span style="color:#4e9a06">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;hello&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;age&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">18</span><span style="color:#000;font-weight:bold">})</span>
<span style="color:#8f5902;font-style:italic">//// UPDATE users SET name=&#39;hello&#39;, age=18 WHERE id IN (10, 11);
</span></code></pre></div><p>위 코드가 정상 실행되는 걸 보니 mysql에서는 위와 같은 방식의 update가 정상적으로 실행되는 듯하다. 아마도 postgresql 의 placeholder 관련되서 버그가 있어서 안먹는것으로 추정된다.</p>
<p>Table에 Operation을 날리는게 아니라 Model 기준으로 Update을 수행하게 되면 정상적으로 동작하는 것을 확인했다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000">rdb</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Model</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">user</span><span style="color:#000;font-weight:bold">).</span><span style="color:#000">UpdateColumn</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;test_column&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">postgres</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Jsonb</span><span style="color:#000;font-weight:bold">{</span><span style="color:#000">RawMessage</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000">resBytes</span><span style="color:#000;font-weight:bold">})</span>
</code></pre></div><p>Model은 gorm에서는 특정 Row를 가르킨다고 보면 된다. 따라서 Model 의 파라미터로 들어가는 user 객체에는 Id 컬럼이 반드시 채워져있어야한다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#204a87;font-weight:bold">type</span> <span style="color:#000">User</span> <span style="color:#204a87;font-weight:bold">struct</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#000">ID</span> <span style="color:#204a87;font-weight:bold">string</span> <span style="color:#4e9a06">`gorm:&#34;id&#34;`</span>
	<span style="color:#000">Name</span> <span style="color:#204a87;font-weight:bold">string</span> <span style="color:#4e9a06">`gorm:&#34;name&#34;`</span>
	<span style="color:#000">TestColumn</span> <span style="color:#000">postgres</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Jsonb</span> <span style="color:#4e9a06">`gorm:&#34;test_column&#34;`</span>
	<span style="color:#000">IsEnabled</span> <span style="color:#204a87;font-weight:bold">bool</span> <span style="color:#4e9a06">`gorm:&#34;is_enabled&#34;`</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#204a87;font-weight:bold">var</span> <span style="color:#000">users</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#000">User</span>
<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">rdb</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Where</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;is_enabled = $1&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">true</span><span style="color:#000;font-weight:bold">).</span><span style="color:#000">Find</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">users</span><span style="color:#000;font-weight:bold">).</span><span style="color:#000">Error</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#204a87;font-weight:bold">nil</span><span style="color:#000;font-weight:bold">{</span>
	<span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">err</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>뭐 이런식으로 하면 user들을 query로 땡겨와서 slice 안에 넣어놓고 각 user의 특정 컬럼값을 Update하는 로직을 작성할 수 있을 것이다.
그동안은 Table 에 직접 Operation하는 것이 좀 더 명시적이라고 생각해서 그런식으로 코드를 작성했었는데, 위와 같이 Model기준으로 하는게 코드상 버그도 없고 공식 Documentation이나 gorm usage들에서 많이 사용하는 방식인 듯하다.</p>
<p>물론 Explict하게도 해결할 수 있다. 무식하지만 쿼리를 그냥 때리는 것이다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000">rdb</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Exec</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;UPDATE test SET test_column=$1 WHERE user_id=$2&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">postgres</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Jsonb</span><span style="color:#000;font-weight:bold">{</span><span style="color:#000">RawMessage</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000">resBytes</span><span style="color:#000;font-weight:bold">},</span> <span style="color:#000">user</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">UserID</span><span style="color:#000;font-weight:bold">).</span><span style="color:#000">Error</span>
</code></pre></div><p>쿼리를 그냥 execute(실행)하면 사실 위와같은 문제는 해결 할 수 있다.</p>
<p>Model 기준으로 많이 사용하고 있으니, 한번 Model기준으로 앞으로 작성해보려고한다.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-d91144f1aecf6aa2e42f313a5c43cf5a">string split</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2019-12-10" class="text-muted">2019.12.10</time>
        
	</div>
	<p>Json diff를 뜨고 &ldquo;\n&quot;으로 split을 했는데 자꾸 예상한 길이보다 1씩 길게 나오는것이었다.
go 내장함수인 strings.Split 요놈이 문제인가 해서 한번 테스트를 해봤다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000">hello</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#4e9a06">&#34;안녕하세요\n 반갑습니다.&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#204a87">string</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">rune</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">10</span><span style="color:#000;font-weight:bold">))</span>
</code></pre></div><p>문제가 되는 문자열의 마지막 Rune이 U+000A, 즉 10이었다. 알고보니 이는 New line(개행문자)의 unicode중 하나였고, Split는 문제가 없었다. string 을 제대로 출력하고 테스트해보기 위해 rune을 활용하면 좋다.</p>
<blockquote>
<p>참고1: <a href="http://pyrasis.com/book/GoForTheReallyImpatient/Unit45/02">utf8 패키지 내 함수 참고자료</a>
golang은 모두 utf8 인코딩 기반이기 때문에, 한글이나 특수문자를 표현하기 위해 utf8 라이브러리 내의 여러가지 함수를 사용해보면 편하다.</p>
</blockquote>
<p>다만</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000">hello</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#4e9a06">&#34;안녕하세요\n반갑습니다\n&#34;</span>
<span style="color:#000">fmt</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;%q&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">strings</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Split</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">hello</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;\n&#34;</span><span style="color:#000;font-weight:bold">))</span>
<span style="color:#8f5902;font-style:italic">// [&#34;안녕하세요&#34;, &#34;반갑습니다&#34;, &#34;&#34;]
</span></code></pre></div><p>맨마지막에 저렇게 empty string이 나오는게 싫어서 저렇게 empty string을 제외하고 Split하는 방법에 대해 좀 찾아보니, 아래와 같은 함수를 찾았다. splitFn라는 함수에 separator 를 정의하고 해당 함수를 strings.FieldsFunc 라는 메소드에 파라미터로 넘기는 방식으로 Split을 수행하면 empty string이 무시된다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000">splitFn</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#204a87;font-weight:bold">func</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">c</span> <span style="color:#204a87;font-weight:bold">rune</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">bool</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">c</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#4e9a06">&#39;\n&#39;</span>
<span style="color:#000;font-weight:bold">}</span>
<span style="color:#000">fmt</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;%q&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">strings</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">FieldsFunc</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">hello</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">splitFn</span><span style="color:#000;font-weight:bold">))</span>
<span style="color:#8f5902;font-style:italic">//[&#34;안녕하세요&#34; &#34;반갑습니다&#34;]
</span></code></pre></div>
</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-ac3992195bdfe2da845c2fc8c030e646">goland tips</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2019-12-05" class="text-muted">2019.12.05</time>
        
	</div>
	<p>cmd+ shift+ f =&gt; find in path (goland)</p>
<p>코드 어딧는지 찾기 딱좋다!</p>
<p>cmd + O =&gt; 기능 쫙 보는 찾기</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-6b0851710c0f814de79273292d4588ce">DDA 스터디</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2019-11-30" class="text-muted">2019.11.30</time>
        
	</div>
	<h1 id="dda-스터디">DDA 스터디</h1>
<h2 id="transaction">Transaction</h2>
<p>트랜잭션은은 여러 개의 읽기와 쓰기를 하나의 논리적인 유닛으로 묶는다.
-&gt; 그룹으로 묶은 오퍼레이션의 부분이 실패하면 전체가 실패한다.</p>
<p>safety guarantee (안정성 보장) =&gt; application 입장에서는 좋다.</p>
<p>=&gt; 이런 걸 보장 : ACID 보장해야함.</p>
<p><strong>Atomicity(원자성)</strong>
한 오퍼레이션이 더 작은 부분으로 쪼개지지 않는것. 디비에 쓰다가 반만 썼는데 &ldquo;성공&quot;하면 안되고, &ldquo;실패&quot;하고 마치 어떤 변화도 없었던 것처럼 유지해야함.</p>
<p><em>Consistency</em>
같은 데이터를 바라볼때 같은 값을 가지는 것. Consistensy를 실시간으로 만족시키는것은 퍼포먼스 적으로 힘들고, 그래서 eventual consistency같은 개념이 등장하는 것.</p>
<h3 id="isolation"><em>Isolation</em></h3>
<p><em>Serializability</em>
동시다발적인 요청이 들어오더라고 마치 serial한 요청이 들어온 것처럼 =&gt; 어려움.</p>
<dl>
<dt><em>Durability</em></dt>
<dd>커밋 success시엔 db crush가 나든 hardware fault가 나든 레코드를 잊아뿌면 안된다.</dd>
</dl>
<p>Single Node</p>
<ul>
<li>write-ahead log를 유지해서 폴트가 나도 복구할수있도록
Replicated database</li>
<li>몇개의 노드들에게 copy가 되야 함.</li>
</ul>
<p>Multi-object Transactions</p>
<ul>
<li>Violating atomicity example
: 메일 보내고, unread += 1 하는 경우 메일보내고 unread올릴라그랬는데 crash
메일은 보냈으나 상대방의 안읽음 +=1 을 못한경우 =&gt; 에러!
해결:  BEGIN TRANSACTION ~ END TRANSACTION</li>
</ul>
<h3 id="isolation-1">Isolation</h3>
<p>Weak Isolation 을 제공</p>
<p>So, 개발자가 주의해서 사용해야한다.</p>
<dl>
<dt>Dirty Write</dt>
<dd>row-level lock을 걸어야댐.
Dirty Read</dd>
<dd>갱신되지않는 데이터를 보이지 않게. 커밋된 데이터만 볼수있게.
Trasaction 이 완료되기전까지는 Previous만 보여주고 Transaction이 끝났을때 current를 보여준다.</dd>
</dl>
<p>snapshot isolation and repeatable read</p>
<p>앨리스 계좌 조회
1번 계좌 잔액 500원 -&gt; 600원
2번 계좌 잔액 500원 -&gt; 400원</p>
<p>할떄 순간적으로 500/400으로 조회되는 상황</p>
<p>일반적안 계좌조회 상황에서는 새로고침하면 문제가 안되지만, backup이나 anayltic 등에서는 큰 문제가 된다.(잘못된 데이터가 반영)</p>
<p>스냅샷 isolation 은 일반적으로 write lock을 사용한다.</p>
<h3 id="implementing-snapshot-isolation-using-multi-version-objects">Implementing snapshot isolation using multi-version objects</h3>
<p>history를 들구다닌다.</p>
<p>내 transaction id 보다 작은 값을 가진 history의 값을 가져가면된다.</p>
<p>update = delete + create</p>
<ol>
<li>In progress인 transaction 을 쫙 가져오고, 얘네들에 의한 변화는 쫙 무시.</li>
<li>Aborted trancation 에 의한 변화는 무시.</li>
<li>나보다 나중의 transaction 에 변화는 무시.</li>
<li>나보다 먼저지만, commit 되지않은거는 무시한다.</li>
</ol>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-b79aff5e78952dc2748e8e69b6628636">클로저를 고루틴으로 실행할때 주의할점.</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2019-11-30" class="text-muted">2019.11.30</time>
        
	</div>
	<p>go routine 만들 떄 익명함수로 할때 마지막 변수갑스로 다 써서 개망할뻔</p>
<blockquote>
<p>Closure(클로저)는 함수 바깥에 있는 변수를 참조하는 함수값을 일컫는다. 함수가 선언될 때의 환경을 계속 유지하여 프로그램의 흐름을 변수에 저장하기 위해 사용한다. 클로저는 함수형 언어의 큰 특징이며, Go 는 클로저를 통해 함수형 언어의 기능을 구현하고 있다.</p>
</blockquote>
<p>참고: <a href="http://pyrasis.com/book/GoForTheReallyImpatient/Unit25">http://pyrasis.com/book/GoForTheReallyImpatient/Unit25</a></p>
<h1 id="클로저를-고루틴으로-실행하기">클로저를 고루틴으로 실행하기</h1>
<p>반복문 내에 go routine를 삽입하여 concurrent한 Request를 날리는 로직을 작성하고 싶다고 하자.</p>
<p>처음엔 이런식으로 하면 될줄 알았다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#204a87;font-weight:bold">package</span> <span style="color:#000">main</span>
 
<span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000;font-weight:bold">(</span>
    <span style="color:#4e9a06">&#34;fmt&#34;</span>
<span style="color:#000;font-weight:bold">)</span>
 
<span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000">main</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#000">user</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#4e9a06">&#34;helloworld&#34;</span>
 
    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#000;font-weight:bold">&lt;</span> <span style="color:#0000cf;font-weight:bold">100</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">go</span> <span style="color:#204a87;font-weight:bold">func</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;http://post.naver.com/%v/%v&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">user</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#8f5902;font-style:italic">// 반복문의 변수를 클로저에서 바로 사용
</span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#000;font-weight:bold">}()</span>
    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p><em>예상한 결과</em></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;http://post.naver.com/helloworld/1&#34;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;http://post.naver.com/helloworld/2&#34;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;http://post.naver.com/helloworld/3&#34;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#ce5c00;font-weight:bold">...</span>
<span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;http://post.naver.com/helloworld/99&#34;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p><em>실제 결과</em></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;http://post.naver.com/helloworld/100&#34;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;http://post.naver.com/helloworld/100&#34;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;http://post.naver.com/helloworld/100&#34;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#ce5c00;font-weight:bold">...</span>
<span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;http://post.naver.com/helloworld/100&#34;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>그렇게 되는 이유는,</p>
<p>클로저를 고루틴으로 사용할때는 반복문이 끝난 뒤에 고루틴이 실행되기 때문이다. 따라서, 고루틴이 생성된 시점의 변수 i의 값은 100이다. 따라서 모두</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;http://post.naver.com/helloworld/100&#34;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>값으로 요청이 날라가게 되는것이다. 따라서 클로저를 고루틴으로 실행할때 반복문에 의해 바뀌는 변수는 반드시 파라미터로 넘겨줘야한다. 파라미터로 넘겨주는 시점에 해당 변수의 값이 복사되므로, 고루틴이 생성될때 그대로 사용할 수 있다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#204a87;font-weight:bold">package</span> <span style="color:#000">main</span>
 
<span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000;font-weight:bold">(</span>
    <span style="color:#4e9a06">&#34;fmt&#34;</span>
<span style="color:#000;font-weight:bold">)</span>
 
<span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000">main</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#000">user</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#4e9a06">&#34;helloworld&#34;</span>
 
    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#000;font-weight:bold">&lt;</span> <span style="color:#0000cf;font-weight:bold">100</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">go</span> <span style="color:#204a87;font-weight:bold">func</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">n</span> <span style="color:#204a87;font-weight:bold">int</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>          <span style="color:#8f5902;font-style:italic">// 익명 함수를 고루틴으로 실행(클로저)
</span><span style="color:#8f5902;font-style:italic"></span>            <span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;http://post.naver.com/%v/%v&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">user</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">n</span><span style="color:#000;font-weight:bold">)</span>
        <span style="color:#000;font-weight:bold">}(</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">)</span>                      <span style="color:#8f5902;font-style:italic">// 반복문의 변수는 매개변수로 넘겨줌
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div>
</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-106c32897074f874669df46ca3978460">concurrency is not parallelism</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2019-11-28" class="text-muted">2019.11.28</time>
        
	</div>
	<p><a href="https://talks.golang.org/2012/concurrency.slide#1">https://talks.golang.org/2012/concurrency.slide#1</a></p>
<h1 id="concurrency">concurrency</h1>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-2e3cdd17f1d9860366f68fd26bb2ec6f">aws-lambda-in-go</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2019-11-25" class="text-muted">2019.11.25</time>
        
	</div>
	<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000">Handler</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ctx</span> <span style="color:#000">context</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Context</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">error</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#000">file</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">os</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Open</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;config.json&#34;</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#204a87;font-weight:bold">nil</span><span style="color:#000;font-weight:bold">{</span>
		<span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">err</span>
	<span style="color:#000;font-weight:bold">}</span>
	<span style="color:#204a87;font-weight:bold">defer</span> <span style="color:#000">file</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Close</span><span style="color:#000;font-weight:bold">()</span>

	<span style="color:#000">conf</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">Configuration</span><span style="color:#000;font-weight:bold">{}</span>
	<span style="color:#000">err</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#000">json</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">NewDecoder</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">file</span><span style="color:#000;font-weight:bold">).</span><span style="color:#000">Decode</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">conf</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#204a87;font-weight:bold">nil</span> <span style="color:#000;font-weight:bold">{</span>
		<span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">err</span>
	<span style="color:#000;font-weight:bold">}</span>

	<span style="color:#8f5902;font-style:italic">// Initialize connection string
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">host</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">user</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">password</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">database</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">conf</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Host</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">conf</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">User</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">conf</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Password</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">conf</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Database</span>

	<span style="color:#204a87;font-weight:bold">var</span> <span style="color:#000">connectionString</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#000">fmt</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Sprintf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;host=%s user=%s password=%s dbname=%s&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">host</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">user</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">password</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">database</span><span style="color:#000;font-weight:bold">)</span>

	<span style="color:#000">db</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">sql</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Open</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;postgres&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">connectionString</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#204a87;font-weight:bold">nil</span> <span style="color:#000;font-weight:bold">{</span>
		<span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">err</span>
	<span style="color:#000;font-weight:bold">}</span>
	<span style="color:#204a87;font-weight:bold">defer</span> <span style="color:#000">db</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Close</span><span style="color:#000;font-weight:bold">()</span>

	<span style="color:#8f5902;font-style:italic">// TODO: 유저 프로파일 찌르기
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">rows</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">db</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Query</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;select * from experiments limit 5&#34;</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#204a87;font-weight:bold">nil</span> <span style="color:#000;font-weight:bold">{</span>
		<span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">err</span>
	<span style="color:#000;font-weight:bold">}</span>
	<span style="color:#204a87;font-weight:bold">defer</span> <span style="color:#000">rows</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Close</span><span style="color:#000;font-weight:bold">()</span>

	<span style="color:#000">cols</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">rows</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Columns</span><span style="color:#000;font-weight:bold">()</span>

	<span style="color:#000">rowValues</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#204a87">make</span><span style="color:#000;font-weight:bold">([][]</span><span style="color:#204a87;font-weight:bold">interface</span><span style="color:#000;font-weight:bold">{},</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span>

	<span style="color:#000">vals</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#204a87">make</span><span style="color:#000;font-weight:bold">([]</span><span style="color:#204a87;font-weight:bold">interface</span><span style="color:#000;font-weight:bold">{},</span> <span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">cols</span><span style="color:#000;font-weight:bold">))</span>

	<span style="color:#8f5902;font-style:italic">// pointer of interface
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#204a87;font-weight:bold">range</span> <span style="color:#000">cols</span><span style="color:#000;font-weight:bold">{</span>
		<span style="color:#000">vals</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#204a87">new</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">interface</span><span style="color:#000;font-weight:bold">{})</span>
	<span style="color:#000;font-weight:bold">}</span>

	<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">rows</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Next</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
		<span style="color:#000">rowValue</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#204a87">make</span><span style="color:#000;font-weight:bold">([]</span><span style="color:#204a87;font-weight:bold">interface</span><span style="color:#000;font-weight:bold">{},</span> <span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">cols</span><span style="color:#000;font-weight:bold">))</span>
		<span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">rows</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Scan</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">vals</span><span style="color:#ce5c00;font-weight:bold">...</span><span style="color:#000;font-weight:bold">)</span>
		<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#204a87;font-weight:bold">nil</span> <span style="color:#000;font-weight:bold">{</span>
			<span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">err</span>
		<span style="color:#000;font-weight:bold">}</span>
		<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#204a87;font-weight:bold">range</span> <span style="color:#000">cols</span><span style="color:#000;font-weight:bold">{</span>
			<span style="color:#000">rowValue</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#204a87">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rowValue</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">vals</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">]).(</span><span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#204a87;font-weight:bold">interface</span><span style="color:#000;font-weight:bold">{}))</span>
		<span style="color:#000;font-weight:bold">}</span>

		<span style="color:#000">rowValues</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#204a87">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rowValues</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">rowValue</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#000;font-weight:bold">}</span>

	<span style="color:#000">fmt</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">strings</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Join</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">cols</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;,&#34;</span><span style="color:#000;font-weight:bold">))</span>
	<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#204a87;font-weight:bold">range</span> <span style="color:#000">rowValues</span><span style="color:#000;font-weight:bold">{</span>
		<span style="color:#000">fmt</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rowValues</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">])</span>
	<span style="color:#000;font-weight:bold">}</span>

	<span style="color:#8f5902;font-style:italic">// testcases
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">// request에 있는걸로 / response 비교
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">// 매번 connnection (1분 1번)
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">// TODO: Close!
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">// Request -&gt; user profile api
</span><span style="color:#8f5902;font-style:italic"></span>
	<span style="color:#204a87;font-weight:bold">return</span> <span style="color:#204a87;font-weight:bold">nil</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p><a href="https://www.calhoun.io/using-postgresql-with-go/">https://www.calhoun.io/using-postgresql-with-go/</a></p>
<p>// 매번 connnection (1분 1번)</p>
<blockquote>
<p><em>json.compact</em>
json을 비교하는데 똑같은 json이 자꾸 bytes.Compare 시에 다르다고 나와서 뭔가 했더니, 공백때문에 5개 byte가 더 길게 나왔다. 공백을 제거하기 위해 bytes.TrimSpace 이런거를 써도 JSON string 안에 공백이 있거나 하면 동작이 제대로 안된다. 오히려 데이터를 요상하게 만들 수 있으므로, JSON 내의 공백을 제거하거나 할때 json.Compact를 사용하도록 한다. buffer 를 만들고 해당 buffer에 공백을 제거할 json string을 넣는 방식으로 하면된다.</p>
</blockquote>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#204a87;font-weight:bold">package</span> <span style="color:#000">main</span>

<span style="color:#204a87;font-weight:bold">import</span> <span style="color:#4e9a06">&#34;bytes&#34;</span>
<span style="color:#204a87;font-weight:bold">import</span> <span style="color:#4e9a06">&#34;fmt&#34;</span>
<span style="color:#204a87;font-weight:bold">import</span> <span style="color:#4e9a06">&#34;encoding/json&#34;</span>

<span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000">main</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#204a87;font-weight:bold">var</span> <span style="color:#000">jsonb</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87">byte</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">`{
</span><span style="color:#4e9a06">        &#34;foo&#34;: &#34;bar&#34;
</span><span style="color:#4e9a06">    }`</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#000">buffer</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#204a87">new</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">bytes</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Buffer</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">json</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Compact</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">buffer</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">jsonb</span><span style="color:#000;font-weight:bold">);</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#204a87;font-weight:bold">nil</span> <span style="color:#000;font-weight:bold">{</span>
		<span style="color:#000">fmt</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">err</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#000;font-weight:bold">}</span>
	
	<span style="color:#000">fmt</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">buffer</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><blockquote>
<p>Buffer 을 만들때
new(Buffer) (or just declaring a Buffer variable) is sufficient to initialize a Buffer</p>
</blockquote>
<p>위의 예시에서처럼 new(bytes.Buffer)를 하던지,</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000">buffer</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">bytes</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Buffer</span><span style="color:#000;font-weight:bold">{}</span>
</code></pre></div><p>이런식으로 생성한뒤 주소값을 넣어주면된다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#204a87;font-weight:bold">var</span> <span style="color:#000">buffer</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">bytes</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Buffer</span>
</code></pre></div><p>이런식으로 빈 값을 가르키는 포인터만 만들면 메모리 참조 panic이 날수있으니 조심해야한다.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-27df5ade3010b14a6dd5ca2b3146b1f8">scripting in github action</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2019-11-22" class="text-muted">2019.11.22</time>
        
	</div>
	<h1 id="github-action">Github Action</h1>
<h2 id="cicd를-github-action-을-이용해서-구성해본다">CI/CD를 Github Action 을 이용해서 구성해본다</h2>
<blockquote>
<p>set -e
bash script를 짤때, 명령줄 한줄 한줄 넘어갈때 에러가 발생하면 발생한 line에서 바로 종료될수 있도록 check할 수 있는 기능이다. script가 종료될때까지 기다릴필요 없이 에러발생시 바로 종료되므로, 디버그 시에 좋을것이다.</p>
</blockquote>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-5b9d5d2318c342f6b5f9c03d26400563">ssh tunneling</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2019-11-22" class="text-muted">2019.11.22</time>
        
	</div>
	<h1 id="ssh-tunneling">ssh tunneling</h1>
<p>An SSH client connects to a Secure Shell server, which allows you to run terminal commands as if you were sitting in front of another computer. But an SSH client also allows you to “tunnel” a port between your local system and a remote SSH server.</p>
<p>There are three different types of SSH tunneling, and they’re all used for different purposes. Each involves using an SSH server to redirect traffic from one network port to another. The traffic is sent over the encrypted SSH connection, so it can’t be monitored or modified in transit.</p>
<p>You can do this with the ssh command included on Linux, macOS, and other UNIX-like operating systems. On Windows, which doesn’t include a built-in ssh command, we recommend the free tool PuTTY to connect to SSH servers. It supports SSH tunneling, too.</p>
<p>SSH client 는 Secure Shell Server에 접속해서 마치 다른 컴퓨터 앞에 앉아서 커맨드를 입력하듯이 만들어준다. 하지만 SSH client는 local 시스템과 remote ssh server와의</p>
<p><a href="https://www.howtogeek.com/168145/how-to-use-ssh-tunneling/">https://www.howtogeek.com/168145/how-to-use-ssh-tunneling/</a></p>
<p><a href="https://medium.com/serverlessguru/what-is-a-ssh-tunnel-aws-ec2-8ebc394b8208">https://medium.com/serverlessguru/what-is-a-ssh-tunnel-aws-ec2-8ebc394b8208</a></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ssh -N -L 5432:<span style="color:#ce5c00;font-weight:bold">{</span>remote_rds_url<span style="color:#ce5c00;font-weight:bold">}</span>:5432 ec2-user@<span style="color:#ce5c00;font-weight:bold">{</span>host<span style="color:#ce5c00;font-weight:bold">}</span> -i <span style="color:#ce5c00;font-weight:bold">{</span>pem-key<span style="color:#ce5c00;font-weight:bold">}</span>.pem
</code></pre></div>
</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-1b756cfc3b08669fde63190db6b73a87">aws-lambda</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2019-11-19" class="text-muted">2019.11.19</time>
        
	</div>
	<p>AWS lambda를 이용하여 serverless application을 생성할 수 있다. 다른말로, 백엔드 서버를 구축할 필요없이 핸들러 함수만 등록하면 Lambda가 해당 코드를 실행시켜주는 서비스이다. Trigger 시에만 코드를 실행하며 사용한 컴퓨팅 시간에 대해서만 요금을 지불할 수 있다. 다른 AWS 서비스와의 연동이 잘 되있고 이는 UI/cli 상으로 조정가능하다. 다만, Role, Network 설정을 잘 해주어야한다.</p>
<p><a href="https://aws.amazon.com/ko/lambda/">참고</a></p>
<p>실습해보기 위해 간단하게 vpc내 rds instance에 접근해서 간단한 쿼리를 날리는 핸들러를 파이썬으로 작성했다.</p>
<p>지원하는 언어별로 작업 방법이 다르고, 일단 Python을 기준으로 진행한다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">create_conn</span><span style="color:#000;font-weight:bold">():</span>
    <span style="color:#000">conn</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#3465a4">None</span>
    <span style="color:#204a87;font-weight:bold">try</span><span style="color:#000;font-weight:bold">:</span>
        <span style="color:#000">conn</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">psycopg2</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">connect</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">conn_string</span><span style="color:#000;font-weight:bold">)</span>
    <span style="color:#204a87;font-weight:bold">except</span> <span style="color:#000">psycopg2</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">DatabaseError</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">e</span><span style="color:#000;font-weight:bold">:</span>
        <span style="color:#000">logger</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">error</span><span style="color:#000;font-weight:bold">(</span>
            <span style="color:#4e9a06">&#34;ERROR: Unexpected error: Could not connect to Postgres instance.&#34;</span><span style="color:#000;font-weight:bold">)</span>
        <span style="color:#000">logger</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">error</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">e</span><span style="color:#000;font-weight:bold">)</span>
        <span style="color:#000">sys</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">exit</span><span style="color:#000;font-weight:bold">()</span>

    <span style="color:#000">logger</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">info</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SUCCESS: Connection to RDS MySQL instance succeeded&#34;</span><span style="color:#000;font-weight:bold">)</span>

    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">conn</span>


<span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">fetch</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">conn</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">query</span><span style="color:#000;font-weight:bold">):</span>
    <span style="color:#000">result</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">[]</span>
    <span style="color:#000">logger</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">info</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Now executing: {}&#34;</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">format</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">query</span><span style="color:#000;font-weight:bold">))</span>
    <span style="color:#000">cursor</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">conn</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">cursor</span><span style="color:#000;font-weight:bold">()</span>
    <span style="color:#000">cursor</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">execute</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">query</span><span style="color:#000;font-weight:bold">)</span>

    <span style="color:#000">raw</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">cursor</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">fetchall</span><span style="color:#000;font-weight:bold">()</span>
    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">line</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">raw</span><span style="color:#000;font-weight:bold">:</span>
        <span style="color:#000">result</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">line</span><span style="color:#000;font-weight:bold">)</span>

    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">result</span>


<span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">lambda_handler</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">event</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">context</span><span style="color:#000;font-weight:bold">):</span>
    <span style="color:#000">query_cmd</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;SELECT * FROM PG_TABLES LIMIT 5&#34;</span>
    <span style="color:#000">logger</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">info</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">query_cmd</span><span style="color:#000;font-weight:bold">)</span>

    <span style="color:#000">conn</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">create_conn</span><span style="color:#000;font-weight:bold">()</span>

    <span style="color:#000">result</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">fetch</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">conn</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">query_cmd</span><span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000">conn</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">close</span><span style="color:#000;font-weight:bold">()</span>

    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">result</span>
</code></pre></div><p>이때 Postgresql 에 접근하기 위한 드라이버로 psycopg2라는 외부 라이브러리를 import해주어야했기 때문에,
Lambda Runtime에 해당 라이브러리를 따로 첨부해주어야했다.</p>
<p>따로 첨부해주기 위해서는 소스코드 + 라이브러리 를 한꺼번에 압축하여 업로드하는 방법이 있고, layers라는 걸 활용해서 lambda function들이 사용할 외부 라이브러리를 그때그때 매번 업로드하지 않고 layer만 추가해서 사용할 수 있도록 해놓은 것도 있었는데, 한꺼번에 업로드하는것은 동작을 확인했고, layers를 실습해보고자 하였다.</p>
<ul>
<li><a href="https://docs.aws.amazon.com/ko_kr/lambda/latest/dg/lambda-python-how-to-create-deployment-package.html">한꺼번에 압축하는 법</a></li>
</ul>
<p>Layers로 작업할때는 몇 가지만 주의하면 된다. 물론 이 몇가지 때문에 꽤 힘든 시간을 보내긴했다(ㅠㅠ)</p>
<ol>
<li>
<p>Lambda의 cpu 기준으로 컴파일된 라이브러리를 포함할것 (ex. _psycopg.cpython-36m-x86_64-linux-gnu.so)
<a href="https://github.com/jkehler/awslambda-psycopg2">람다용으로 컴파일된 라이브러리 레포지토리</a></p>
</li>
<li>
<p>python 폴더 밑에 라이브러리 폴더를 두고 python 폴더를 압축하여 업로드할것.</p>
</li>
</ol>
<ul>
<li><em>이 구조가 아니면 Lambda에서 import가 안된다!</em>(이것때문에 시간오래걸림)</li>
</ul>
<p>ex.</p>
<ul>
<li>python</li>
<li>
<ul>
<li>library1</li>
</ul>
</li>
<li>
<ul>
<li>library2</li>
</ul>
</li>
</ul>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-db4a5139db28ab728d63e5fb8dec0209">docker-compose up</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2019-11-14" class="text-muted">2019.11.14</time>
        
	</div>
	<p><a href="https://www.44bits.io/ko/post/almost-perfect-development-environment-with-docker-and-docker-compose#ports">큰 참고가 된 게시물</a></p>
<h1 id="개발환경-구성">개발환경 구성</h1>
<p>여러가지 다른 환경에 동일한 개발 환경을 구성할 수 있도록 하기 위해 Docker를 사용한다</p>
<h1 id="docker-compose-의-필요성">docker-compose 의 필요성</h1>
<p>Docker 로 개발환경을 구성할때 예를 들어 Web Application 과 Database 두 개의 서버를 띄워야한다고 하면,
일단 App을 하나의 컨테이너로 띄우고, Database를 또다른 컨테이너로 띄워서 둘이 통신할 수 있도록 해야한다.</p>
<p>그런데 컨테이너와 다른 컨테이너가 통신할 수 있게 하려면 docker run 에서 몇가지 옵션이 더 들어가야한다.</p>
<p>예시. Django application</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">docker run -it --rm <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -p 8000:8000 <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    django-sample <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    ./manage.py runserver 0:8000
</code></pre></div><p>django 에서 사용할 데이터베이스 설정을 담은 settings.py 파일</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000">DATABASES</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#4e9a06">&#39;default&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#4e9a06">&#39;ENGINE&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;django.db.backends.postgresql&#39;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#4e9a06">&#39;NAME&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;sampleDatabase&#39;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#4e9a06">&#39;USER&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;postgres&#39;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#4e9a06">&#39;HOST&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;db&#39;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#4e9a06">&#39;PORT&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;5432&#39;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#4e9a06">&#39;PASSWORD&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;postgres&#39;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>ex. Postgresql database</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">docker run --rm <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    --name db <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -e <span style="color:#000">POSTGRES_DB</span><span style="color:#ce5c00;font-weight:bold">=</span>sampleDatabase <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -e <span style="color:#000">POSTGRES_USER</span><span style="color:#ce5c00;font-weight:bold">=</span>sampleuser <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -e <span style="color:#000">POSTGRES_PASSWORD</span><span style="color:#ce5c00;font-weight:bold">=</span>samplesecret <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>	--volume<span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#204a87;font-weight:bold">$(</span><span style="color:#204a87">pwd</span><span style="color:#204a87;font-weight:bold">)</span>/docker/data:/var/lib/postgresql/data <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    postgres
</code></pre></div><blockquote>
<p>이렇게 환경변수를 설정해서 Postgresql 컨테이너를 실행시키면, default 값 대신 해당 값으로 초기화한다.
<a href="https://hub.docker.com/_/postgres">참고</a>. 예를 들어 default database 대신에 djangosample 이라는 database를 create한다. POSTGRES_DB의 경우에 정의되지 않으면 USER와 같은 이름의 database가 만들어진다. <em>단, 서로 다른 container가 통신을 해야하는 상황에서는 password는 반드시 필요하므로 설정해주어야한다</em></p>
</blockquote>
<p>단순하게 이렇게 구성해서는 두 컨테이너는 서로 통신할 수 없고,</p>
<blockquote>
<p>could not connect to server: Connection refused</p>
</blockquote>
<p>이 에러만 발생할 것이다.</p>
<p>이를 해결하기 위해선</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">docker run -it --rm <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -p 8000:8000 <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    --link db <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -e <span style="color:#000">DJANGO_DB_HOST</span><span style="color:#ce5c00;font-weight:bold">=</span>db <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    -e <span style="color:#000">DJANGO_DEBUG</span><span style="color:#ce5c00;font-weight:bold">=</span>True <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    django-sample <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    ./manage.py runserver 0:8000
</code></pre></div><p>이런식으로 &ndash;link 옵션을 통해 db 컨테이너와 app 컨테이너를 연결해줘야한다.</p>
<p>하지만, 이런식으로 하게 되면 조금 불편한 것이 사실이다. 이렇게 순차적으로 컨테이너를 실행시키는 것보단 한번 주루룩 설치하는 것이 아무래도 편할 것이다.</p>
<blockquote>
<p>게다가 link 옵션은 deprecate 예정이다.</p>
</blockquote>
<p>이를 위해서 docker-compose를 이용할 수 있다. 이름에서 떠오르는 composer 와 비슷하게 컨테이너의 관리도구 같은 느낌이다.
docker-compose.yml 파일을 이용하여 컨테이너 실행에 필요한 옵션을 기술할 수 있고, 컨테이너간 실행 순서나 의존성도 관리할 수 있다.</p>
<h2 id="docker-composeyml">docker-compose.yml</h2>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">version: <span style="color:#4e9a06">&#34;3&#34;</span>

services:
  db:
    image: postgres
    volumes:
      - postgres_data:/var/lib/postgresql/data/
    environment:
      POSTGRES_DB: sampleDatabase
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: postgres
  web:
    build:
      context: .
      dockerfile: Dockerfile
    image: sampleApplication
    stdin_open: <span style="color:#204a87">true</span>
    tty: <span style="color:#204a87">true</span>
    command: &gt;
      bash -c <span style="color:#4e9a06">&#34;python manage.py migrate --noinput 
</span><span style="color:#4e9a06">      &amp;&amp; python manage.py createsu 
</span><span style="color:#4e9a06">      &amp;&amp; python manage.py collectstatic --noinput 
</span><span style="color:#4e9a06">      &amp;&amp; python manage.py runserver 0.0.0.0:8000&#34;</span>
    volumes:
      - .:/app
    ports:
      - <span style="color:#4e9a06">&#34;8000:8000&#34;</span>
    depends_on: <span style="color:#8f5902;font-style:italic"># depend_on 옵션을 주면 순서를 조정가능하다 (db가 올라간 후에 web이 올라가도록)</span>
      - db
    environment:
      DJANGO_SETTINGS_MODULE: sampleApplication.settings.default
</code></pre></div><p>위에 좀 복잡하게 했던걸 위와 같은 compose 파일을 작성하면 쉽게 동작시킬 수 있다.</p>
<p>compose 에서는 link같은 것 필요없이도, 서비스 끼리 이름으로 <strong>통신가능</strong>하다. 즉 위 예시에는 web에서 데이터베이스에 접근할때 단순히 다른 서비스인 db로 별다른 조치 없이 접근가능하다. Application 컨테이너가 뜰때 django의 settings.py에 database 설정의 host를 &lsquo;db&rsquo;로 해놓았기 때문에 이에 접근을 시도할 것이다. 예를 들어 settings.py 에 database host를 localhost라고 해놓았다면 접속이 안될것이다.</p>
<p>db라는 이름이 마음에 들지 않는다면 또는 compose 내에 &lsquo;links&rsquo;라는 옵션을 통해 db 외에 다른 이름을 alias시켜줄 수도 있다. mydatabase라던지&hellip;?</p>
<p>첨에 좀 헤맸던건, 자꾸 데이터베이스가 없다느니, role 이 존재하지 않는다느니 하는 문제였는데,</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">docker volumn prune
docker ps -a // 도커 컨테이너 모두 조회<span style="color:#ce5c00;font-weight:bold">(</span>stop된것도<span style="color:#ce5c00;font-weight:bold">)</span>
rm -rf /var/lib/postgresql/data/

docker-compose down
</code></pre></div><p>컨테이너를 모두 조회해서 모두 삭제하고 마운트된 볼륨도 모두 삭제한 후 다시해보니 정상적으로 잘 작동했다.</p>
<p>기존 컨테이너와 뭔가가 충돌했던 모양이다.</p>
<p>이제 실행시켜보면 된다. &ndash;force-recreate옵션을 통해 무조건 컨테이너를 다시 만드는 옵션을 줄 수있다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">docker-compose up --force-recreate
</code></pre></div>
</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-854ed346fc46732b8d436bcd5617026d">rune ?</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2019-11-13" class="text-muted">2019.11.13</time>
        
	</div>
	<p>Go에서 String은 byte 들의 읽기전용 배열이라고 할 수 있다. 유니코드 표준은 값 하나에 의해 표현되는 항목에 대해 &ldquo;코드포인트&rdquo; 라는 용어를 사용한다. 16진수 2318값을 가진 코드 포인트 U+2318은 ⌘ 를 나타낸다. 좀 더 무난한 예제로, 유니코드 코드 포인트 U+0061은 소문자 &lsquo;a&rsquo;를 나타낸다.</p>
<p>일반적으로 글자는 여러 개 코드포인트의 조합으로 나타낼 수 있고, 따라서 이를 utf-8 인코딩한 바이트 배열로 나타낼 수 있다. 코드 포인트는 살짝 길기 때문에, Go에서는 <em>rune</em>이라는 용어를 사용한다. rune은 코드 포인트와 정확히 같은 개념이다. Go는 rune을 int32의 alias로 사용하여 프로그램이 이 integer 값이 특정 code point를 나타내는것이 명확하도록 하였다. 보통 character 상수라고 생각되는 것은 go 에서 rune 상수라고 불린다.</p>
<blockquote>
<p>&lsquo;⌘&rsquo;</p>
</blockquote>
<p>이 symbol의 타입과 값도 0x2318 integer 값을 가진 rune 타입이다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#204a87;font-weight:bold">package</span> <span style="color:#000">main</span>

<span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000;font-weight:bold">(</span>
	<span style="color:#4e9a06">&#34;fmt&#34;</span>
<span style="color:#000;font-weight:bold">)</span>

<span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000">main</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#204a87;font-weight:bold">var</span> <span style="color:#000">test</span> <span style="color:#204a87;font-weight:bold">string</span>
	<span style="color:#000">test</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;&#34;</span>
	<span style="color:#000">fmt</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;first test example:&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">test</span><span style="color:#000;font-weight:bold">))</span>
	<span style="color:#000">test</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;a&#34;</span>
	<span style="color:#000">fmt</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;second test example:&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">test</span><span style="color:#000;font-weight:bold">))</span>
	<span style="color:#000">test</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;가&#34;</span>
	<span style="color:#000">fmt</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;third test example:&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">test</span><span style="color:#000;font-weight:bold">))</span>
	<span style="color:#8f5902;font-style:italic">// first test example: 3
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">// second test example: 1
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">// third test example: 3
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>string 타입의 변수 test가 있다고 했을때, 1 바이트로 표현할 수 있는 알파벳과 다르게 나머지 <em>글자</em> 들은 len을 출력했을때
일반적으로 예상하는 그 길이가 출력되지 않는다. 이는 각 character(알파벳 이외의 문자)가 1바이트 이상의 바이트로 표현되고, 이에 len을 출력했을때 바이트수가 출력되기 때문이다.</p>
<p>대신, 모든 글자(character)는 unicode의 특정 code point로 나타낼 수 있다. 이를 이용해서 한 글자당 한 rune 타입으로 바꿔서 string을 rune slice로 변환한다고 생각해보면, len을 출력했을때 원하는 출력을 얻을 수 있다. 즉, 아래와 같이 하면</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000">runeTest</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87">rune</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">test</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">fmt</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;rune test example:&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">runeTest</span><span style="color:#000;font-weight:bold">))</span>
<span style="color:#8f5902;font-style:italic">// rune test example: 1
</span></code></pre></div><p>생각한 결과를 얻을 수 있다.</p>
<p><a href="joelonsoftware.com/2003/10/08/the-absolute-minimum-every-software-developer-absolutely-positively-must-know-about-unicode-and-character-sets-no-excuses/">참고</a></p>
<h2 id="update">Update!!</h2>
<blockquote>
<blockquote>
<p>추가!</p>
</blockquote>
</blockquote>
<p>utf8 라이브러리의 아래 함수를 이용하면 utf8로 인코딩된 문자열 값의 길이를 알수있다. 예를 들어 한글은 1글자당 3바이트를 이용해 저장하므로, 그냥 len을 이용해 출력하면 3이지만 RuneCountInString함수를 이용하면 실제길이인 1을 구할수있다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#204a87;font-weight:bold">var</span> <span style="color:#000">han</span> <span style="color:#204a87;font-weight:bold">string</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;한&#34;</span>
<span style="color:#000">fmt</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">han</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#8f5902;font-style:italic">// 3
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">utf8</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">RuneCountInString</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">han</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#8f5902;font-style:italic">// 1
</span></code></pre></div><p><a href="http://pyrasis.com/book/GoForTheReallyImpatient/Unit45/02">utf8 패키지 내 함수 참고자료</a></p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-67575c6ae03ca092937fd8f8f3c18a49">Django tutorial</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2019-11-11" class="text-muted">2019.11.11</time>
        
	</div>
	<h1 id="django">Django</h1>
<h2 id="setup">setup</h2>
<ol>
<li>가상환경 생성</li>
</ol>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">python3 -m venv VenvDjango
<span style="color:#204a87">cd</span> VenvDjango/ <span style="color:#ce5c00;font-weight:bold">&amp;&amp;</span> <span style="color:#204a87">source</span> bin/activate
</code></pre></div><ol start="2">
<li>프로젝트 디렉토리 파기</li>
</ol>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mkdir django-drf-react-quickstart <span style="color:#ce5c00;font-weight:bold">&amp;&amp;</span> <span style="color:#204a87">cd</span> <span style="color:#000">$_</span>
</code></pre></div><ol start="3">
<li>장고 &amp; 장고 rest framework 깔기, 프로젝트 시작</li>
</ol>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">pip install django djangorestframework
django-admin startproject project
</code></pre></div><h2 id="django-application-만들기">Django Application 만들기</h2>
<p>Django는 많은 Application<em>들</em> 로 구성되있다. 각 application은 이상적으로는 <em>한</em>가지 일만 해야한다. Django application 들은 모듈화되있고 재사용가능하다. Post를 작성하고 리스팅하는 application을 만들 수 있다. 다른 프로젝트가 같은 앱을 필요로하면 난 해당 앱을 패키지 매니저로 부터 설치하면된다.</p>
<p>이전에 만든 startproject 를 통해 project라는 폴더가 생성되 있었을텐데, 해당 폴더에 들어가서</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">django-admin startapp app_name
</code></pre></div><p>아래 명령어로 application 을 생성해주도록 한다. 여기선 app_name을 leads라고 하겠다.</p>
<p>그럼 프로젝트 구조는
django-drf-react-quickstart 아래</p>
<blockquote>
<ul>
<li>project
|&mdash; leads
|&mdash; project
|&mdash; manage.py</li>
</ul>
</blockquote>
<p>이 구조가 된다. 이때 project/settings.py에</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#000">INSTALLED_APPS</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#ce5c00;font-weight:bold">[</span>
    <span style="color:#4e9a06">&#39;django.contrib.admin&#39;</span>,
    <span style="color:#4e9a06">&#39;django.contrib.auth&#39;</span>,
    <span style="color:#4e9a06">&#39;django.contrib.contenttypes&#39;</span>,
    <span style="color:#4e9a06">&#39;django.contrib.sessions&#39;</span>,
    <span style="color:#4e9a06">&#39;django.contrib.messages&#39;</span>,
    <span style="color:#4e9a06">&#39;django.contrib.staticfiles&#39;</span>,
    <span style="color:#4e9a06">&#39;leads&#39;</span>, <span style="color:#8f5902;font-style:italic"># 방금 생성한 app 을 추가한다</span>
	<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>이제 첫번째 모델을 추가해보자.</p>
<h2 id="django-model-만들기">Django Model 만들기</h2>
<p>첫번째 model을 만들 차례다. model은 테이블의 데이터를 표현하는 객체이다. 장고 뿐만 아니라 거의 모든 웹 프레임워크가 모델의 개념을 가지고 있다. 장고 모델은 1개 이상의 Field를 가지는데, Field는 테이블의 Column(열)을 의미한다.</p>
<p>예시 모델은 3개의 Field를 가진다고 해보자.</p>
<ul>
<li>name</li>
<li>email</li>
<li>message</li>
</ul>
<p>Django는 자동으로 created_at column을 추가해주지 않으므로 누락하지 않도록 한다.</p>
<p>leads/models.py를 열고 lead model을 작성한다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">django.db</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">models</span>
<span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">Lead</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">models</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Model</span><span style="color:#000;font-weight:bold">):</span>
    <span style="color:#000">name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">models</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">CharField</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">max_length</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">100</span><span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000">email</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">models</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">EmailField</span><span style="color:#000;font-weight:bold">()</span>
    <span style="color:#000">message</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">models</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">CharField</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">max_length</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">300</span><span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000">created_at</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">models</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">DateTimeField</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">auto_now_add</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>cf. 모델 field에 대한 자세한 <a href="https://docs.djangoproject.com/en/2.0/ref/models/fields/">documentation</a>
Use-case에 가장 적합한 필드를 고르도록한다.</p>
<p>모델을 작성했으니, migration 을 만들어본다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">python manage.py makemigrations leads
</code></pre></div><p>그리고 db에 migrate한다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">python manage.py migrate
</code></pre></div><h2 id="testing">Testing</h2>
<p>테스팅을 위해 아래 패키지를 설치한다</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">pip install coverage
</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">coverage run --source<span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;.&#39;</span> manage.py <span style="color:#204a87">test</span>
// run converage
coverage html
// report 를 html 로 보고싶을때
coverage report
// <span style="color:#204a87">command</span> line에서 보고 싶을때
</code></pre></div><p>project/htmlcov/index.html을 browser에서 열어보면 뭘 테스트해야하는지 알수있을 것이다.</p>
<h2 id="rest-serializer">REST serializer</h2>
<p>serialization은 객체를 어떤 데이터 포맷으로 변형시키는 것이다. 그렇게 하면 파일로 저장하거나 네트워크를 통해 보낼 수 있는 형태가 된다. Django에서도, 모델이 Python class이고 이를 브라우저에서 렌더링하기 위해 JSON으로 바꿔야하기 때문에 Django REST Serializer가 필요하다. 이는 JSON을 객체로 바꾸는 데에도 적용된다.</p>
<p>./leads/serializer.py라는 파일을 만들고, 아래와 같이 작성한다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">rest_framework</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">serializers</span>
<span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">leads.models</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Lead</span>

<span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">LeadSerializer</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">serializers</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ModelSerializer</span><span style="color:#000;font-weight:bold">):</span>
	<span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">Meta</span><span style="color:#000;font-weight:bold">:</span>
		<span style="color:#000">model</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Lead</span>
		<span style="color:#000">fields</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;id&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;name&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;email&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;message&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>field를 한땀한땀 작성하지 않고,</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">LeadSerializer</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">serializers</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ModelSerializer</span><span style="color:#000;font-weight:bold">):</span>
	<span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">Meta</span><span style="color:#000;font-weight:bold">:</span>
		<span style="color:#000">model</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Lead</span>
		<span style="color:#000">fields</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#39;__all__&#39;</span>
</code></pre></div><p>이렇게 작성할 수도 있다. 이제 Views/Urls를 살펴보자</p>
<h2 id="controller가아니고-views">Controller가&hellip;아니고 Views</h2>
<p>다른 프레임워크를 쓰다보면, Django에 Controller가 없다는 게 꽤 놀랍다. 보통 컨트롤러는 Request를 처리하고 Response를 내보내는 로직을 포함한다. 전통적인 MVC 아키텍쳐에서는 Model, View, Controller 세 개가 존재한다. Rails등이 있다. Django는 MVT 프레임워크인데, Model, View, Template이다. View가 Response/Request 라이프사이클을 관리한다. Django에는 Function View, Class based view, generic view 같이 다양한 종류의 View가 존재한다.</p>
<p>우리는 여기서 generic API views를 기준으로 실습을 진행한다.</p>
<ul>
<li>모델의 collection을 조회하고,</li>
<li>DB에 신규 객체들을 생성한다</li>
</ul>
<p>generics api 내에는 조회와 생성을 위한 view가 존재하는데, 아래와 같은 식으로 사용하면 된다
./leads/views.py 을 열고</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">leads.models</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">Lead</span>
<span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">leads.serializers</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">LeadSerializer</span>
<span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">rest_framework</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">generics</span>

<span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">LeadListCreate</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">generics</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ListCreateAPIView</span><span style="color:#000;font-weight:bold">):</span>
	<span style="color:#000">queryset</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Lead</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">objects</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">all</span><span style="color:#000;font-weight:bold">()</span>
	<span style="color:#000">serializer_class</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">LeadSerializer</span>
</code></pre></div><p>3줄만 추가했는데, GET/POST request를 handling하는 view를 만들었다</p>
<h2 id="route가-아니고-urls">Route..가 아니고 urls</h2>
<p>Rails나 다른 프레임워크를 썼던 사람들은 Django에 Route 설정이 없다는 것에 꽤 놀랄 수 있다. View와 url을 mapping하는 가장 쉬운 방법은 url mapping이다.</p>
<p>위에서 만들었던 LeadListCreate를 api/lead/와 묶어보자. 즉, 모델 조회와 생성시에 api/lead/로 GET/POST 요청을 날리고 싶다.
URL mapping을 설정하기 위해서는 ./project/urls.py 을 연다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">django.urls</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">path</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">include</span>

<span style="color:#000">urlpatterns</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">[</span>
	<span style="color:#000">path</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">include</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;leads.urls&#39;</span><span style="color:#000;font-weight:bold">))</span>
<span style="color:#000;font-weight:bold">]</span>
</code></pre></div><p>그리고 ./leads/urls.py로 가서</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">django.urls</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">path</span>
<span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">.</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">views</span>

<span style="color:#000">urlpatterns</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">[</span>
	<span style="color:#000">path</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;api/lead/&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">views</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">LeadListCreate</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">as_view</span><span style="color:#000;font-weight:bold">()),</span>
<span style="color:#000;font-weight:bold">]</span>
</code></pre></div><p>이렇게 작성해준다.</p>
<p>마지막으로 설정의 INSTALLED_APPS 에서 아래와 같이 rest_framework를 추가해주면,</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000">INSTALLED_APPS</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">[</span>
    <span style="color:#4e9a06">&#39;django.contrib.admin&#39;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#4e9a06">&#39;django.contrib.auth&#39;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#4e9a06">&#39;django.contrib.contenttypes&#39;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#4e9a06">&#39;django.contrib.sessions&#39;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#4e9a06">&#39;django.contrib.messages&#39;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#4e9a06">&#39;django.contrib.staticfiles&#39;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#4e9a06">&#39;leads&#39;</span><span style="color:#000;font-weight:bold">,</span> 
    <span style="color:#4e9a06">&#39;rest_framework&#39;</span> <span style="color:#8f5902;font-style:italic"># enable rest framework</span>
<span style="color:#000;font-weight:bold">]</span>
</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">python manage.py runserver
</code></pre></div><p><img src="https://www.valentinog.com/blog/wp-content/uploads/2018/02/django-rest-framework-browsable-api.png" alt=""></p>
<p>위 화면을 확인 가능하다.</p>
<h2 id="db-seeding">DB seeding</h2>
<p>Django fixture을 통해 DB에 데이터를 넣을 수 있다.
Fixture는 frontend 데이터를 가지고 데모할 때 유용하게 쓸수 있다.
./leads/fixtures 라는 폴더를 만들고 leads.json라는 파일을 아래와 같이 작성한다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-JSON" data-lang="JSON"><span style="color:#000;font-weight:bold">[</span>
    <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">&#34;model&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;leads.lead&#34;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#204a87;font-weight:bold">&#34;pk&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#204a87;font-weight:bold">&#34;fields&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Armin&#34;</span><span style="color:#000;font-weight:bold">,</span>
            <span style="color:#204a87;font-weight:bold">&#34;email&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;something@gmail.com&#34;</span><span style="color:#000;font-weight:bold">,</span>
            <span style="color:#204a87;font-weight:bold">&#34;message&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;I am looking for a Javascript mentor&#34;</span><span style="color:#000;font-weight:bold">,</span>
            <span style="color:#204a87;font-weight:bold">&#34;created_at&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;2018-02-14 00:00:00&#34;</span>
        <span style="color:#000;font-weight:bold">}</span>
    <span style="color:#000;font-weight:bold">},</span>
    <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">&#34;model&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;leads.lead&#34;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#204a87;font-weight:bold">&#34;pk&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#204a87;font-weight:bold">&#34;fields&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Tom&#34;</span><span style="color:#000;font-weight:bold">,</span>
            <span style="color:#204a87;font-weight:bold">&#34;email&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;tomsomething@gmail.com&#34;</span><span style="color:#000;font-weight:bold">,</span>
            <span style="color:#204a87;font-weight:bold">&#34;message&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;I want to talk about a Python project&#34;</span><span style="color:#000;font-weight:bold">,</span>
            <span style="color:#204a87;font-weight:bold">&#34;created_at&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;2018-01-14 00:00:00&#34;</span>
        <span style="color:#000;font-weight:bold">}</span>
    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">]</span>
</code></pre></div><p>저장한 후 fixture를 불러온다</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">python manage.py loaddata leads
</code></pre></div><p>끝!</p>
<h2 id="react-frontend">React Frontend</h2>
<p>Django 와 React 를 어떻게 하면 잘 붙힐 수 있을까에 대해서는 여러가지 의견이 있다.</p>
<p>결과적으로는 얼마나 많은 Javascript가 필요한지에 따라 다르다. 보통은 3가지 패턴이 존재한다.</p>
<ol>
<li>React를 Django의 &ldquo;frontend&rdquo; app으로 가져간다: single HTML 템플릿을 load하고 React가 frontend를 관리하게 한다</li>
<li>Django를 독립적인 Rest API로 두고, React도 독립적인 SPA로 둔다 (인증을 위해 JWT가 필요하다)</li>
<li>섞는다: 작은 React app 들을 Django 템플릿안에 넣는다</li>
</ol>
<p>1번으로 가는 경우:</p>
<ul>
<li>app같은 웹사이트를 만들때</li>
<li>user interaction 이 많은 인터페이스일때</li>
<li>SEO 걱정이 없을때</li>
<li>react router가 괜찮을때</li>
</ul>
<p>React를 Django에 가깝게 유지하는 것은 인증이나 다른 것들을 쉽게 해준다. Django 빌트인 인증을 이용해서 사용자들의 등록이나 로그인을 만들 수 있고, 빌트인 Session 인증을 통해 토큰이나 JWT을 걱정하지 않을 수 있다.</p>
<p>3번으로 가는 경우:</p>
<ul>
<li>javascript 가 별로 필요없다</li>
<li>SEO를 신경써야한다</li>
</ul>
<h2 id="react-설정과-웹팩">React 설정과 웹팩</h2>
<p>1번으로 실습을 진행한다</p>
<p>Django와 React 조합의 장점은 API를 제공하는 Django Rest Framework이다. React는 &ldquo;frontend&quot;라는 개별적 app 으로 만들 것이다.</p>
<p>이전과 마찬가지로</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">django-admin startapp frontend
</code></pre></div><p>로 app을 만들어준다.</p>
<p>$HOME/django-drf-react-quickstart/project/ 밑에 frontend라는 디렉토리가 생겼을것이다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mkdir -p ./frontend/src/components
</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mkdir -p ./frontend/<span style="color:#ce5c00;font-weight:bold">{</span>static,templates<span style="color:#ce5c00;font-weight:bold">}</span>/frontend
</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#204a87">cd</span> ..
// <span style="color:#000">$HOME</span>/django-drf-react-quickstart
npm init -y
// npm 환경 초기화
npm i webpack webpack-cli --save-dev
</code></pre></div><p>webpack과 webpack-cli를 설치한 후 package.json에 scripts를 아래와 같이 설정한다</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#4e9a06">&#34;scripts&#34;</span>: <span style="color:#ce5c00;font-weight:bold">{</span>
  <span style="color:#4e9a06">&#34;dev&#34;</span>: <span style="color:#4e9a06">&#34;webpack --mode development ./project/frontend/src/index.js --output ./project/frontend/static/frontend/main.js&#34;</span>,
  <span style="color:#4e9a06">&#34;build&#34;</span>: <span style="color:#4e9a06">&#34;webpack --mode production ./project/frontend/src/index.js --output ./project/frontend/static/frontend/main.js&#34;</span>
<span style="color:#ce5c00;font-weight:bold">}</span>
</code></pre></div><p>그리고 코드 트랜스파일을 위해 babel을 설치한다</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">npm i @babel/core babel-loader @babel/preset-env @babel/preset-react babel-plugin-transform-class-properties --save-dev
</code></pre></div><p>babel-plugin-transform-class-properties 는 ES6 클래스 static property를 사용하기 위해 필수적이다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">npm i react react-dom prop-types --save-dev
</code></pre></div><p>React와 prop-type도 설치한다</p>
<p>프로젝트 폴더내에 .babelrc 라는 새로운 파일을 만들어 babel 을 설정해준다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#ce5c00;font-weight:bold">{</span>
    <span style="color:#4e9a06">&#34;presets&#34;</span>: <span style="color:#ce5c00;font-weight:bold">[</span>
        <span style="color:#4e9a06">&#34;@babel/preset-env&#34;</span>, <span style="color:#4e9a06">&#34;@babel/preset-react&#34;</span>
    <span style="color:#ce5c00;font-weight:bold">]</span>,
    <span style="color:#4e9a06">&#34;plugins&#34;</span>: <span style="color:#ce5c00;font-weight:bold">[</span>
        <span style="color:#4e9a06">&#34;transform-class-properties&#34;</span>
    <span style="color:#ce5c00;font-weight:bold">]</span>
<span style="color:#ce5c00;font-weight:bold">}</span>
</code></pre></div><p>마지막으로 webpack.config.js라는 파일을 작성하여 babel-loader를 설정해준다</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">module.exports <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#ce5c00;font-weight:bold">{</span>
  module: <span style="color:#ce5c00;font-weight:bold">{</span>
    rules: <span style="color:#ce5c00;font-weight:bold">[</span>
      <span style="color:#ce5c00;font-weight:bold">{</span>
        test: /<span style="color:#4e9a06">\.</span>js$/,
        exclude: /node_modules/,
        use: <span style="color:#ce5c00;font-weight:bold">{</span>
          loader: <span style="color:#4e9a06">&#34;babel-loader&#34;</span>
        <span style="color:#ce5c00;font-weight:bold">}</span>
      <span style="color:#ce5c00;font-weight:bold">}</span>
    <span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">}</span>
<span style="color:#ce5c00;font-weight:bold">}</span><span style="color:#000;font-weight:bold">;</span>
</code></pre></div><p>셋팅 끝!</p>
<h2 id="react-frontend-1">React Frontend</h2>
<p>./frontend/views.py를 작성한다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">django.shortcuts</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">render</span>
<span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">index</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">request</span><span style="color:#000;font-weight:bold">):</span>
	<span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">render</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">request</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;frontend/index.html&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>./frontend/templates/frontend/index.html을 작성한다</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="color:#8f5902;font-style:italic">&lt;!DOCTYPE html&gt;</span>
<span style="color:#000;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">html</span><span style="color:#000;font-weight:bold">&gt;</span>
<span style="color:#000;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">head</span><span style="color:#000;font-weight:bold">&gt;</span>
  <span style="color:#000;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">meta</span> <span style="color:#c4a000">charset</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;utf-8&#34;</span><span style="color:#000;font-weight:bold">&gt;</span>
  <span style="color:#000;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">meta</span> <span style="color:#c4a000">name</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;viewport&#34;</span> <span style="color:#c4a000">content</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;width=device-width, initial-scale=1&#34;</span><span style="color:#000;font-weight:bold">&gt;</span>
  <span style="color:#000;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">link</span> <span style="color:#c4a000">rel</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;stylesheet&#34;</span> <span style="color:#c4a000">href</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;https://cdnjs.cloudflare.com/ajax/libs/bulma/0.6.2/css/bulma.min.css&#34;</span><span style="color:#000;font-weight:bold">&gt;</span>
  <span style="color:#000;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">title</span><span style="color:#000;font-weight:bold">&gt;</span>Django DRF - React : Quickstart - Valentino G. - www.valentinog.com<span style="color:#000;font-weight:bold">&lt;/</span><span style="color:#204a87;font-weight:bold">title</span><span style="color:#000;font-weight:bold">&gt;</span>
<span style="color:#000;font-weight:bold">&lt;/</span><span style="color:#204a87;font-weight:bold">head</span><span style="color:#000;font-weight:bold">&gt;</span>
<span style="color:#000;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">body</span><span style="color:#000;font-weight:bold">&gt;</span>
  <span style="color:#000;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">section</span> <span style="color:#c4a000">class</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;section&#34;</span><span style="color:#000;font-weight:bold">&gt;</span>
    <span style="color:#000;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">div</span> <span style="color:#c4a000">class</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;container&#34;</span><span style="color:#000;font-weight:bold">&gt;</span>
          <span style="color:#000;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">div</span> <span style="color:#c4a000">id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;app&#34;</span> <span style="color:#c4a000">class</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;columns&#34;</span><span style="color:#000;font-weight:bold">&gt;</span><span style="color:#8f5902;font-style:italic">&lt;!-- React --&gt;</span><span style="color:#000;font-weight:bold">&lt;/</span><span style="color:#204a87;font-weight:bold">div</span><span style="color:#000;font-weight:bold">&gt;</span>
    <span style="color:#000;font-weight:bold">&lt;/</span><span style="color:#204a87;font-weight:bold">div</span><span style="color:#000;font-weight:bold">&gt;</span>
  <span style="color:#000;font-weight:bold">&lt;/</span><span style="color:#204a87;font-weight:bold">section</span><span style="color:#000;font-weight:bold">&gt;</span>
<span style="color:#000;font-weight:bold">&lt;/</span><span style="color:#204a87;font-weight:bold">body</span><span style="color:#000;font-weight:bold">&gt;</span>
<span style="color:#000;font-weight:bold">&lt;/</span><span style="color:#204a87;font-weight:bold">html</span><span style="color:#000;font-weight:bold">&gt;</span>
</code></pre></div><p>마지막에서 frontend/main.js를 호출한다</p>
<p>./project/urls.py를 열고</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000">urlpatterns</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">[</span>
    <span style="color:#000">path</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">include</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;leads.urls&#39;</span><span style="color:#000;font-weight:bold">)),</span>
    <span style="color:#000">path</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">include</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;frontend.urls&#39;</span><span style="color:#000;font-weight:bold">)),</span>
<span style="color:#000;font-weight:bold">]</span>
</code></pre></div><p>frontend.urls를 포함해준다</p>
<p>./frontend/urls.py를 열고</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">django.urls</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">path</span>
<span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">.</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">views</span>
<span style="color:#000">urlpatterns</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">[</span>
    <span style="color:#000">path</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">views</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">index</span> <span style="color:#000;font-weight:bold">),</span>
<span style="color:#000;font-weight:bold">]</span>
</code></pre></div><p>view를 연결해준다.</p>
<p>./project/settings.py를 열고 installed_app에 frontend를 추가해준다</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000">INSTALLED_APPS</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">[</span>
    <span style="color:#4e9a06">&#39;django.contrib.admin&#39;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#4e9a06">&#39;django.contrib.auth&#39;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#4e9a06">&#39;django.contrib.contenttypes&#39;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#4e9a06">&#39;django.contrib.sessions&#39;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#4e9a06">&#39;django.contrib.messages&#39;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#4e9a06">&#39;django.contrib.staticfiles&#39;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#4e9a06">&#39;leads&#39;</span><span style="color:#000;font-weight:bold">,</span> 
    <span style="color:#4e9a06">&#39;rest_framework&#39;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#4e9a06">&#39;frontend&#39;</span> <span style="color:#8f5902;font-style:italic"># enable the frontend app</span>
<span style="color:#000;font-weight:bold">]</span>
</code></pre></div><p>지금 서버를 실행시켜보면</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">python manage.py runserver
</code></pre></div><p>아무것도 안뜬다. React가 없기 떄문.</p>
<p>React frontend를 만들기 위해서 3개의 컴포넌트가 필요한데,</p>
<ol>
<li>Mother Component인 App</li>
<li>data fetching을 위한 stateful component인 Dataprovider</li>
<li>데이터 display를 위한 stateless component 인 Table</li>
</ol>
<h3 id="app">App</h3>
<div id="app"> </div> 에 react를 붙히기 위한 메인 컴포넌트이다.
./frontend/src/components/App.js라는 파일을 만든다.
```python
import React from "react";
import ReactDOM from "react-dom";
import DataProvider from "./DataProvider";
import Table from "./Table";
const App = () => (
  <DataProvider endpoint="api/lead/" 
                render={data => <Table data={data} />} />
);
const wrapper = document.getElementById("app");
wrapper ? ReactDOM.render(<App />, wrapper) : null;
```

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-4cb1018c33a47db3bc3d07ddce484bf4">언니가 사준 맥 립스틱 색깔</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2019-10-19" class="text-muted">2019.10.19</time>
        
	</div>
	<p>MAC</p>
<p>&ldquo;LUSTRE LIPSTICK ROUGE A LEVRE&rdquo;</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-2ba4924ed323a7f7575d27a5347cb5ff">How to study GOlang</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2019-10-16" class="text-muted">2019.10.16</time>
        
	</div>
	<p><a href="https://golangexample.com/">https://golangexample.com/</a></p>
<p><a href="https://levelup.gitconnected.com/crud-restful-api-with-go-gorm-jwt-postgres-mysql-and-testing-460a85ab7121">https://levelup.gitconnected.com/crud-restful-api-with-go-gorm-jwt-postgres-mysql-and-testing-460a85ab7121</a></p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-e0452db584ade6c5afb908229e686e8b">리뷰해보고 싶은 Gin Boilerplate</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2019-10-16" class="text-muted">2019.10.16</time>
        
	</div>
	<p><a href="https://github.com/yakuter/ugin">https://github.com/yakuter/ugin</a></p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-f378d86b2613e0fa3334030ba313b7fb">Dataproc</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2019-10-15" class="text-muted">2019.10.15</time>
        
	</div>
	<p>Dataproc</p>
<p>Overview</p>
<p>Cloud Dataproc은 spark이나 하둡 클러스터를 더 쉽고 효율적으로 운영하기 위한 빠르고, 쓰기 쉬운, 완전 관리형 클라우드 서비스이다. 몇 시간이나 며칠 걸리는 운영 작업 대신에 Cloud Dataproc을 만들어서, 데이터 파이프라인을 위한 클러스터 증설등의 걱정을 없앨 수 있습니다.
이 실험은 GCP 콘솔을 이용해서 구글 클라우드 Dataproc cluster를 만들고, 해당 클러스터에서 간단한 아파치 스팤 잡을 수행하고, 클러스터 내에서 워커의 수를 수정하는 예제입니다.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-433f8ffea0d4a2ddbdbae09c58e69202">Dataproc</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2019-10-15" class="text-muted">2019.10.15</time>
        
	</div>
	<p><a href="https://google.qwiklabs.com/focuses/672?parent=catalog">https://google.qwiklabs.com/focuses/672?parent=catalog</a></p>
<p>Introduction
Cloud Dataproc is a managed Spark and Hadoop service that lets you take advantage of open source data tools for batch processing, querying, streaming, and machine learning. Cloud Dataproc automation helps you create clusters quickly, manage them easily, and save money by turning clusters off when you don&rsquo;t need them. With less time and money spent on administration, you can focus on your jobs and your data.</p>
<p>Consider using Cloud Dataproc to scale out compute-intensive jobs that meet these characteristics:</p>
<p>The job is <strong>embarrassingly parallel</strong>—in other words, you can process different subsets of the data on different machines.
You already have Apache Spark code that does the computation or you are familiar with Apache Spark.
The distribution of the work is pretty uniform across your data subsets.
If different subsets require different amounts of processing (or if you don&rsquo;t already know Apache Spark), Apache Beam on Cloud Dataflow is a compelling alternative because it provides autoscaling data pipelines.</p>
<p>In this lab, the job that you will run outlines the faces in the image using a set of image processing rules specified in OpenCV. The Vision API is a better way to do this, since these sort of hand-coded rules don&rsquo;t work all that well, but this lab is an example of doing a compute-intensive job in a distributed way.</p>
<p>Setup</p>
<p>Install Software
Now we&rsquo;ll set up the software to run the job. Using sbt, an open source build tool, you&rsquo;ll build the JAR for the job you&rsquo;ll submit to the Cloud Dataproc cluster. This JAR will contain the program and the required packages necessary to run the job. The job will detect faces in a set of image files stored in a Google Cloud Storage (GCS) bucket, and write out image files with the faces outlined, to either the same or to another Cloud Storage bucket.</p>
<p>Create a Cloud Dataproc cluster
Step 1
Run the following commands in the SSH window to name your cluster and to set the MYCLUSTER variable. You&rsquo;ll be using the variable in commands to refer to your cluster:</p>
<p>MYCLUSTER=&quot;${USER/_/-}-qwiklab&quot;
echo MYCLUSTER=${MYCLUSTER}
Step 2
Set a default GCE zone to use (preferably the one you used for your development machine) and create a new cluster:</p>
<p>gcloud config set compute/zone us-central1-a
gcloud dataproc clusters create ${MYCLUSTER} &ndash;worker-machine-type=n1-standard-2 &ndash;master-machine-type=n1-standard-2
This might take a couple minutes. The default cluster settings, which include two worker nodes, should be sufficient for this lab. n1-standard-2 is specified as both the worker and master machine type to reduce the overall number of cores used by the cluster.</p>
<p>See the Cloud SDK gcloud dataproc clusters create command for information on using command line flags to customize cluster settings.
Submit your job to Cloud Dataproc
In this lab the program you&rsquo;re running is used as a face detector, so the inputted haar classifier must describe a face. A haar classifier is an XML file that is used to describe features that the program will detect. You will download the haar classifier file and include its GCS path in the first argument when you submit your job to your Cloud Dataproc cluster.</p>
<p>Step 1
Run the following command in the SSH window to load the face detection configuration file into your bucket:</p>
<p>curl <a href="https://raw.githubusercontent.com/opencv/opencv/master/data/haarcascades/haarcascade_frontalface_default.xml">https://raw.githubusercontent.com/opencv/opencv/master/data/haarcascades/haarcascade_frontalface_default.xml</a> | gsutil cp - gs://${MYBUCKET}/haarcascade_frontalface_default.xml
Step 2
Use the set of images you uploaded into the imgs directory in your GCS bucket as input to your Feature Detector. You must include the path to that directory as the second argument of your job-submission command.</p>
<p>Submit your job to Cloud Dataproc:</p>
<p>cd ~/cloud-dataproc/codelabs/opencv-haarcascade
gcloud dataproc jobs submit spark<br>
&ndash;cluster ${MYCLUSTER}<br>
&ndash;jar target/scala-2.10/feature_detector-assembly-1.0.jar &ndash;<br>
gs://${MYBUCKET}/haarcascade_frontalface_default.xml<br>
gs://${MYBUCKET}/imgs/<br>
gs://${MYBUCKET}/out/
You can add any other images to use to the GCS bucket specified in the second argument.</p>
<p>Step 3
Monitor the job, in the Console go to Navigation menu &gt; Dataproc &gt; Jobs. Move on to the next step when you get a similar output:</p>
<p>job-complete.png</p>
<p>Step 4
When the job is complete, go to Navigation menu &gt; Storage and find the bucket you created (it will have your username followed by student-image followed by a random number) and click on it. Then click on an image in the Out directory. The image will download to your computer.</p>
<p>How accurate is the face detection? The Vision API is a better way to do this, since this sort of hand-coded rules don&rsquo;t work all that well. You can see how it works next.</p>
<p>Step 5 (Optional)
Go back to the imgs folder and click on the other images you uploaded to your bucket. This will download the three sample images. Save them to your computer.</p>
<p>Navigate to the Vision API page, scroll down to the Try the API section and upload the images you downloaded from your bucket. You&rsquo;ll see the results of the image detection in seconds. The underlying machine learning models keep improving, so your results may not be the same:</p>
<p>result1.png result2.png result3.png</p>
<p>Step 6 (Optional)
If you want to experiment with improving the Feature Detector, you can make edits to the FeatureDetector code, then rerun sbt assembly and the gcloud dataproc and jobs submit commands.</p>
<p>Congratulations!
You learned how to spin up a Cloud Dataproc cluster and run jobs!</p>
<p>Data_Science_125_2.png</p>
<p>Finish Your Quest
This self-paced lab is part of the Qwiklabs Quest Scientific Data Processing. A Quest is a series of related labs that form a learning path. Completing this Quest earns you the badge above, to recognize your achievement. You can make your badge (or badges) public and link to them in your online resume or social media account. Enroll in this Quest and get immediate completion credit if you&rsquo;ve taken this lab. See other available Qwiklabs Quests.</p>
<p>Take Your Next Lab
Continue your Quest with Distributed Computation of NDVI from Landsat Images using Cloud Dataflow, or try one of these:</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-5b7cccb8a01fb35797a2e436cba41ed8">VPC and NAT</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2019-10-15" class="text-muted">2019.10.15</time>
        
	</div>
	<p>Data ingestion from server</p>
<p>Stackdriver</p>
<ul>
<li>로깅</li>
<li>모니터링</li>
</ul>
<p>vs elastic search (+kibana)</p>
<p>비용절감.</p>
<p>워크샵에서는 qwiklab이라는 시스템을 이용해서 실습을 진행한다. 실습용 profile을 받고, 해당 profile의 cloud console에 접속하여 진행하기 때문에 해당 실습이 종료되면 profile 삭제등으로 크레딧이 청구될 일이 없다는 장점이 있다. 실제로 다른 워크샵에서는 리소스를 깨끗히 정리하지 못해서 비용이 청구되는 일이 굉장히 많은데, 이 부분을 깔끔히 해결했다.</p>
<p>이 예제에서는 쿠버네티스 엔진 클러스터를 만들고, 간단한 샘플 어플리케이션을 배포한다. 기본적으로 GCP의 쿠버네티스 엔진 클러스터는 Terraform 을 이용해서 일단 application을 Kubernetes cluster에 배포한다.</p>
<blockquote>
<p><em>Note</em>: Terraform이란 무엇?</p>
<ul>
<li>테라폼은 오픈소스 인프라 스트럭처 관리 도구이다. Chef나 Ansible과 같은 Provisoning
세 가지의 terraform 파일을 사용하는데, main.tf, provider.tf, variables.tf 이다. Terraform은 특정 디렉토리의 모든 tf 확장자 파일을 읽어들여 리소스 생성/수정/삭제를 진행하므로,
어떤식으로 tf 파일을 작성할지에 대해서 제한은 없지만, 이 튜토리얼에서는 3개로 나눠서 진행하였다. 먼저, provider.tf는 이름에서도 알수 있듯이,</li>
</ul>
</blockquote>
<p>For instance, Terraform can build out GCP projects and compute instances, etc., even set up a Kubernetes Engine cluster and deploy applications to it. When requirements change, the descriptor can be updated and Terraform will adjust the cloud infrastructure accordingly.
예를 들어, 테라폼은</p>
<hr>
<p>Deployment
Following the principles of Infrastructure as Code and Immutable Infrastructure, Terraform supports the writing of declarative descriptions of the desired state of infrastructure. When the descriptor is applied, Terraform uses GCP APIs to provision and update resources to match. Terraform compares the desired state with the current state so incremental changes can be made without deleting everything and starting over. For instance, Terraform can build out GCP projects and compute instances, etc., even set up a Kubernetes Engine cluster and deploy applications to it. When requirements change, the descriptor can be updated and Terraform will adjust the cloud infrastructure accordingly.</p>
<p>This example will start up a Kubernetes Engine cluster and deploy a simple sample application to it. By default, Kubernetes Engine clusters in GCP are provisioned with a pre-configured Fluentd-based collector that forwards logs to Stackdriver. Interacting with the sample app will produce logs that are visible in the Stackdriver Logging and other log event sinks.</p>
<p>Update the provider.tf file
Remove the provider version for the Terraform from the provider.tf script file.</p>
<p>Edit the provider.tf script file.</p>
<p>nano ~/gke-logging-sinks-demo/terraform/provider.tf</p>
<p>If the file contains static version string for the google provider as given below then remove it.</p>
<p>&hellip;.
provider &ldquo;google&rdquo; {
project = var.project
version = &ldquo;~&gt; 2.10.0&rdquo;
}</p>
<p>After modification your provider.tf script file should look like:</p>
<p>&hellip;
provider &ldquo;google&rdquo; {
project = var.project
}</p>
<p>Save the file.</p>
<p>Deploying the cluster
There are three Terraform files provided with this lab example. The first one, main.tf, is the starting point for Terraform. It describes the features that will be used, the resources that will be manipulated, and the outputs that will result. The second file is provider.tf, which indicates which cloud provider and version will be the target of the Terraform commands&ndash;in this case GCP.</p>
<p>The final file is variables.tf, which contains a list of variables that are used as inputs into Terraform. Any variables referenced in the main.tf that do not have defaults configured in variables.tf will result in prompts to the user at runtime.</p>
<p>To build out the environment you can execute the following make command:</p>
<p>make create</p>
<p>Note: If you get deprecation warnings related to the zone varibale, please ignore it and move forward in the lab.
Test Completed Task
Click Check my progress to verify your performed task. If you have successfully deployed necessary infrastructure with Terraform, you will see an assessment score.</p>
<p>Use Terraform to set up the necessary infrastructure
Validation
If no errors are displayed during deployment, after a few minutes you should see your Kubernetes Engine cluster in the GCP Console.</p>
<p>Go to Navigation menu &gt; Kubernetes Engine &gt; Clusters to see the cluster with the sample application deployed.</p>
<p>To validate that the demo deployed correctly, run:</p>
<p>make validate</p>
<p>Your output will look like this:</p>
<p>make_valid.png</p>
<p>Now that the application is deployed to Kubernetes Engine you can generate log data and use Stackdriver and other tools to view it.</p>
<p>어플리케이션은 쿠버네티스 엔진 위에 배포되기 때문에 로그 데이터를 생성하고 스택드라이버나 다른 툴을 사용해서 조회할 수 있다.</p>
<p>콘솔에서 Networking section -&gt; Network services로 가면 기본 TCP LB 가 셋업되있다. LB 상세보기를 선택하면 Frontend라고 써있고 IP 주소가 나와있다. 해당 주소를 복사해서 브라우저에 붙여넣어보면, 아까 테라폼으로 띄웠던 샘플 어플리케이션이 나온다. 브라우저에서 어플리케이션을 열때마다, Stackdriver logging에 로그 이벤트 들을 publish한다. 몇번 리프레쉬를 해줘서, 로그를 조금 쌓아주도록 하자.</p>
<p>Logs in Stackdriver
Stackdriver provides a UI for viewing log events. Basic search and filtering features are provided, which can be useful when debugging system issues. The Stackdriver Logging is best suited to exploring more recent log events. Users requiring longer-term storage of log events should consider some of the tools you&rsquo;ll explore in the following sections.</p>
<p>To access the Stackdriver Logging console perform the following steps:</p>
<p>In the GCP Console, from the Navigation menu, in the Stackdriver section, click on Logging.
On this page change the Audited Resource filter to Kubernetes Container &gt; stackdriver-logging &gt; default. stackdriver-logging is the cluster; and default is the namespace).
Stack_clustername_default.png</p>
<p>On this screen, you can expand the bulleted log items to view more details about a log entry.
Stackdriver_GKE_error-log.png</p>
<p>On the logging console, you can perform any type of text search, or try out the various filters by log type, log level, timeframe, etc.</p>
<p>Viewing Log Exports
The Terraform configuration built out two Log Export Sinks. To view the sinks perform the following steps:</p>
<p>you should still be on the Stackdriver -&gt; Logging page.</p>
<p>In the left navigation menu, click on the Exports menu option.</p>
<p>This will bring you to the Exports page. You should see two Sinks in the list of log exports.</p>
<p>You can edit/view these sinks by clicking on the context menu (three dots) to the right of a sink and selecting the Edit sink option.</p>
<p>Additionally, you could create additional custom export sinks by clicking on the Create Export option in the top of the navigation window.</p>
<p>Logs in Cloud Storage
Log events can be stored in Cloud Storage, an object storage system suitable for archiving data. Policies can be configured for Cloud Storage buckets that, for instance, allow aging data to expire and be deleted while more recent data can be stored with a variety of storage classes affecting price and availability.</p>
<p>The Terraform configuration created a Cloud Storage Bucket named stackdriver-gke-logging- to which logs will be exported for medium to long-term archival. In this example, the Storage Class for the bucket is defined as Nearline because the logs should be infrequently accessed in a normal production environment (this will help to manage the costs of medium-term storage). In a production scenario, this bucket may also include a lifecycle policy that moves the content to Coldline storage for cheaper long-term storage of logs.</p>
<p>To access the Stackdriver logs in Cloud Storage perform the following steps:</p>
<p>In the GCP Console from the Navigation menu click Storage.
Find the Bucket with the name stackdriver-gke-logging-<random-Id>, and click on the name.
You should see a list of directories corresponding to pods running in the cluster (e.g. autoscaler, dnsmasq, etc.).
Cloud Storage Bucket</p>
<p>You can click into any of the folders to browse specific log details like heapster, kubedns, sidecar, etc.</p>
<p>Logs in BigQuery
Stackdriver log events can be configured to be published to BigQuery, a data warehouse tool that supports fast, sophisticated, querying over large data sets.</p>
<p>The Terraform configuration will create a BigQuery DataSet named gke_logs_dataset. This dataset will be setup to include all Kubernetes Engine related logs for the last hour (by setting a Default Table Expiration for the dataset). A Stackdriver Export will be created that pushes Kubernetes Engine container logs to the dataset.</p>
<p>To access the Stackdriver logs in BigQuery, perform the following steps:</p>
<p>Note: The BigQuery Export is not populated immediately. It may take a few moments for logs to appear.</p>
<p>On the GCP console from Navigation menu, in the Big Data section, click on BigQuery.
In the left menu, click on your project name. You should see a dataset named gke_logs_dataset. Expand this dataset to view the tables that exist (Note: The dataset is created immediately, but the tables are what is generated as logs are written and new tables are needed).
Click on one of the tables to view the table details.
Review the schema of the table to note the column names and their data types. This information can be used in the next step when you query the table to look at the data.
BQ_logs_dataset.png</p>
<p>Click on Query Table towards the top right to perform a custom query against the table.
This adds a query to the Query Editor, but it has a syntax error.
Edit the query to add an asterisk (*) after Select to pull in all details from the current table. Note: A Select * query is generally very expensive and not advised. For this lab the dataset is limited to only the last hour of logs, so the overall dataset is relatively small.
Click Run to execute the query and return some results from the table.
The results window should display some rows and columns. You can scroll through the various rows of data that are returned. If you want, execute some custom queries that filter for specific data based on the results that were shown in the original query.</p>
<p>Test Completed Task
Click Check my progress to verify your performed task. If BigQuery sink written logs in BigQuery dataset, you will see an assessment score.</p>
<p>View Logs in BigQuery
Teardown
Qwiklabs will take care of shutting down all the resources used for this lab, but here’s what you would need to do to clean up your own environment to save on cost and to be a good cloud citizen:</p>
<p>make teardown</p>
<p>Since Terraform tracks the resources it created it is able to tear them all down.</p>
<p>Troubleshooting for your production environment
The install script fails with a Permission denied when running Terraform.
The credentials that Terraform is using do not provide the necessary permissions to create resources in the selected projects. Ensure that the account listed in gcloud config list has necessary permissions to create resources. If it does, regenerate the application default credentials using gcloud auth application-default login.</p>
<p>Cloud Storage Bucket not populated
Once the Terraform configuration is complete the Cloud Storage Bucket will be created, but it is not always populated immediately with log data from the Kubernetes Engine cluster. Give the process some time because it can take up to 2 to 3 hours before the first entries start appearing (<a href="https://cloud.google.com/logging/docs/export/using_exported_logs)">https://cloud.google.com/logging/docs/export/using_exported_logs)</a>.</p>
<p>No tables created in the BigQuery dataset
Once the Terraform configuration is complete the BigQuery Dataset will be created but it will not always have tables created in it by the time you go to review the results. The tables are rarely populated immediately. Give the process some time (minimum of 5 minutes) before determining that something is not working properly.</p>
<p><em>Bigquery dataset에 테이블이 존재하지 않을때</em>
테라폼 설정이 완료되어</p>
<p>Congratulations
Enterprise-Customers.png stackdriver-logging-badge.png</p>
<p>Finish Your Quest
This self-paced lab is part of the Qwiklabs Google Kubernetes Engine Best Practices and Stackdriver Logging Quests. A Quest is a series of related labs that form a learning path. Completing a Quest earns you a badge to recognize your achievement. You can make your badge (or badges) public and link to them in your online resume or social media account. Enroll in either Quest and get immediate completion credit if you&rsquo;ve taken this lab. See other available Qwiklabs Quests.</p>
<p>Next Steps / Learn More
Kubernetes Engine Logging
Viewing Logs
Advanced Logs Filters
Overview of Logs Exports
Procesing Logs at Scale Using Cloud Dataflow
Terraform Google Cloud Provider
Google Cloud Training &amp; Certification
&hellip;helps you make the most of Google Cloud technologies. Our classes include technical skills and best practices to help you get up to speed quickly and continue your learning journey. We offer fundamental to advanced level training, with on-demand, live, and virtual options to suit your busy schedule. Certifications help you validate and prove your skill and expertise in Google Cloud technologies.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-cc8e3e9b4e558982e4f8ac1a2a319e49">golang slice</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2019-10-10" class="text-muted">2019.10.10</time>
        
	</div>
	<p>slice에서</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#204a87;font-weight:bold">var</span> <span style="color:#000">bSlice</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">string</span>
<span style="color:#000">aSlice</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">getSlice</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">param</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#8f5902;font-style:italic">// getSlice에서는 slice를 make하고 return한다
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">bSlice</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#000">aSlice</span>
</code></pre></div><p>이렇게 하면 bSlice와 aSlice는 같은 Slice를 보고 있게 된다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000">bSlice</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;first&#34;</span>
<span style="color:#000">fmt</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">aSlice</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">])</span>
<span style="color:#8f5902;font-style:italic">// first
</span></code></pre></div><p>즉, 두 개의 slice 포인터가 내부적으로는 같은 slice를 바라보게 되는것이다.
주의해서 사용해야하지만, 메모리를 약간이라도 아낄수있다. 메모리 할당을 두번할걸 한번으로 줄였기 때문이다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000">IntersectionString</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">left</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">right</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">string</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#000">m</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#204a87">make</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">map</span><span style="color:#000;font-weight:bold">[</span><span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">]</span><span style="color:#204a87;font-weight:bold">bool</span><span style="color:#000;font-weight:bold">)</span>

	<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">_</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">value</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#204a87;font-weight:bold">range</span> <span style="color:#000">left</span> <span style="color:#000;font-weight:bold">{</span>
		<span style="color:#000">m</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">true</span>
	<span style="color:#000;font-weight:bold">}</span>

	<span style="color:#204a87;font-weight:bold">var</span> <span style="color:#000">res</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">string</span>
	<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">_</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">value</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#204a87;font-weight:bold">range</span> <span style="color:#000">right</span> <span style="color:#000;font-weight:bold">{</span>
		<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">_</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">ok</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">m</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">];</span> <span style="color:#000">ok</span> <span style="color:#000;font-weight:bold">{</span>
			<span style="color:#000">res</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#204a87">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">res</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">value</span><span style="color:#000;font-weight:bold">)</span>
		<span style="color:#000;font-weight:bold">}</span>
	<span style="color:#000;font-weight:bold">}</span>

	<span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">res</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>이는 두 []string slice의 교집합을 찾는 함수이다. 일단 bool 타입을 값을 가지는 map으로 만든후, 왼쪽 slice의 값을 모두 key로 만든후 value에 true를 대입한다.</p>
<p>아래는 해당 교집합 함수를 각각 O(n^2)와 O(n)의 시간복잡도를 가지는 두 테스트 함수로 시간을 비교하는 테스트 함수이다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000">TestIntersectionSpeed</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">testing</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">T</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#204a87;font-weight:bold">var</span> <span style="color:#000">a</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">int</span>
	<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#000;font-weight:bold">&lt;</span> <span style="color:#0000cf;font-weight:bold">10000000</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span> <span style="color:#000;font-weight:bold">{</span>
		<span style="color:#000">a</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#204a87">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">a</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#000;font-weight:bold">}</span>

	<span style="color:#204a87;font-weight:bold">var</span> <span style="color:#000">b</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">int</span>
	<span style="color:#204a87;font-weight:bold">var</span> <span style="color:#000">c</span> <span style="color:#204a87;font-weight:bold">int</span>

	<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#000;font-weight:bold">&lt;</span> <span style="color:#0000cf;font-weight:bold">300000</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span> <span style="color:#000;font-weight:bold">{</span>
		<span style="color:#000">c</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#000">rand</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Intn</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">100000</span><span style="color:#000;font-weight:bold">)</span>
		<span style="color:#000">b</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#204a87">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">b</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">c</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#000;font-weight:bold">}</span>

	<span style="color:#000">boolMap</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#204a87">make</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">map</span><span style="color:#000;font-weight:bold">[</span><span style="color:#204a87;font-weight:bold">int</span><span style="color:#000;font-weight:bold">]</span><span style="color:#204a87;font-weight:bold">bool</span><span style="color:#000;font-weight:bold">)</span>

	<span style="color:#000">t</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Run</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;test double loop&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">func</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">testing</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">T</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
		<span style="color:#204a87;font-weight:bold">var</span> <span style="color:#000">commonId</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">int</span>
		<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">_</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">val</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#204a87;font-weight:bold">range</span> <span style="color:#000">b</span> <span style="color:#000;font-weight:bold">{</span>
			<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">_</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">valA</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#204a87;font-weight:bold">range</span> <span style="color:#000">a</span> <span style="color:#000;font-weight:bold">{</span>
				<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">valA</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#000">val</span> <span style="color:#000;font-weight:bold">{</span>
					<span style="color:#000">a</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#204a87">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">commonId</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">val</span><span style="color:#000;font-weight:bold">)</span>
				<span style="color:#000;font-weight:bold">}</span>
			<span style="color:#000;font-weight:bold">}</span>
		<span style="color:#000;font-weight:bold">}</span>
	<span style="color:#000;font-weight:bold">})</span>
	
	<span style="color:#000">t</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Run</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;test single loop&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">func</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">testing</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">T</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
		<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">_</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">id</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#204a87;font-weight:bold">range</span> <span style="color:#000">b</span> <span style="color:#000;font-weight:bold">{</span>
			<span style="color:#000">boolMap</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">id</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">true</span>
		<span style="color:#000;font-weight:bold">}</span>
		<span style="color:#204a87;font-weight:bold">var</span> <span style="color:#000">commonId</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">int</span>
		<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">_</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">val</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#204a87;font-weight:bold">range</span> <span style="color:#000">a</span> <span style="color:#000;font-weight:bold">{</span>
			<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">_</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">ok</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">boolMap</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">val</span><span style="color:#000;font-weight:bold">];</span> <span style="color:#000">ok</span> <span style="color:#000;font-weight:bold">{</span>
				<span style="color:#000">commonId</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#204a87">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">commonId</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">val</span><span style="color:#000;font-weight:bold">)</span>
			<span style="color:#000;font-weight:bold">}</span>
		<span style="color:#000;font-weight:bold">}</span>
	<span style="color:#000;font-weight:bold">})</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>하지만 놀랍게도,</p>
<pre><code>=== RUN   Test
--- PASS: Test (0.27s)
=== RUN   Test/test_double_loop
    --- PASS: Test2/test_double_loop (0.01s)
=== RUN   Test/test_single_loop
    --- PASS: Test2/test_single_loop (0.02s)
	PASS
</code></pre><p>밑에 꺼가 더 오래걸리게 나온다.</p>
<p>Slice는 참조시에 메모리가 붙어서 더 빠르게 가능하다는 이야기를 하는데, 아래 글을 참조해야한다고 한다.</p>
<p><a href="https://jacking75.github.io/go_PerformanceTuning/">https://jacking75.github.io/go_PerformanceTuning/</a></p>
<p><a href="https://medium.com/swlh/golang-tips-why-pointers-to-slices-are-useful-and-how-ignoring-them-can-lead-to-tricky-bugs-cac90f72e77b">https://medium.com/swlh/golang-tips-why-pointers-to-slices-are-useful-and-how-ignoring-them-can-lead-to-tricky-bugs-cac90f72e77b</a></p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-4224d92d0c2e1fd7e73c91c70622233f">VPC and NAT</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2019-10-07" class="text-muted">2019.10.07</time>
        
	</div>
	<h1 id="ultimate-setup-for-your-next-golang-project">Ultimate Setup for Your Next Golang Project</h1>
<p><a href="https://towardsdatascience.com/ultimate-setup-for-your-next-golang-project-1cc989ad2a96">https://towardsdatascience.com/ultimate-setup-for-your-next-golang-project-1cc989ad2a96</a></p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-85cddadd9e786089f6ba2938846297ab">Http connection reusing in Go</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2019-09-30" class="text-muted">2019.09.30</time>
        
	</div>
	<p><a href="https://stackoverflow.com/questions/17948827/reusing-http-connections-in-golang">https://stackoverflow.com/questions/17948827/reusing-http-connections-in-golang</a></p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-016edfdb0f84384ff5a6c8b520372ac4">VPC and NAT</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2019-09-30" class="text-muted">2019.09.30</time>
        
	</div>
	<p>VPC:
<a href="https://medium.com/harrythegreat/aws-%EA%B0%80%EC%9E%A5%EC%89%BD%EA%B2%8C-vpc-%EA%B0%9C%EB%85%90%EC%9E%A1%EA%B8%B0-71eef95a7098">https://medium.com/harrythegreat/aws-%EA%B0%80%EC%9E%A5%EC%89%BD%EA%B2%8C-vpc-%EA%B0%9C%EB%85%90%EC%9E%A1%EA%B8%B0-71eef95a7098</a></p>
<h1 id="vpc의-기본-컴포넌트들">VPC의 기본 컴포넌트들</h1>
<h2 id="vpc">VPC</h2>
<p>VPC는 Virtual Private Cloud의 줄임말로 &ldquo;가상 IP 네트워크&rdquo; 로 이해할 수 있다. 이는 클라우드 내에 가상 데이터 센터라고 할 수 있다. VPC내에 있는 서버들끼리는 연결되어있으며, 사설 IP(Private IP)를 통해 서로 통신할 수 있다.</p>
<blockquote>
<p>Note: 사설 IP란?
예를 들어 &lsquo;우리집 주소는 &ldquo;서울시 성동구 마장로 ~&rdquo; 이다&rsquo; 했을때 &ldquo;서울시~&ldquo;는 공인 IP라 할 수 있다. 반면 집 안에서 &ldquo;안방에 있는 손톱깎기 가져와&rdquo; 했을 때 &ldquo;안방&rdquo; 은 사설 IP라고 할 수 있다. 즉 외부에서 어떤 위치를 칭하는 주소는 공인 IP이고 내부에서는 사설 IP로 위치를 찾는다.</p>
</blockquote>
<p>VPC에서 사용하는 사설 IP 주소 대역은 다음과 같다.</p>
<table>
<thead>
<tr>
<th style="text-align:left">주소</th>
<th style="text-align:center">Prefix 비트 수</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">10.<em>.</em>.*</td>
<td style="text-align:center">8</td>
</tr>
<tr>
<td style="text-align:left">172.16.<em>.</em></td>
<td style="text-align:center">12</td>
</tr>
<tr>
<td style="text-align:left">192.168.<em>.</em></td>
<td style="text-align:center">16</td>
</tr>
</tbody>
</table>
<p><img src="https://docs.aws.amazon.com/ko_kr/vpc/latest/userguide/images/nondefault-vpc-diagram.png" alt=""></p>
<p>특정 VPC는 한 Region에 속해있고, 각각의 VPC는 완전히 독립적이다.</p>
<p>사설 IP 주소를 선택하는거나, subnet을 만드는거, 라우트 테이블, 네트워크 게이트웨이 VPC는 클라우드 상의 다른 가상 네트워크와 논리적으로 분리되어있다. VPC 내에서 리소스를 띄울 수 있는데, 해당 VPC에 특정 IP 주소 범위를 할당하고, 서브넷을 추가하고, 보안 그룹을 연결하고 라우트 테이블을 설정할 수 있다. VPC의 장점은 프라이버시, 보안, 개인정보 데이터 유실같은 측면에서 장점을 가진다.</p>
<h2 id="subnet">Subnet</h2>
<p>서브넷은 대형 네트워크를 소형 네트워크들로 나눈 것이라고 생각하면 된다. 당연히 가용한 IP 주소 범위도 더 작아지게 되지만, 작은 네트워크의 유지관리가 좀 더 수월하고, 다른 네트워크로부터의 보안등을 제공하기 위해 사용한다. 정 서브넷 내부에서 리소스를 띄울 수 있는데, 인터넷에 반드시 연결되어야하는 리소스들을 위해서는 Public 서브넷을 사용하고, 인터넷에 연결될 필요없는 리소스들을 위해서는 Private subnet을 사용하면 된다. 각 서브넷의 리소스를 보호하기 위해서는, 보안 그룹이나 네트워크 접근 제어 리스트(ACL)등 여러가지를 적용할 수 있다.</p>
<h2 id="route-table">Route Table</h2>
<p>라우트 테이블은 트래픽의 방향을 정해주는 안내표이다. 즉, 발생한 네트워크 요청이 올바른 타겟으로 향할 수 있도록 한다. VPC내에 여러개의 라우트 테이블을 가질 수 있다.</p>
<h2 id="internet-gateway">Internet Gateway</h2>
<p>인터넷 게이트웨이는 구축한 가상 네트워크를 외부와 연결하기 위한 관문이다.
<img src="https://docs.aws.amazon.com/ko_kr/vpc/latest/userguide/images/internet-gateway-overview-diagram.png" alt=""></p>
<p>위 그림과 같이 Public subnet의 Route Table에 0.0.0.0/0 에서 온 요청을 igw-id로 Mapping한다. 즉, 내부(선택한 사설 IP대역)에서 온 요청이 아닌, 외부(0.0.0.0)에서 온 네트워크 트래픽은 인터넷 게이트웨이로 향하게 하도록 한다.</p>
<h2 id="network-acl-and-security-group">NETWORK ACL and Security Group</h2>
<p>&ldquo;접근 제어 목록&quot;인 ACL은 각 Subnet에 설정할 수 있는 접근 규칙이다. 일종의 방화벽과 비슷하다. 보안그룹은 인스턴스 수준에서 작동하는 반면 VPC는 서브넷 레벨에서 작동한다. 웹 서버냐, 데이터베이스 서버냐에 따라 이 보안 그룹의 Rule은 다를 수 있다. 예를 들어 웹서버에서는 외부의 HTTP/HTTPS 요청을 모두 허용하고 데이터베이스 서버는 HTTP대신 인바운드 MySQL 액세스를 허용하는 규칙을 사용할 수 있다.</p>
<h2 id="nat">NAT</h2>
<p>Private Subnet이 외부와 통신할 때, NAT는 사설IP 주소를 공인 IP와 map해주는 역할을 한다. Public Subnet상에서 Private Subnet 상의 인스턴스의 인바운드/아웃바운드 요청을 처리한다.</p>
<p>Security groups: Security groups are a set of firewall rules that controls the traffic for your instance. In Amazon Firewall the only action that can be carried out is allow. You cannot create a rule to deny. The destination is always the instance on which the service security group is running. You can have a single security group associated with multiple instances.</p>
<p>Customer Gateway — An Amazon VPC VPN connection links your data center (or network) to your Amazon VPC (virtual private cloud). A customer gateway is the anchor on your side of that connection. It can be a physical or software appliance</p>
<p>NAT:</p>
<p><a href="https://blog.lael.be/post/9534">https://blog.lael.be/post/9534</a></p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-01b5fccd3bc6dcf7ca4588c125302d5c">Data consistency</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2019-09-27" class="text-muted">2019.09.27</time>
        
	</div>
	<p>global ordering 이 없는 경우:
카톡으로 질문도 안떴는데 대답이 먼저 보이는 경우</p>
<p>Eventual consistency:</p>
<p><a href="https://stackoverflow.com/questions/10078540/eventual-consistency-in-plain-english">https://stackoverflow.com/questions/10078540/eventual-consistency-in-plain-english</a></p>
<p><a href="https://hackernoon.com/eventual-vs-strong-consistency-in-distributed-databases-282fdad37cf7">https://hackernoon.com/eventual-vs-strong-consistency-in-distributed-databases-282fdad37cf7</a></p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-f5e9ba60b472dded5592163b23bd313d">AWS Sessions</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2019-09-26" class="text-muted">2019.09.26</time>
        
	</div>
	<p><a href="https://eksworkshop.com/logging/">https://eksworkshop.com/logging/</a></p>
<p>In this Chapter, we will deploy a common Kubernetes logging pattern which consists of the following:</p>
<p>Fluentd is an open source data collector providing a unified logging layer, supported by 500+ plugins connecting to many types of systems.
Elasticsearch is a distributed, RESTful search and analytics engine.
Kibana lets you visualize your Elasticsearch data.</p>
<p>App mesh
Controll flow
Data Flow</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-da90d78651569b6db86744d37c606564">Web Developer 101</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2019-09-24" class="text-muted">2019.09.24</time>
        
	</div>
	<p><a href="https://engineering.videoblocks.com/web-architecture-101-a3224e126947">https://engineering.videoblocks.com/web-architecture-101-a3224e126947</a></p>
<p>cmd+ shift+ f =&gt; find in path (goland)</p>
<p>코드 어딧는지 찾기 딱좋다!</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-7e135a0c12503feae8c395be8d8bba88">Go JSON</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2019-09-23" class="text-muted">2019.09.23</time>
        
	</div>
	<p><a href="https://medium.com/@masnun/making-http-requests-in-golang-dd123379efe7">https://medium.com/@masnun/making-http-requests-in-golang-dd123379efe7</a></p>
<p><a href="https://stackoverflow.com/questions/17156371/how-to-get-json-response-from-http-get/31129967#31129967">https://stackoverflow.com/questions/17156371/how-to-get-json-response-from-http-get/31129967#31129967</a></p>
<p><a href="https://www.reddit.com/r/golang/comments/4n46oo/question_does_jsondecode_jsonnewdecoder_close_the/">https://www.reddit.com/r/golang/comments/4n46oo/question_does_jsondecode_jsonnewdecoder_close_the/</a></p>
<p><a href="https://www.sohamkamani.com/blog/2017/10/18/parsing-json-in-golang/#parsing-json-strings">https://www.sohamkamani.com/blog/2017/10/18/parsing-json-in-golang/#parsing-json-strings</a></p>
<p>따라서 문자열을 ascii로 전송하혀면 string &gt; utf8 &gt; base64 또는 string &gt; euckr &gt; base64 등의 조합으로 표현 가능합니다.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-2a4201f5d0697dc78990ecced3be44b5">Panic Recover</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2019-09-23" class="text-muted">2019.09.23</time>
        
	</div>
	<p>// The recover built-in function allows a program to manage behavior of a
// panicking goroutine. Executing a call to recover inside a deferred
// function (but not any function called by it) stops the panicking sequence
// by restoring normal execution and retrieves the error value passed to the
// call of panic. If recover is called outside the deferred function it will
// not stop a panicking sequence. In this case, or when the goroutine is not
// panicking, or if the argument supplied to panic was nil, recover returns
// nil. Thus the return value from recover reports whether the goroutine is
// panicking.</p>
<p>빌트인 리커버 function은 프로그램이 고루틴 패닉을 관리한다. defer된 함수안에서 recover를 호출하는 것은 일반적인 실행을 복구하고 panic을 호출한 에러값을 회수한다. recover가 그 defer된 함수 밖에서 호출되면 panic 상황을 멈출 수 없을 것이다. 이런 상황에서는, 또는 고루틴이 panic이 아닐때에는, panic으로 공급된</p>
<p><a href="https://haisum.github.io/2017/09/11/golang-ioutil-readall/">https://haisum.github.io/2017/09/11/golang-ioutil-readall/</a></p>
<p><a href="https://mingrammer.com/translation-avoiding-memory-leak-in-golang-api/">https://mingrammer.com/translation-avoiding-memory-leak-in-golang-api/</a></p>
<p><a href="https://ahmet.im/blog/golang-json-decoder-pitfalls/">https://ahmet.im/blog/golang-json-decoder-pitfalls/</a></p>
<p><a href="https://github.com/google/go-github/pull/317">https://github.com/google/go-github/pull/317</a></p>
<p><a href="http://devs.cloudimmunity.com/gotchas-and-common-mistakes-in-go-golang/">http://devs.cloudimmunity.com/gotchas-and-common-mistakes-in-go-golang/</a></p>
<p>Interface!
<a href="https://medium.com/a-journey-with-go/go-understand-the-empty-interface-2d9fc1e5ec72">https://medium.com/a-journey-with-go/go-understand-the-empty-interface-2d9fc1e5ec72</a></p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-b788bed69318261c2d9c7ad15e0672f1">mac local kubernetes setup</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2019-09-19" class="text-muted">2019.09.19</time>
        
	</div>
	<h1 id="docker-for-mac">Docker for Mac</h1>
<p>Kubernetes를 이용해서 배포해야할때,
항상 Cloud위에서 수행하는 것보다는 로컬에 테스트 환경을 구축하고 테스트해보는 것이 생산성에 도움이 될 때가 많다. 그리고 그렇게 어렵지 않다.</p>
<p><img src="http://collabnix.com/wp-content/uploads/2019/05/Screen-Shot-2019-05-11-at-6.17.51-PM.png" alt="docker desktop"></p>
<p>docker desktop for mac을 설치하게 되면, Kubernetes가 활성화된 Docker를 사용할 수 있다. 활성화 되어있지 않다면 preference에 들어가서
enable만 해주면 된다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl get nodes
<span style="color:#8f5902;font-style:italic"># NAME             STATUS   ROLES    AGE    VERSION</span>
<span style="color:#8f5902;font-style:italic"># docker-desktop   Ready    master   114m   v1.14.6</span>
</code></pre></div><p>잘 출력된다.</p>
<h1 id="간단한-서버로-k8s-test해보기">간단한 서버로 k8s test해보기</h1>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#204a87;font-weight:bold">package</span> <span style="color:#000">main</span>

<span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000;font-weight:bold">(</span>
	<span style="color:#4e9a06">&#34;net/http&#34;</span>
<span style="color:#000;font-weight:bold">)</span>

<span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000">main</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">HandleFunc</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;/hello&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">func</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">w</span> <span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ResponseWriter</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">req</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Request</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
		<span style="color:#000">w</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Write</span><span style="color:#000;font-weight:bold">([]</span><span style="color:#204a87">byte</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Hello World&#34;</span><span style="color:#000;font-weight:bold">))</span>
	<span style="color:#000;font-weight:bold">})</span>

	<span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ListenAndServe</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;:5000&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">nil</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>hello 엔드포인트로 get 을 날리면 response로 Hello World를 출력하는 간단한 서버이다.
이 서버를 컨테이너화 시켜 배포하기 위해 dockerfile을 간단히 작성해본다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">FROM golang:latest

WORKDIR /app

COPY . .

RUN go build -o main .

EXPOSE <span style="color:#0000cf;font-weight:bold">5000</span>
CMD <span style="color:#ce5c00;font-weight:bold">[</span><span style="color:#4e9a06">&#34;./main&#34;</span><span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>이 도커파일을 image화 시켜 docker hub에 publish 하면 된다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">docker login <span style="color:#8f5902;font-style:italic"># docker hub 인증</span>
docker build .
docker tag <span style="color:#ce5c00;font-weight:bold">{</span>image_id<span style="color:#ce5c00;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">{</span>username<span style="color:#ce5c00;font-weight:bold">}</span>/exercise:v1
docker push <span style="color:#ce5c00;font-weight:bold">{</span>username<span style="color:#ce5c00;font-weight:bold">}</span>/exercise:v1
</code></pre></div><p>이제 push 된 이미지를 땡겨와서 kubernetes로 배포하는 배포파일을 만들어본다.</p>
<pre><code>apiVersion: apps/v1
kind: Deployment
metadata:
  name: exercise
  labels:
    app: exercise
spec:
  replicas: 1
  selector:
    matchLabels:
      app: exercise
  template:
    metadata:
      labels:
        app: exercise
    spec:
      terminationGracePeriodSeconds: 30
      containers:
      - name: exercise
        image: docker.io/{username}/exercise:v1
        imagePullPolicy: Always
        ports:
        - containerPort: 5000
</code></pre><p>replica는 1개로 해서 1개의 팟을 띄워 컨테이너를 올리는 Deployment 오브젝트를 만들어본다. 5000번 포트를 사용하고 있는 서버이기 때문에 container 의 포트를 5000으로 지정해준다.</p>
<blockquote>
<ul>
<li>terminationGracePeriodSeconds: 30 는 pod 종료 시에 graceful shutdown을 위해 30초의 grace period를 두도록 하는 옵션이다.</li>
</ul>
</blockquote>
<ul>
<li>imagePullPolicy는 로컬에 동일한 이름의 이미지가 존재해도, 항상 이미지를 pull하도록 하는 옵션이다.
이 외에도 여러가지 옵션을 테스트 해볼 수 있다.</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubernetes apply -f sample.yml
</code></pre></div><p>이제 pod이 의도한 대로 잘 생겼는지 확인해본다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl get pod
<span style="color:#8f5902;font-style:italic"># NAME                       READY   STATUS    RESTARTS   AGE</span>
<span style="color:#8f5902;font-style:italic"># exercise-b97678cfd-mpppx   1/1     Running   0          9s</span>
</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl describe pod/exercise-b97678cfd-mpppx <span style="color:#8f5902;font-style:italic"># 아까 조회한 pod의 name을 이용해서 pod의 자세한 리소스를 조회할 수 있다.</span>
kubectl logs pod/exercise-b97678cfd-mpppx <span style="color:#8f5902;font-style:italic"># 해당 팟에서 발생한 로그도 조회 할 수 있다.</span>
</code></pre></div><p>describe를 통해 아래와 같은 이벤트 정보도 조회할 수 있다.</p>
<pre><code>Events:
  Type    Reason     Age   From                     Message
  ----    ------     ----  ----                     -------
  Normal  Scheduled  47s   default-scheduler        Successfully assigned default/exercise-b97678cfd-mpppx to docker-desktop
  Normal  Pulling    45s   kubelet, docker-desktop  Pulling image &quot;docker.io/nayoonhwang/exercise:v1&quot;
  Normal  Pulled     42s   kubelet, docker-desktop  Successfully pulled image &quot;docker.io/nayoonhwang/exercise:v1&quot;
  Normal  Created    42s   kubelet, docker-desktop  Created container exercise
  Normal  Started    41s   kubelet, docker-desktop  Started container exercise
</code></pre><p>정상적으로 동작하는지 테스트해보기 위해서 Hello World 출력을 확인해본다. 컨테이너의 포트와 호스트의 포트를 포워딩해주기 위해(docker run 시에 -p 옵션을 통해 port binding 해주는 것과 같이) 아래와 같이 입력한다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl port-forward deployments/exercise <span style="color:#0000cf;font-weight:bold">5000</span>
</code></pre></div><p>exercise라는 이름의 deployment의 5000번 포트를 포워딩 해주는 커맨드이다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">curl localhost:5000/hello
<span style="color:#8f5902;font-style:italic"># Hello World</span>
</code></pre></div><p>컴퓨터에서 돌고있는 쿠버네티스 pod이 정상 동작임을 확인했다. 이제 다른 여러가지 테스트를 수행해볼수 있다~!</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-62c439d6d48797554a516e2000d975e3">golang nil check</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2019-09-19" class="text-muted">2019.09.19</time>
        
	</div>
	<h1 id="golang-zero-value">golang zero value</h1>
<p>초기화값이 없는 상태로 선언된 변수들은 각 타입의 zero value값으로 초기화된다.</p>
<table>
<thead>
<tr>
<th style="text-align:left"><strong>타입</strong></th>
<th style="text-align:left"><strong>값</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">정수(int)</td>
<td style="text-align:left">0</td>
</tr>
<tr>
<td style="text-align:left">실수(float)</td>
<td style="text-align:left">0.0</td>
</tr>
<tr>
<td style="text-align:left">boolean</td>
<td style="text-align:left">false</td>
</tr>
<tr>
<td style="text-align:left">문자열(string)</td>
<td style="text-align:left">&quot;&quot;</td>
</tr>
<tr>
<td style="text-align:left">실수(float)</td>
<td style="text-align:left">0.0</td>
</tr>
<tr>
<td style="text-align:left">interface, slice, channel, map, pointer, function</td>
<td style="text-align:left">0.0</td>
</tr>
</tbody>
</table>
<p>배열(array)이나 구조체(Struct)의 요소(element)들은 각 필드들이 zero value를 가진채 초기화된다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#4e9a06">&#34;fmt&#34;</span>

<span style="color:#204a87;font-weight:bold">type</span> <span style="color:#000">hello</span> <span style="color:#204a87;font-weight:bold">struct</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#000">s</span> <span style="color:#204a87;font-weight:bold">string</span>
	<span style="color:#000">i</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">int</span>
	<span style="color:#000">p</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">hello</span>
<span style="color:#000;font-weight:bold">}</span>
<span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000">main</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#204a87;font-weight:bold">var</span> <span style="color:#000">h</span> <span style="color:#000">hello</span>
	<span style="color:#000">fmt</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">h</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">}</span>
<span style="color:#8f5902;font-style:italic">// { [] &lt;nil&gt;}
</span></code></pre></div><p>hello라는 구조체를 정의했을때, 특정값 없이 선언하면, 위와 같이 zero 값이 들어가는걸 알 수 있다.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-d79c3fedd310c9fb9b42d7c0da7c295e">Kubernetes Deployment(삽질)</h1>
	
	<div class="td-byline mb-4">
		
        
		<time datetime="2019-09-18" class="text-muted">2019.09.18</time>
        
	</div>
	<p>Kubernetes로 작업할 때 사용하는 것은 Kubectl 이라는 kubernetes 용 cli가 있다. 클러스터를 관리할 때 사용하는데, 쿠버네티스 클러스터 위에 application 배포시 유용하게 사용된다.</p>
<p><a href="https://kubectl.docs.kubernetes.io/pages/kubectl_book/getting_started.html">Kubectl Tutorial</a> 위 링크에 친절하게 설명된 튜토리얼이 있어 따라해보면 좋다.</p>
<p>쿠버네티스에는 Object라는 개념이 있는데, 예를 들어 Application 배포 시에도 이런 배포용 Object를 만들어 사용하는 것이다. 이 Object는 Yaml file 형식으로 표현할 수 있다.</p>
<p>아래는 예시이다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#204a87;font-weight:bold">apiVersion</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">apps/v1 # apps/v1beta2를 사용하는 1.9.0보다 더 이전의 버전용</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">kind</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Deployment</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">metadata</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">nginx-deployment</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">spec</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">selector</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">matchLabels</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">app</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">nginx</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">replicas</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># 템플릿에 매칭되는 파드 2개를 구동하는 디플로이먼트임</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">template</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">metadata</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">labels</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">app</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">nginx</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">spec</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">containers</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">nginx</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">image</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">nginx:1.7.9</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">ports</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span>- <span style="color:#204a87;font-weight:bold">containerPort</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#0000cf;font-weight:bold">80</span><span style="color:#f8f8f8;text-decoration:underline">
</span></code></pre></div><p>모든 쿠버네티스 오브젝트는 오브젝트의 구성을 결정하는 두 개의 필드 spec status 를 가진다. spec은 우리가 만들 오브젝트가 가져야하는 조건을 의미한다. Kubernetes는 제공된 spec을 기준으로 Object를 생성한다.
status 는 오브젝트의 실제 상태를 나타내고, Kubernetes 시스템에 의해 업데이트 된다. Kubernetes는 오브젝트의 실제 상태(status)를 spec에 일치시키기 위해 능동적으로 관리한다.
예를 들어 위 yaml을 기준으로 object를 생성 했을때 spec에 정의된 replicas: 2 에 의해 2개의 인스턴스를 생성하여 컨테이너를 띄운다.
만약 그 중 1개에서 Fail 이 발생한다면, Kubernetes 시스템에서 자체적으로 대체 인스턴스를 생성하여 spec과 status 간의 차이를 제거하려할 것이다.</p>
<p>Pod은 Kubernetes의 가장 작은 개념이자 핵심 개념이다. 한개의 팟은 Application의 한 인스턴스로 동등하다. 그리고 이 인스턴스는 보통 한 개의 컨테이너다. 팟 하나에 하나의 ip 주소를 가지고 있다.
즉, 한 pod은 한 컨테이너가 동작하는 한개의 인스턴스이다. 물론 여러개 컨테이너가 올라갈 수도 있지만, 난 간단히 한 pod에 한 컨테이너라고 이해하고 진행했다. 팟은 보통 직접만들기 보다는, 싱글톤(Singleton) 이라도 대부분 위와 같이 Deployment와 같은 컨트롤러를 사용한다. 컨트롤러는 클러스터 범위에서 복제와 롤아웃(Rollout) 관리 뿐만 아니라 자가치료 기능도 제공한다.</p>
<p><a href="https://kubernetes.io/ko/docs/concepts/workloads/pods/pod/">참고</a></p>
<h2 id="object-생성하기">Object 생성하기</h2>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl apply -f config.yml
</code></pre></div><p>yaml file 에 정의한 바를 기반으로 deployment/service를 생성할 수 있다. 다른 방식으로도 생성할 수 있지만, 이렇게 생성하는 것을 권장하고 있다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl create -f config.yml
</code></pre></div><p>이런식으로 생성해도 되지만, apply를 해도 만약 해당 이름의 deployment가 존재하지 않을 경우 생성해주기 때문에 create를 굳이 쓸필요가없다.</p>
<p>환경변수 설정시 등에서 활용할 수 있는 Configmap의 예시를 한번 들어보면, 아래와 같은 식으로 special-config라는 이름의 Configmap을 정의한 후에 </p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#204a87;font-weight:bold">apiVersion</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">v1</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">kind</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">ConfigMap</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">metadata</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">special-config</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">namespace</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">default</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">data</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">SPECIAL_LEVEL</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">very</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">SPECIAL_TYPE</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">charm</span><span style="color:#f8f8f8;text-decoration:underline">
</span></code></pre></div><p>apply를 통해 만들어준다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl apply -f config.yml
<span style="color:#8f5902;font-style:italic"># configmap/special-config created</span>
kubectl get configmaps
<span style="color:#8f5902;font-style:italic"># NAME             DATA   AGE</span>
<span style="color:#8f5902;font-style:italic"># special-config   2      8s</span>
</code></pre></div><p>만들어준 configmap은 pod 생성시에 아래와 같은 식으로 참조하여 사용할 수 있다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#204a87;font-weight:bold">apiVersion</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">v1</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">kind</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">Pod</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">metadata</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">dapi-test-pod</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline"></span><span style="color:#204a87;font-weight:bold">spec</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">containers</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span>- <span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">test-container</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">image</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">k8s.gcr.io/busybox</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">command</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">[</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;/bin/sh&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;-c&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;env&#34;</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000;font-weight:bold">]</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span><span style="color:#204a87;font-weight:bold">envFrom</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#204a87;font-weight:bold">configMapRef</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">	  		</span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">special-config</span><span style="color:#f8f8f8;text-decoration:underline">
</span></code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">envFrom:
- configMapRef:
	name: special-config
</code></pre></div><p>이렇게 정의하면 special-config내에 data에 정의한 모든 변수들을 container의 환경변수로 사용할 수 있다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">env:
- name: SPECIAL_LEVEL_KEY
  valueFrom:
    configMapKeyRef:
      name: special-config
      key: SPECIAL_LEVEL
</code></pre></div><p>이렇게 envFrom와 configMapRef 키워드 대신 env와 configMapKeyRef로 정의하면 speical-config configmap에서 원하는 변수를 정의해서 쓸 수 있다. 아무래도 위에 있는 envFrom 이 좀 더 쉽게 사용할 수 있는 방법이다.</p>
<h2 id="deploy-updated-application">Deploy Updated Application</h2>
<p>그렇다면 이미 돌아가고 있는 Instance을 업데이트 해야할 땐 어떻게 해야할까. 예를 들어 application에 변동 사항이 생겼고, source code에 변동이 생겼으니, build artifact가 달라졌을것이다. release나 master 같은 경우엔 당연히 build-number/ release-number를 다르게 해서 image에 tag를 달아주고 해당 image를 참조하여 build 하도록 하면 config.yml에 매번 변동이 생기기 때문에 pod를 rolling update 한다. 하지만 develop같은 경우엔 어떻게 될까. develop같은 경우엔 변동사항이 많고 굳이 release-number / build-number를 관리하지 않는다.</p>
<p><a href="https://stackoverflow.com/questions/40366192/kubernetes-how-to-make-deployment-to-update-image">stackoverflow 에 많은 질문들</a>이 올라와있다. <a href="https://kubernetes.io/docs/tasks/manage-kubernetes-objects/declarative-config/">공식 Kubernetes 가이드</a>등을 참조해봤을 때,</p>
<pre><code>kubernetes set image deployments/{my_deployment} {container_name}={image_repo_url}:{tag_name}
</code></pre><p>요 set 커맨드를 이용해서 뭔가를 update를 줘서 kubernetes가 rolling update를 수행할 수 있게 하라는 답변들이 가장 많았다. 일단 rolling update를 수행하게 되면,</p>
<blockquote>
<p>imagePullPolicy: Always</p>
</blockquote>
<p>요 imagePullPolicy가 Always로 설정되어있을때, 항상 image를 repository에서 pull 땡겨오기 때문에 같은 tag를 가진 이미지라도 업데이트된 이미지가 존재할때 해당 업데이트를 받아올수 있다.</p>
<p>사실 Rolling Restart 라는 개념을 이때 사용하면 딱 괜찮은데, <a href="https://github.com/kubernetes/kubernetes/issues/13488">이슈</a>가 이미 존재했고, 1.15 버전부터는</p>
<pre><code>kubectl rollout restart {pod}
</code></pre><p>라는 커맨드가 생겨서 한번에 해결할 수 있다.</p>
<p>하지만 우리가 사용하고 있는 버전이 1.14여서 해당 커맨드를 사용할 수 없는데, 이땐 각종 야매 방법을 써야한다</p>
<p><a href="https://techoverflow.net/2019/04/02/how-to-force-restarting-all-pods-in-a-kubernetes-deployment/">야매1</a> 뭐 이런 방법이 있을 수 있고, tag가 latest일 경우에는,</p>
<pre><code>kubectl set image deployments/exercise exercise=docker.io/{username}/exercise:latest
kubectl set image deployments/exercise exercise=docker.io/{username}/exercise
</code></pre><p>이런식으로 두 번 치는걸로 이미지를 강제 업데이트 시켜 rolling update를 유도할 수 있다. 단 이 방법은 tag 가 latest일때만 작동한다. develop같이 branch 이름으로 하는 경우에는 또 동작하지않는다.</p>
<p>이를 다 테스트 해보기 위해 로컬에 kubernetes를 설치하고 하나하나 해봤는데, 다행히 Mac에는 Docker for Mac을 이용하면 쉽게 설치할 수 있었다.</p>
<p><a href="https://eksworkshop.com/logging/">https://eksworkshop.com/logging/</a></p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-d53c72cb81c4e15423fcac286eacb365">reflect 어떻게 쓰지 - 1</h1>
	
	<div class="td-byline mb-4">
		
        
	</div>
	<p>Reflect을 가장 먼저 접하게 된것은 작년이었는데 그때 당시엔 그냥 대충 써보다가 어려워서 기존에 사용했었던 코드들에서도 다 reflect를 빼버렸었다. 당장 급했는데 자꾸 뭐시기 뭐시기 나오네 이러고 별로 이해하려는 노력 없이 사용했었기 때문이었던 것같다.</p>
<p>그러다 다시 go를 쓰게 되서 코딩을 하다가 또 reflect를 사용해야하는 경우를 발견했는데,</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#204a87;font-weight:bold">type</span> <span style="color:#000">sampleJSON</span> <span style="color:#204a87;font-weight:bold">struct</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#000">Num</span> <span style="color:#204a87;font-weight:bold">string</span> <span style="color:#4e9a06">`json:&#34;NUM&#34; joyful:&#34;true&#34;`</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>뭐 이런식으로 되어있다고 할때, json struct field의 tag를 받아오고 싶을 때 어떻게 할지를 찾아보다가 reflect를 사용하게 되면 쉽게 가능하다는 걸 알게 되었다.</p>
<p>일단 잠시 reflect 맛을 보기 위해 예제를 수행해보자</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#8f5902;font-style:italic">// 예를 들어 sj라는 이름의 sample Json struct가 있다고 하자
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">sj</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">sampleJSON</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#34;01000000000&#34;</span><span style="color:#000;font-weight:bold">}</span>
<span style="color:#000">fmt</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">reflect</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ValueOf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">sj</span><span style="color:#000;font-weight:bold">).</span><span style="color:#000">Type</span><span style="color:#000;font-weight:bold">())</span>
<span style="color:#8f5902;font-style:italic">// 1. reflect.ValueOf(interface) 해당 인터페이스의 reflect.Value값이 나온다
</span><span style="color:#8f5902;font-style:italic">// 2. 거기서 Type()을 호출하면 해당 변수의 타입이 나온다. 여기선 sampleJSON
</span><span style="color:#8f5902;font-style:italic">// 3. 해당 타입의 Kind()를 조회해보면 구조체이므로 reflect.Struct이다
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">reflect</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ValueOf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">sj</span><span style="color:#000;font-weight:bold">).</span><span style="color:#000">Type</span><span style="color:#000;font-weight:bold">().</span><span style="color:#000">Kind</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#000">reflect</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Struct</span><span style="color:#000;font-weight:bold">{</span>
	<span style="color:#000">fmt</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;say hello to struct&#34;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>즉 reflect는 특정 interface 값의 Value를 조회할 수 있도록한다. 이 Value를 가지고 여러가지를 해볼 수 있는데 이는 추후에 하도록 하고, 일단 이 Value에 Type()을 조회하면 해당 변수의 값이 아닌 sampleJson 구조체 타입 자체의 정보를 다룰수 있다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000">reflect</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ValueOf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">sj</span><span style="color:#000;font-weight:bold">).</span><span style="color:#000">Type</span><span style="color:#000;font-weight:bold">()</span>
<span style="color:#8f5902;font-style:italic">// main.sampleJSON
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">reflect</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">TypeOf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">sj</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#8f5902;font-style:italic">// main.sampleJSON
</span></code></pre></div><p>또한 위 두 줄은 같은 역할을 수행하므로 밑에 TypeOf를 사용해도 무방하다.</p>
<p>이제 Json tag를 본격적으로 찾아보려면,</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000">structTag</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">reflect</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">TypeOf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">sj</span><span style="color:#000;font-weight:bold">).</span><span style="color:#000">Field</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">).</span><span style="color:#000">Tag</span>
<span style="color:#000">fmt</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">structTag</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#8f5902;font-style:italic">// json:&#34;NUM&#34; joyful:&#34;true&#34;
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">fmt</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">structTag</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;joyful&#34;</span><span style="color:#000;font-weight:bold">))</span>
<span style="color:#8f5902;font-style:italic">// true
</span></code></pre></div><p>위와 같이 하면 되는데, tag는 reflect.StructField 에 저장되있는 속성이므로 TypeOf으로 타입을 조회한 후, Field(특정 필드를 선택)로 StructField 를 받아오면된다. 또한 특정 태그만 받아오고 싶을시 Get을 통해 특정태그만 받아올 수도 있다.</p>
<p>주의할 점은 위에서 설명한건 reflect.ValueOf 또는 TypeOf의 파라미터로 들어온 interface타입이 값일때를 말한다는 것이다. 만약 포인터값일때는</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000">reflect</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">TypeOf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">sj</span><span style="color:#000;font-weight:bold">).</span><span style="color:#000">Elem</span><span style="color:#000;font-weight:bold">().</span><span style="color:#000">Field</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">).</span><span style="color:#000">Tag</span>
</code></pre></div><p>이런식으로 Elem()을 추가해주도록한다. 따라서 요기능을 넣는 함수들에는 해당 값이 값인지 포인터인지 판단하는 로직이 들어가야한다.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-8bdfe4098c42101747264a2bec233bd7">reflect 어떻게 쓰지 - 2</h1>
	
	<div class="td-byline mb-4">
		
        
	</div>
	<p>Reflect를 사용해서 좀 더 복잡한 로직을 수행하는 예제이다.
예를 들어 API 서버의 들어오는 Request와 나가는 Response 를 모두 서버에 로그로 남겨두는 경우,
해당 Request와 Response 의 특정 필드는 개인정보에 해당하므로 비식별화한 후 저장하도록 하게 하고싶다고 한다.
그리고 이때 Request 와 Response는 모두 JSON 으로 주고 받는다.</p>
<ul>
<li>앱로그</li>
<li>트랜잭션로그</li>
</ul>
<p>재사용 가능한 middleware/transaction.go</p>
<p>개선사항</p>
<ol>
<li>data 가 포인터이든, 값이든 대응 할 수 있도록 type 검사를 수행하고, map[string]string을 대신에 기존 data의 타입을 복사해서 새로운 변수를 만든다. reflect.New를 이용하여 파라미터로 넘어온 특정 타입의 변수를 만들수 있다. 단, 포인터로 만들어지므로 주의해서 쓰도록 한다.</li>
</ol>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">reflect</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">TypeOf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">data</span><span style="color:#000;font-weight:bold">).</span><span style="color:#000">Kind</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#000">reflect</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Ptr</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#000">buffdata</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#000">reflect</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">New</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">reflect</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">TypeOf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">data</span><span style="color:#000;font-weight:bold">).</span><span style="color:#000">Elem</span><span style="color:#000;font-weight:bold">()).</span><span style="color:#000">Interface</span><span style="color:#000;font-weight:bold">()</span>
<span style="color:#000;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">else</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#000">buffdata</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#000">reflect</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">New</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">reflect</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">TypeOf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">data</span><span style="color:#000;font-weight:bold">)).</span><span style="color:#000">Interface</span><span style="color:#000;font-weight:bold">()</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>buffdata 라는 data와 같은 타입의 변수를 만들었으니 해당 변수에 copy한다. copier라는 라이브러리를 사용하였고 struct에서 struct로 복사할 수 있게 해주는 라이브러리이다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">copier</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Copy</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">buffdata</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">data</span><span style="color:#000;font-weight:bold">);</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#204a87;font-weight:bold">nil</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#000">log</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Error</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">c</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Fail to copy data for response log&#34;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><ol start="2">
<li>로그를 남기는 것은 async로 처리하여, 속도를 높힌다
ShouldBindJson는 Request를 특정 struct로 binding 하기 위해 사용하는 것인데, 이를 Wrapping하여 Request 로그를 남기는 로직을 추가한 것이므로, 뒤에 로직같은 경우엔 비동기로 처리하는 것이 좋다.</li>
</ol>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000">wg</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Add</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#204a87;font-weight:bold">go</span> <span style="color:#204a87;font-weight:bold">func</span><span style="color:#000;font-weight:bold">(){</span>
	<span style="color:#204a87;font-weight:bold">defer</span> <span style="color:#000">wg</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Done</span><span style="color:#000;font-weight:bold">()</span>
	<span style="color:#000">deidentify</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">reflect</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ValueOf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">buffdata</span><span style="color:#000;font-weight:bold">))</span>
	
	<span style="color:#000">headers</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">_</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">json</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Marshal</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">c</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Request</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Header</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#000">body</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">_</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">json</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Marshal</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">buffdata</span><span style="color:#000;font-weight:bold">)</span>
	
	<span style="color:#000">log</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Transaction</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">c</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">log</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">TransactionLog</span><span style="color:#000;font-weight:bold">{</span>
		<span style="color:#000">Type</span><span style="color:#000;font-weight:bold">:</span>    <span style="color:#000">log</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">LogTypeRequest</span><span style="color:#000;font-weight:bold">,</span>
		<span style="color:#000">URL</span><span style="color:#000;font-weight:bold">:</span>     <span style="color:#000">c</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Request</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">URL</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">String</span><span style="color:#000;font-weight:bold">(),</span>
		<span style="color:#000">Method</span><span style="color:#000;font-weight:bold">:</span>  <span style="color:#000">c</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Request</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Method</span><span style="color:#000;font-weight:bold">,</span>
		<span style="color:#000">Headers</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000">headers</span><span style="color:#000;font-weight:bold">,</span>
		<span style="color:#000">Body</span><span style="color:#000;font-weight:bold">:</span>    <span style="color:#000">body</span><span style="color:#000;font-weight:bold">})</span>
<span style="color:#000;font-weight:bold">}()</span>
<span style="color:#000">wg</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Wait</span><span style="color:#000;font-weight:bold">()</span>
</code></pre></div><ol start="3">
<li>비식별화 로직 한 함수에 정리하여 비식별화 로직과 request/response 처리 로직 분리</li>
</ol>
<p>=&gt; 이전 비식별화 + request 처리 혼재 / 비식별화 + response 처리 혼재</p>
<ul>
<li>
<p>Parameter가 포인터이면 안되는 함수
=&gt; 해당 value 종류가 reflect.Ptr / reflect.Interface 이면 Elem() 처리</p>
</li>
<li>
<p>Nested Struct JSON을 처리할때 DeepFields, DeepTag를 이용해서 Field와 Tag를 각각 모두 뽑아내어 처리하기
=&gt; 비식별화 함수 로직 자체를 깔끔하게 해서 한 함수 내에서 처리</p>
</li>
</ul>
<p><em>Old</em></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000">DeepFields</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">iface</span> <span style="color:#204a87;font-weight:bold">interface</span><span style="color:#000;font-weight:bold">{})</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#000">reflect</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Value</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#000">fields</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#204a87">make</span><span style="color:#000;font-weight:bold">([]</span><span style="color:#000">reflect</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#000">ifaceValue</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">reflect</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ValueOf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">iface</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#000">ifaceType</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">reflect</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">TypeOf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">iface</span><span style="color:#000;font-weight:bold">)</span>

	<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#000;font-weight:bold">&lt;</span> <span style="color:#000">ifaceType</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">NumField</span><span style="color:#000;font-weight:bold">();</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span> <span style="color:#000;font-weight:bold">{</span>
		<span style="color:#000">v</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">ifaceValue</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Field</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">)</span>
		<span style="color:#204a87;font-weight:bold">switch</span> <span style="color:#000">v</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Kind</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
		<span style="color:#204a87;font-weight:bold">case</span> <span style="color:#000">reflect</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Struct</span><span style="color:#000;font-weight:bold">:</span>
			<span style="color:#000">fields</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#204a87">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">fields</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DeepFields</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">v</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Interface</span><span style="color:#000;font-weight:bold">())</span><span style="color:#ce5c00;font-weight:bold">...</span><span style="color:#000;font-weight:bold">)</span>
		<span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span>
			<span style="color:#000">fields</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#204a87">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">fields</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">v</span><span style="color:#000;font-weight:bold">)</span>
		<span style="color:#000;font-weight:bold">}</span>
	<span style="color:#000;font-weight:bold">}</span>
	<span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">fields</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p><em>NEW</em></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000">deidentify</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">v</span> <span style="color:#000">reflect</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Value</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">v</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Kind</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#000">reflect</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Ptr</span> <span style="color:#ce5c00;font-weight:bold">||</span> <span style="color:#000">v</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Kind</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#000">reflect</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Interface</span> <span style="color:#000;font-weight:bold">{</span>
		<span style="color:#000">v</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#000">v</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Elem</span><span style="color:#000;font-weight:bold">()</span>
	<span style="color:#000;font-weight:bold">}</span>

	<span style="color:#204a87;font-weight:bold">switch</span> <span style="color:#000">v</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Kind</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#204a87;font-weight:bold">case</span> <span style="color:#000">reflect</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Slice</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">reflect</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Array</span><span style="color:#000;font-weight:bold">:</span>
		<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">idx</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">idx</span> <span style="color:#000;font-weight:bold">&lt;</span> <span style="color:#000">v</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Len</span><span style="color:#000;font-weight:bold">();</span> <span style="color:#000">idx</span><span style="color:#ce5c00;font-weight:bold">++</span> <span style="color:#000;font-weight:bold">{</span>
			<span style="color:#000">deidentify</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">v</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Index</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">idx</span><span style="color:#000;font-weight:bold">))</span>
		<span style="color:#000;font-weight:bold">}</span>
	<span style="color:#204a87;font-weight:bold">case</span> <span style="color:#000">reflect</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Struct</span><span style="color:#000;font-weight:bold">:</span>
		<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">idx</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">idx</span> <span style="color:#000;font-weight:bold">&lt;</span> <span style="color:#000">v</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Type</span><span style="color:#000;font-weight:bold">().</span><span style="color:#000">NumField</span><span style="color:#000;font-weight:bold">();</span> <span style="color:#000">idx</span><span style="color:#ce5c00;font-weight:bold">++</span> <span style="color:#000;font-weight:bold">{</span>
			<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">v</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Type</span><span style="color:#000;font-weight:bold">().</span><span style="color:#000">Field</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">idx</span><span style="color:#000;font-weight:bold">).</span><span style="color:#000">Tag</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;deidentify&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#4e9a06">&#34;true&#34;</span> <span style="color:#000;font-weight:bold">{</span>
				<span style="color:#000">mask</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">v</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Field</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">idx</span><span style="color:#000;font-weight:bold">))</span>
			<span style="color:#000;font-weight:bold">}</span>
			<span style="color:#000">deidentify</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">v</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Field</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">idx</span><span style="color:#000;font-weight:bold">))</span>
		<span style="color:#000;font-weight:bold">}</span>
	<span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000">mask</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">v</span> <span style="color:#000">reflect</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Value</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#204a87;font-weight:bold">switch</span> <span style="color:#000">v</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Kind</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#204a87;font-weight:bold">case</span> <span style="color:#000">reflect</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">String</span><span style="color:#000;font-weight:bold">:</span>
		<span style="color:#000">values</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87">rune</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">v</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">String</span><span style="color:#000;font-weight:bold">())</span>

		<span style="color:#204a87;font-weight:bold">var</span> <span style="color:#000">result</span> <span style="color:#204a87;font-weight:bold">string</span>
		
		<span style="color:#000">masked</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#204a87">make</span><span style="color:#000;font-weight:bold">([]</span><span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">values</span><span style="color:#000;font-weight:bold">))</span>
		<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">idx</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#204a87;font-weight:bold">range</span> <span style="color:#000">masked</span> <span style="color:#000;font-weight:bold">{</span>
			<span style="color:#000">masked</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">idx</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;*&#34;</span>
		<span style="color:#000;font-weight:bold">}</span>

		<span style="color:#000">v</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">SetString</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">strings</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Join</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">masked</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;&#34;</span><span style="color:#000;font-weight:bold">))</span>
	<span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><blockquote>
<p>Rune을 쓰는 이유!</p>
</blockquote>

</div>





    
	
  

    
	
  



          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="User mailing list" aria-label="User mailing list">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://example.org/mail">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Twitter" aria-label="Twitter">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://example.org/twitter">
      <i class="fab fa-twitter"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Stack Overflow" aria-label="Stack Overflow">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://example.org/stack">
      <i class="fab fa-stack-overflow"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://github.com/matilda38">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Developer mailing list" aria-label="Developer mailing list">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="matilda38@naver.com">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2021 The Docsy Authors All Rights Reserved</small>
        <small class="ml-1"><a href="https://policies.google.com/privacy" target="_blank">개인정보 보호 정책</a></small>
	
		
	
      </div>
    </div>
  </div>
</footer>


    </div>
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>











<script src="/js/main.min.b5fc1b29d2465835844254bd4d804738eaf24c0cec53009b4c6899989be55a47.js" integrity="sha256-tfwbKdJGWDWEQlS9TYBHOOryTAzsUwCbTGiZmJvlWkc=" crossorigin="anonymous"></script>




  </body>
</html>
